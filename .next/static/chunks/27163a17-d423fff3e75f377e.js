"use strict";(self["webpackChunk_N_E"]=self["webpackChunk_N_E"]||[]).push([[667],{77680:(t,e,s)=>{s.d(e,{$EB:()=>y,$Yl:()=>j,$_I:()=>tz,$ei:()=>z,A$4:()=>n$,AQS:()=>sQ,BH$:()=>at,BKk:()=>rv,BXX:()=>t1,B_h:()=>et,CSG:()=>h2,CVz:()=>t6,CWW:()=>eb,Cfg:()=>tv,Dmk:()=>tj,EZo:()=>b,EdD:()=>M,FFZ:()=>sn,FV:()=>tn,FXf:()=>_,Fn:()=>ep,GJx:()=>ty,GWd:()=>tD,Gwm:()=>Y,H23:()=>ef,H2z:()=>uS,HIg:()=>tU,HO_:()=>ex,HXV:()=>t5,I9Y:()=>sZ,IE4:()=>tQ,IUQ:()=>id,Iit:()=>ry,IzY:()=>uM,Jnc:()=>h,K52:()=>Z,KDk:()=>t9,KLL:()=>eH,KRh:()=>Q,Kef:()=>ey,Kwu:()=>w,LAk:()=>to,LiQ:()=>k,LlO:()=>rb,LoY:()=>n7,MW4:()=>nK,Mjd:()=>ts,Mmk:()=>s8,N5j:()=>eO,NTi:()=>x,Nex:()=>uz,Nt7:()=>O,Nz6:()=>tK,O9p:()=>i8,ONl:()=>ar,OUM:()=>tC,Om:()=>tm,OuU:()=>E,PPD:()=>oz,PTz:()=>iw,Pq0:()=>iM,Q1f:()=>nE,QP0:()=>u,Qev:()=>sM,Qrf:()=>ei,R3r:()=>rO,RQf:()=>tO,Riy:()=>t8,RlV:()=>iG,RoJ:()=>rU,RrE:()=>L,RyA:()=>p,S$4:()=>ed,THS:()=>nJ,TdN:()=>sy,TiK:()=>st,TkQ:()=>tZ,U3G:()=>X,V3x:()=>tL,V9B:()=>nN,VCu:()=>af,VT0:()=>tJ,Vb5:()=>a,VxR:()=>eD,W9U:()=>em,WNZ:()=>o,Wdf:()=>sm,Wew:()=>tN,Wk7:()=>d,XG_:()=>eg,XIg:()=>g,XrR:()=>K,YHV:()=>lX,Yuy:()=>tE,Z58:()=>rV,ZQM:()=>tX,Zcv:()=>o_,Zr2:()=>eU,_QJ:()=>eo,_Ut:()=>rx,a55:()=>sA,a5J:()=>er,aEY:()=>N,aJ8:()=>ta,aVO:()=>h3,amv:()=>e8,b4q:()=>rk,bC7:()=>ec,bCz:()=>v,bI3:()=>eV,bdM:()=>hF,bkx:()=>tP,brA:()=>q,bw0:()=>G,c90:()=>t$,cHt:()=>tR,caT:()=>$,cj9:()=>sY,czI:()=>ee,dYF:()=>ix,dcC:()=>tq,dwI:()=>sG,e0p:()=>W,eHc:()=>D,eaF:()=>ru,eoi:()=>se,er$:()=>eW,f4X:()=>B,fBL:()=>tk,g7M:()=>tr,gJ2:()=>tV,gO9:()=>S,gPd:()=>iu,gWB:()=>si,ghU:()=>tg,hB5:()=>f,hdd:()=>P,hgQ:()=>V,hsX:()=>m,hxR:()=>tb,hy7:()=>tu,iNn:()=>rf,ie2:()=>R,ix0:()=>tF,jR7:()=>t0,jej:()=>s4,jf0:()=>ej,jzd:()=>ss,k6Q:()=>t2,k6q:()=>t_,kBv:()=>n,kO0:()=>e7,kRr:()=>tA,kTW:()=>tx,kTp:()=>t3,kn4:()=>i$,kxk:()=>r2,kyO:()=>te,lGu:()=>H,lPF:()=>s2,lxW:()=>rm,lyL:()=>eh,mcG:()=>s5,nNL:()=>ti,nST:()=>A,nWS:()=>im,nZQ:()=>ln,o6l:()=>rR,ojh:()=>I,ojs:()=>eu,ov9:()=>U,pBf:()=>t4,pHI:()=>tw,paN:()=>tY,ppV:()=>ie,psI:()=>en,qUd:()=>cq,qa3:()=>t7,qad:()=>C,qq$:()=>s1,rFo:()=>iy,rSH:()=>es,sPf:()=>i,tJf:()=>tB,uB5:()=>ea,uV5:()=>tf,ubm:()=>rz,vim:()=>e9,vyJ:()=>eL,wfO:()=>tp,wn6:()=>F,wrO:()=>tW,wtR:()=>r,xFO:()=>td,xSv:()=>J,xiE:()=>s6,y3Z:()=>el,y_p:()=>tt,zdS:()=>tH,zgK:()=>i9,znC:()=>T});const i="176";const n={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2};const r={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3};const o=0;const a=1;const h=2;const c=3;const l=0;const u=1;const d=2;const p=3;const f=0;const m=1;const y=2;const g=0;const x=1;const b=2;const w=3;const M=4;const v=5;const S=100;const _=101;const A=102;const T=103;const z=104;const I=200;const C=201;const B=202;const k=203;const R=204;const E=205;const P=206;const O=207;const F=208;const N=209;const V=210;const L=211;const j=212;const W=213;const U=214;const D=0;const H=1;const q=2;const J=3;const X=4;const Y=5;const Z=6;const G=7;const $=0;const Q=1;const K=2;const tt=0;const te=1;const ts=2;const ti=3;const tn=4;const tr=5;const to=6;const ta=7;const th="attached";const tc="detached";const tl=300;const tu=301;const td=302;const tp=303;const tf=304;const tm=306;const ty=1e3;const tg=1001;const tx=1002;const tb=1003;const tw=1004;const tM=1004;const tv=1005;const tS=1005;const t_=1006;const tA=1007;const tT=1007;const tz=1008;const tI=1008;const tC=1009;const tB=1010;const tk=1011;const tR=1012;const tE=1013;const tP=1014;const tO=1015;const tF=1016;const tN=1017;const tV=1018;const tL=1020;const tj=35902;const tW=1021;const tU=1022;const tD=1023;const tH=1026;const tq=1027;const tJ=1028;const tX=1029;const tY=1030;const tZ=1031;const tG=1032;const t$=1033;const tQ=33776;const tK=33777;const t0=33778;const t1=33779;const t2=35840;const t3=35841;const t5=35842;const t4=35843;const t6=36196;const t8=37492;const t9=37496;const t7=37808;const et=37809;const ee=37810;const es=37811;const ei=37812;const en=37813;const er=37814;const eo=37815;const ea=37816;const eh=37817;const ec=37818;const el=37819;const eu=37820;const ed=37821;const ep=36492;const ef=36494;const em=36495;const ey=36283;const eg=36284;const ex=36285;const eb=36286;const ew=2200;const eM=2201;const ev=2202;const eS=2300;const e_=2301;const eA=2302;const eT=2400;const ez=2401;const eI=2402;const eC=2500;const eB=2501;const ek=0;const eR=1;const eE=2;const eP=3200;const eO=3201;const eF=3202;const eN=3203;const eV=0;const eL=1;const ej="";const eW="srgb";const eU="srgb-linear";const eD="linear";const eH="srgb";const eq=0;const eJ=7680;const eX=7681;const eY=7682;const eZ=7683;const eG=34055;const e$=34056;const eQ=5386;const eK=512;const e0=513;const e1=514;const e2=515;const e3=516;const e5=517;const e4=518;const e6=519;const e8=512;const e9=513;const e7=514;const st=515;const se=516;const ss=517;const si=518;const sn=519;const sr=35044;const so=35048;const sa=35040;const sh=35045;const sc=35049;const sl=35041;const su=35046;const sd=35050;const sp=35042;const sf="100";const sm="300 es";const sy=2e3;const sg=2001;const sx={COMPUTE:"compute",RENDER:"render"};const sb={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"};const sw={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};class sM{addEventListener(t,e){if(this._listeners===undefined)this._listeners={};const s=this._listeners;if(s[t]===undefined){s[t]=[]}if(s[t].indexOf(e)===-1){s[t].push(e)}}hasEventListener(t,e){const s=this._listeners;if(s===undefined)return false;return s[t]!==undefined&&s[t].indexOf(e)!==-1}removeEventListener(t,e){const s=this._listeners;if(s===undefined)return;const i=s[t];if(i!==undefined){const t=i.indexOf(e);if(t!==-1){i.splice(t,1)}}}dispatchEvent(t){const e=this._listeners;if(e===undefined)return;const s=e[t.type];if(s!==undefined){t.target=this;const e=s.slice(0);for(let s=0,i=e.length;s<i;s++){e[s].call(this,t)}t.target=null}}}const sv=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let sS=1234567;const s_=Math.PI/180;const sA=180/Math.PI;function sT(){const t=Math.random()*0xffffffff|0;const e=Math.random()*0xffffffff|0;const s=Math.random()*0xffffffff|0;const i=Math.random()*0xffffffff|0;const n=sv[t&255]+sv[t>>8&255]+sv[t>>16&255]+sv[t>>24&255]+"-"+sv[e&255]+sv[e>>8&255]+"-"+sv[e>>16&15|64]+sv[e>>24&255]+"-"+sv[s&63|128]+sv[s>>8&255]+"-"+sv[s>>16&255]+sv[s>>24&255]+sv[i&255]+sv[i>>8&255]+sv[i>>16&255]+sv[i>>24&255];return n.toLowerCase()}function sz(t,e,s){return Math.max(e,Math.min(s,t))}function sI(t,e){return(t%e+e)%e}function sC(t,e,s,i,n){return i+(t-e)*(n-i)/(s-e)}function sB(t,e,s){if(t!==e){return(s-t)/(e-t)}else{return 0}}function sk(t,e,s){return(1-s)*t+s*e}function sR(t,e,s,i){return sk(t,e,1-Math.exp(-s*i))}function sE(t,e=1){return e-Math.abs(sI(t,e*2)-e)}function sP(t,e,s){if(t<=e)return 0;if(t>=s)return 1;t=(t-e)/(s-e);return t*t*(3-2*t)}function sO(t,e,s){if(t<=e)return 0;if(t>=s)return 1;t=(t-e)/(s-e);return t*t*t*(t*(t*6-15)+10)}function sF(t,e){return t+Math.floor(Math.random()*(e-t+1))}function sN(t,e){return t+Math.random()*(e-t)}function sV(t){return t*(.5-Math.random())}function sL(t){if(t!==undefined)sS=t;let e=sS+=0x6d2b79f5;e=Math.imul(e^e>>>15,e|1);e^=e+Math.imul(e^e>>>7,e|61);return((e^e>>>14)>>>0)/0x100000000}function sj(t){return t*s_}function sW(t){return t*sA}function sU(t){return(t&t-1)===0&&t!==0}function sD(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function sH(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function sq(t,e,s,i,n){const r=Math.cos;const o=Math.sin;const a=r(s/2);const h=o(s/2);const c=r((e+i)/2);const l=o((e+i)/2);const u=r((e-i)/2);const d=o((e-i)/2);const p=r((i-e)/2);const f=o((i-e)/2);switch(n){case"XYX":t.set(a*l,h*u,h*d,a*c);break;case"YZY":t.set(h*d,a*l,h*u,a*c);break;case"ZXZ":t.set(h*u,h*d,a*l,a*c);break;case"XZX":t.set(a*l,h*f,h*p,a*c);break;case"YXY":t.set(h*p,a*l,h*f,a*c);break;case"ZYZ":t.set(h*f,h*p,a*l,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function sJ(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/0xffffffff;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/0x7fffffff,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function sX(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*0xffffffff);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*0x7fffffff);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const sY={DEG2RAD:s_,RAD2DEG:sA,generateUUID:sT,clamp:sz,euclideanModulo:sI,mapLinear:sC,inverseLerp:sB,lerp:sk,damp:sR,pingpong:sE,smoothstep:sP,smootherstep:sO,randInt:sF,randFloat:sN,randFloatSpread:sV,seededRandom:sL,degToRad:sj,radToDeg:sW,isPowerOfTwo:sU,ceilPowerOfTwo:sD,floorPowerOfTwo:sH,setQuaternionFromProperEuler:sq,normalize:sX,denormalize:sJ};class sZ{constructor(t=0,e=0){sZ.prototype.isVector2=true;this.x=t;this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){this.x=t;this.y=e;return this}setScalar(t){this.x=t;this.y=t;return this}setX(t){this.x=t;return this}setY(t){this.y=t;return this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){this.x=t.x;this.y=t.y;return this}add(t){this.x+=t.x;this.y+=t.y;return this}addScalar(t){this.x+=t;this.y+=t;return this}addVectors(t,e){this.x=t.x+e.x;this.y=t.y+e.y;return this}addScaledVector(t,e){this.x+=t.x*e;this.y+=t.y*e;return this}sub(t){this.x-=t.x;this.y-=t.y;return this}subScalar(t){this.x-=t;this.y-=t;return this}subVectors(t,e){this.x=t.x-e.x;this.y=t.y-e.y;return this}multiply(t){this.x*=t.x;this.y*=t.y;return this}multiplyScalar(t){this.x*=t;this.y*=t;return this}divide(t){this.x/=t.x;this.y/=t.y;return this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,s=this.y;const i=t.elements;this.x=i[0]*e+i[3]*s+i[6];this.y=i[1]*e+i[4]*s+i[7];return this}min(t){this.x=Math.min(this.x,t.x);this.y=Math.min(this.y,t.y);return this}max(t){this.x=Math.max(this.x,t.x);this.y=Math.max(this.y,t.y);return this}clamp(t,e){this.x=sz(this.x,t.x,e.x);this.y=sz(this.y,t.y,e.y);return this}clampScalar(t,e){this.x=sz(this.x,t,e);this.y=sz(this.y,t,e);return this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(sz(s,t,e))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);return this}negate(){this.x=-this.x;this.y=-this.y;return this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){const t=Math.atan2(-this.y,-this.x)+Math.PI;return t}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const s=this.dot(t)/e;return Math.acos(sz(s,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y;return e*e+s*s}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){this.x+=(t.x-this.x)*e;this.y+=(t.y-this.y)*e;return this}lerpVectors(t,e,s){this.x=t.x+(e.x-t.x)*s;this.y=t.y+(e.y-t.y)*s;return this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){this.x=t[e];this.y=t[e+1];return this}toArray(t=[],e=0){t[e]=this.x;t[e+1]=this.y;return t}fromBufferAttribute(t,e){this.x=t.getX(e);this.y=t.getY(e);return this}rotateAround(t,e){const s=Math.cos(e),i=Math.sin(e);const n=this.x-t.x;const r=this.y-t.y;this.x=n*s-r*i+t.x;this.y=n*i+r*s+t.y;return this}random(){this.x=Math.random();this.y=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y}}class sG{constructor(t,e,s,i,n,r,o,a,h){sG.prototype.isMatrix3=true;this.elements=[1,0,0,0,1,0,0,0,1];if(t!==undefined){this.set(t,e,s,i,n,r,o,a,h)}}set(t,e,s,i,n,r,o,a,h){const c=this.elements;c[0]=t;c[1]=i;c[2]=o;c[3]=e;c[4]=n;c[5]=a;c[6]=s;c[7]=r;c[8]=h;return this}identity(){this.set(1,0,0,0,1,0,0,0,1);return this}copy(t){const e=this.elements;const s=t.elements;e[0]=s[0];e[1]=s[1];e[2]=s[2];e[3]=s[3];e[4]=s[4];e[5]=s[5];e[6]=s[6];e[7]=s[7];e[8]=s[8];return this}extractBasis(t,e,s){t.setFromMatrix3Column(this,0);e.setFromMatrix3Column(this,1);s.setFromMatrix3Column(this,2);return this}setFromMatrix4(t){const e=t.elements;this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]);return this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const s=t.elements;const i=e.elements;const n=this.elements;const r=s[0],o=s[3],a=s[6];const h=s[1],c=s[4],l=s[7];const u=s[2],d=s[5],p=s[8];const f=i[0],m=i[3],y=i[6];const g=i[1],x=i[4],b=i[7];const w=i[2],M=i[5],v=i[8];n[0]=r*f+o*g+a*w;n[3]=r*m+o*x+a*M;n[6]=r*y+o*b+a*v;n[1]=h*f+c*g+l*w;n[4]=h*m+c*x+l*M;n[7]=h*y+c*b+l*v;n[2]=u*f+d*g+p*w;n[5]=u*m+d*x+p*M;n[8]=u*y+d*b+p*v;return this}multiplyScalar(t){const e=this.elements;e[0]*=t;e[3]*=t;e[6]*=t;e[1]*=t;e[4]*=t;e[7]*=t;e[2]*=t;e[5]*=t;e[8]*=t;return this}determinant(){const t=this.elements;const e=t[0],s=t[1],i=t[2],n=t[3],r=t[4],o=t[5],a=t[6],h=t[7],c=t[8];return e*r*c-e*o*h-s*n*c+s*o*a+i*n*h-i*r*a}invert(){const t=this.elements,e=t[0],s=t[1],i=t[2],n=t[3],r=t[4],o=t[5],a=t[6],h=t[7],c=t[8],l=c*r-o*h,u=o*a-c*n,d=h*n-r*a,p=e*l+s*u+i*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;t[0]=l*f;t[1]=(i*h-c*s)*f;t[2]=(o*s-i*r)*f;t[3]=u*f;t[4]=(c*e-i*a)*f;t[5]=(i*n-o*e)*f;t[6]=d*f;t[7]=(s*a-h*e)*f;t[8]=(r*e-s*n)*f;return this}transpose(){let t;const e=this.elements;t=e[1];e[1]=e[3];e[3]=t;t=e[2];e[2]=e[6];e[6]=t;t=e[5];e[5]=e[7];e[7]=t;return this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;t[0]=e[0];t[1]=e[3];t[2]=e[6];t[3]=e[1];t[4]=e[4];t[5]=e[7];t[6]=e[2];t[7]=e[5];t[8]=e[8];return this}setUvTransform(t,e,s,i,n,r,o){const a=Math.cos(n);const h=Math.sin(n);this.set(s*a,s*h,-s*(a*r+h*o)+r+t,-i*h,i*a,-i*(-h*r+a*o)+o+e,0,0,1);return this}scale(t,e){this.premultiply(s$.makeScale(t,e));return this}rotate(t){this.premultiply(s$.makeRotation(-t));return this}translate(t,e){this.premultiply(s$.makeTranslation(t,e));return this}makeTranslation(t,e){if(t.isVector2){this.set(1,0,t.x,0,1,t.y,0,0,1)}else{this.set(1,0,t,0,1,e,0,0,1)}return this}makeRotation(t){const e=Math.cos(t);const s=Math.sin(t);this.set(e,-s,0,s,e,0,0,0,1);return this}makeScale(t,e){this.set(t,0,0,0,e,0,0,0,1);return this}equals(t){const e=this.elements;const s=t.elements;for(let t=0;t<9;t++){if(e[t]!==s[t])return false}return true}fromArray(t,e=0){for(let s=0;s<9;s++){this.elements[s]=t[s+e]}return this}toArray(t=[],e=0){const s=this.elements;t[e]=s[0];t[e+1]=s[1];t[e+2]=s[2];t[e+3]=s[3];t[e+4]=s[4];t[e+5]=s[5];t[e+6]=s[6];t[e+7]=s[7];t[e+8]=s[8];return t}clone(){return new this.constructor().fromArray(this.elements)}}const s$=new sG;function sQ(t){for(let e=t.length-1;e>=0;--e){if(t[e]>=65535)return true}return false}const sK={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function s0(t,e){return new sK[t](e)}function s1(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function s2(){const t=s1("canvas");t.style.display="block";return t}const s3={};function s5(t){if(t in s3)return;s3[t]=true;console.warn(t)}function s4(t,e,s){return new Promise(function(i,n){function r(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:n();break;case t.TIMEOUT_EXPIRED:setTimeout(r,s);break;default:i()}}setTimeout(r,s)})}function s6(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3];e[6]=.5*e[6]+.5*e[7];e[10]=.5*e[10]+.5*e[11];e[14]=.5*e[14]+.5*e[15]}function s8(t){const e=t.elements;const s=e[11]===-1;if(s){e[10]=-e[10]-1;e[14]=-e[14]}else{e[10]=-e[10];e[14]=-e[14]+1}}const s9=new sG().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322);const s7=new sG().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function it(){const t={enabled:true,workingColorSpace:eU,spaces:{},convert:function(t,e,s){if(this.enabled===false||e===s||!e||!s){return t}if(this.spaces[e].transfer===eH){t.r=is(t.r);t.g=is(t.g);t.b=is(t.b)}if(this.spaces[e].primaries!==this.spaces[s].primaries){t.applyMatrix3(this.spaces[e].toXYZ);t.applyMatrix3(this.spaces[s].fromXYZ)}if(this.spaces[s].transfer===eH){t.r=ii(t.r);t.g=ii(t.g);t.b=ii(t.b)}return t},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)},getPrimaries:function(t){return this.spaces[t].primaries},getTransfer:function(t){if(t===ej)return eD;return this.spaces[t].transfer},getLuminanceCoefficients:function(t,e=this.workingColorSpace){return t.fromArray(this.spaces[e].luminanceCoefficients)},define:function(t){Object.assign(this.spaces,t)},_getMatrix:function(t,e,s){return t.copy(this.spaces[e].toXYZ).multiply(this.spaces[s].fromXYZ)},_getDrawingBufferColorSpace:function(t){return this.spaces[t].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(t=this.workingColorSpace){return this.spaces[t].workingColorSpaceConfig.unpackColorSpace}};const e=[.64,.33,.3,.6,.15,.06];const s=[.2126,.7152,.0722];const i=[.3127,.329];t.define({[eU]:{primaries:e,whitePoint:i,transfer:eD,toXYZ:s9,fromXYZ:s7,luminanceCoefficients:s,workingColorSpaceConfig:{unpackColorSpace:eW},outputColorSpaceConfig:{drawingBufferColorSpace:eW}},[eW]:{primaries:e,whitePoint:i,transfer:eH,toXYZ:s9,fromXYZ:s7,luminanceCoefficients:s,outputColorSpaceConfig:{drawingBufferColorSpace:eW}}});return t}const ie=it();function is(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function ii(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let ir;class io{static getDataURL(t,e="image/png"){if(/^data:/i.test(t.src)){return t.src}if(typeof HTMLCanvasElement==="undefined"){return t.src}let s;if(t instanceof HTMLCanvasElement){s=t}else{if(ir===undefined)ir=s1("canvas");ir.width=t.width;ir.height=t.height;const e=ir.getContext("2d");if(t instanceof ImageData){e.putImageData(t,0,0)}else{e.drawImage(t,0,0,t.width,t.height)}s=ir}return s.toDataURL(e)}static sRGBToLinear(t){if(typeof HTMLImageElement!=="undefined"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement!=="undefined"&&t instanceof HTMLCanvasElement||typeof ImageBitmap!=="undefined"&&t instanceof ImageBitmap){const e=s1("canvas");e.width=t.width;e.height=t.height;const s=e.getContext("2d");s.drawImage(t,0,0,t.width,t.height);const i=s.getImageData(0,0,t.width,t.height);const n=i.data;for(let t=0;t<n.length;t++){n[t]=is(n[t]/255)*255}s.putImageData(i,0,0);return e}else if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++){if(e instanceof Uint8Array||e instanceof Uint8ClampedArray){e[t]=Math.floor(is(e[t]/255)*255)}else{e[t]=is(e[t])}}return{data:e,width:t.width,height:t.height}}else{console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.");return t}}}let ia=0;class ih{constructor(t=null){this.isSource=true;Object.defineProperty(this,"id",{value:ia++});this.uuid=sT();this.data=t;this.dataReady=true;this.version=0}set needsUpdate(t){if(t===true)this.version++}toJSON(t){const e=t===undefined||typeof t==="string";if(!e&&t.images[this.uuid]!==undefined){return t.images[this.uuid]}const s={uuid:this.uuid,url:""};const i=this.data;if(i!==null){let t;if(Array.isArray(i)){t=[];for(let e=0,s=i.length;e<s;e++){if(i[e].isDataTexture){t.push(ic(i[e].image))}else{t.push(ic(i[e]))}}}else{t=ic(i)}s.url=t}if(!e){t.images[this.uuid]=s}return s}}function ic(t){if(typeof HTMLImageElement!=="undefined"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement!=="undefined"&&t instanceof HTMLCanvasElement||typeof ImageBitmap!=="undefined"&&t instanceof ImageBitmap){return io.getDataURL(t)}else{if(t.data){return{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}}else{console.warn("THREE.Texture: Unable to serialize Texture.");return{}}}}let il=0;class iu extends sM{constructor(t=iu.DEFAULT_IMAGE,e=iu.DEFAULT_MAPPING,s=tg,i=tg,n=t_,r=tz,o=tD,a=tC,h=iu.DEFAULT_ANISOTROPY,c=ej){super();this.isTexture=true;Object.defineProperty(this,"id",{value:il++});this.uuid=sT();this.name="";this.source=new ih(t);this.mipmaps=[];this.mapping=e;this.channel=0;this.wrapS=s;this.wrapT=i;this.magFilter=n;this.minFilter=r;this.anisotropy=h;this.format=o;this.internalFormat=null;this.type=a;this.offset=new sZ(0,0);this.repeat=new sZ(1,1);this.center=new sZ(0,0);this.rotation=0;this.matrixAutoUpdate=true;this.matrix=new sG;this.generateMipmaps=true;this.premultiplyAlpha=false;this.flipY=true;this.unpackAlignment=4;this.colorSpace=c;this.userData={};this.version=0;this.onUpdate=null;this.renderTarget=null;this.isRenderTargetTexture=false;this.isTextureArray=false;this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name;this.source=t.source;this.mipmaps=t.mipmaps.slice(0);this.mapping=t.mapping;this.channel=t.channel;this.wrapS=t.wrapS;this.wrapT=t.wrapT;this.magFilter=t.magFilter;this.minFilter=t.minFilter;this.anisotropy=t.anisotropy;this.format=t.format;this.internalFormat=t.internalFormat;this.type=t.type;this.offset.copy(t.offset);this.repeat.copy(t.repeat);this.center.copy(t.center);this.rotation=t.rotation;this.matrixAutoUpdate=t.matrixAutoUpdate;this.matrix.copy(t.matrix);this.generateMipmaps=t.generateMipmaps;this.premultiplyAlpha=t.premultiplyAlpha;this.flipY=t.flipY;this.unpackAlignment=t.unpackAlignment;this.colorSpace=t.colorSpace;this.renderTarget=t.renderTarget;this.isRenderTargetTexture=t.isRenderTargetTexture;this.isTextureArray=t.isTextureArray;this.userData=JSON.parse(JSON.stringify(t.userData));this.needsUpdate=true;return this}toJSON(t){const e=t===undefined||typeof t==="string";if(!e&&t.textures[this.uuid]!==undefined){return t.textures[this.uuid]}const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(Object.keys(this.userData).length>0)s.userData=this.userData;if(!e){t.textures[this.uuid]=s}return s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==tl)return t;t.applyMatrix3(this.matrix);if(t.x<0||t.x>1){switch(this.wrapS){case ty:t.x=t.x-Math.floor(t.x);break;case tg:t.x=t.x<0?0:1;break;case tx:if(Math.abs(Math.floor(t.x)%2)===1){t.x=Math.ceil(t.x)-t.x}else{t.x=t.x-Math.floor(t.x)}break}}if(t.y<0||t.y>1){switch(this.wrapT){case ty:t.y=t.y-Math.floor(t.y);break;case tg:t.y=t.y<0?0:1;break;case tx:if(Math.abs(Math.floor(t.y)%2)===1){t.y=Math.ceil(t.y)-t.y}else{t.y=t.y-Math.floor(t.y)}break}}if(this.flipY){t.y=1-t.y}return t}set needsUpdate(t){if(t===true){this.version++;this.source.needsUpdate=true}}set needsPMREMUpdate(t){if(t===true){this.pmremVersion++}}}iu.DEFAULT_IMAGE=null;iu.DEFAULT_MAPPING=tl;iu.DEFAULT_ANISOTROPY=1;class id{constructor(t=0,e=0,s=0,i=1){id.prototype.isVector4=true;this.x=t;this.y=e;this.z=s;this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,s,i){this.x=t;this.y=e;this.z=s;this.w=i;return this}setScalar(t){this.x=t;this.y=t;this.z=t;this.w=t;return this}setX(t){this.x=t;return this}setY(t){this.y=t;return this}setZ(t){this.z=t;return this}setW(t){this.w=t;return this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w!==undefined?t.w:1;return this}add(t){this.x+=t.x;this.y+=t.y;this.z+=t.z;this.w+=t.w;return this}addScalar(t){this.x+=t;this.y+=t;this.z+=t;this.w+=t;return this}addVectors(t,e){this.x=t.x+e.x;this.y=t.y+e.y;this.z=t.z+e.z;this.w=t.w+e.w;return this}addScaledVector(t,e){this.x+=t.x*e;this.y+=t.y*e;this.z+=t.z*e;this.w+=t.w*e;return this}sub(t){this.x-=t.x;this.y-=t.y;this.z-=t.z;this.w-=t.w;return this}subScalar(t){this.x-=t;this.y-=t;this.z-=t;this.w-=t;return this}subVectors(t,e){this.x=t.x-e.x;this.y=t.y-e.y;this.z=t.z-e.z;this.w=t.w-e.w;return this}multiply(t){this.x*=t.x;this.y*=t.y;this.z*=t.z;this.w*=t.w;return this}multiplyScalar(t){this.x*=t;this.y*=t;this.z*=t;this.w*=t;return this}applyMatrix4(t){const e=this.x,s=this.y,i=this.z,n=this.w;const r=t.elements;this.x=r[0]*e+r[4]*s+r[8]*i+r[12]*n;this.y=r[1]*e+r[5]*s+r[9]*i+r[13]*n;this.z=r[2]*e+r[6]*s+r[10]*i+r[14]*n;this.w=r[3]*e+r[7]*s+r[11]*i+r[15]*n;return this}divide(t){this.x/=t.x;this.y/=t.y;this.z/=t.z;this.w/=t.w;return this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);if(e<1e-4){this.x=1;this.y=0;this.z=0}else{this.x=t.x/e;this.y=t.y/e;this.z=t.z/e}return this}setAxisAngleFromRotationMatrix(t){let e,s,i,n;const r=.01,o=.1,a=t.elements,h=a[0],c=a[4],l=a[8],u=a[1],d=a[5],p=a[9],f=a[2],m=a[6],y=a[10];if(Math.abs(c-u)<r&&Math.abs(l-f)<r&&Math.abs(p-m)<r){if(Math.abs(c+u)<o&&Math.abs(l+f)<o&&Math.abs(p+m)<o&&Math.abs(h+d+y-3)<o){this.set(1,0,0,0);return this}e=Math.PI;const t=(h+1)/2;const a=(d+1)/2;const g=(y+1)/2;const x=(c+u)/4;const b=(l+f)/4;const w=(p+m)/4;if(t>a&&t>g){if(t<r){s=0;i=.707106781;n=.707106781}else{s=Math.sqrt(t);i=x/s;n=b/s}}else if(a>g){if(a<r){s=.707106781;i=0;n=.707106781}else{i=Math.sqrt(a);s=x/i;n=w/i}}else{if(g<r){s=.707106781;i=.707106781;n=0}else{n=Math.sqrt(g);s=b/n;i=w/n}}this.set(s,i,n,e);return this}let g=Math.sqrt((m-p)*(m-p)+(l-f)*(l-f)+(u-c)*(u-c));if(Math.abs(g)<.001)g=1;this.x=(m-p)/g;this.y=(l-f)/g;this.z=(u-c)/g;this.w=Math.acos((h+d+y-1)/2);return this}setFromMatrixPosition(t){const e=t.elements;this.x=e[12];this.y=e[13];this.z=e[14];this.w=e[15];return this}min(t){this.x=Math.min(this.x,t.x);this.y=Math.min(this.y,t.y);this.z=Math.min(this.z,t.z);this.w=Math.min(this.w,t.w);return this}max(t){this.x=Math.max(this.x,t.x);this.y=Math.max(this.y,t.y);this.z=Math.max(this.z,t.z);this.w=Math.max(this.w,t.w);return this}clamp(t,e){this.x=sz(this.x,t.x,e.x);this.y=sz(this.y,t.y,e.y);this.z=sz(this.z,t.z,e.z);this.w=sz(this.w,t.w,e.w);return this}clampScalar(t,e){this.x=sz(this.x,t,e);this.y=sz(this.y,t,e);this.z=sz(this.z,t,e);this.w=sz(this.w,t,e);return this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(sz(s,t,e))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);this.w=Math.trunc(this.w);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){this.x+=(t.x-this.x)*e;this.y+=(t.y-this.y)*e;this.z+=(t.z-this.z)*e;this.w+=(t.w-this.w)*e;return this}lerpVectors(t,e,s){this.x=t.x+(e.x-t.x)*s;this.y=t.y+(e.y-t.y)*s;this.z=t.z+(e.z-t.z)*s;this.w=t.w+(e.w-t.w)*s;return this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){this.x=t[e];this.y=t[e+1];this.z=t[e+2];this.w=t[e+3];return this}toArray(t=[],e=0){t[e]=this.x;t[e+1]=this.y;t[e+2]=this.z;t[e+3]=this.w;return t}fromBufferAttribute(t,e){this.x=t.getX(e);this.y=t.getY(e);this.z=t.getZ(e);this.w=t.getW(e);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();this.w=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z;yield this.w}}class ip extends sM{constructor(t=1,e=1,s={}){super();this.isRenderTarget=true;this.width=t;this.height=e;this.depth=s.depth?s.depth:1;this.scissor=new id(0,0,t,e);this.scissorTest=false;this.viewport=new id(0,0,t,e);const i={width:t,height:e,depth:this.depth};s=Object.assign({generateMipmaps:false,internalFormat:null,minFilter:t_,depthBuffer:true,stencilBuffer:false,resolveDepthBuffer:true,resolveStencilBuffer:true,depthTexture:null,samples:0,count:1,multiview:false},s);const n=new iu(i,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.colorSpace);n.flipY=false;n.generateMipmaps=s.generateMipmaps;n.internalFormat=s.internalFormat;this.textures=[];const r=s.count;for(let t=0;t<r;t++){this.textures[t]=n.clone();this.textures[t].isRenderTargetTexture=true;this.textures[t].renderTarget=this}this.depthBuffer=s.depthBuffer;this.stencilBuffer=s.stencilBuffer;this.resolveDepthBuffer=s.resolveDepthBuffer;this.resolveStencilBuffer=s.resolveStencilBuffer;this._depthTexture=null;this.depthTexture=s.depthTexture;this.samples=s.samples;this.multiview=s.multiview}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}set depthTexture(t){if(this._depthTexture!==null)this._depthTexture.renderTarget=null;if(t!==null)t.renderTarget=this;this._depthTexture=t}get depthTexture(){return this._depthTexture}setSize(t,e,s=1){if(this.width!==t||this.height!==e||this.depth!==s){this.width=t;this.height=e;this.depth=s;for(let i=0,n=this.textures.length;i<n;i++){this.textures[i].image.width=t;this.textures[i].image.height=e;this.textures[i].image.depth=s}this.dispose()}this.viewport.set(0,0,t,e);this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width;this.height=t.height;this.depth=t.depth;this.scissor.copy(t.scissor);this.scissorTest=t.scissorTest;this.viewport.copy(t.viewport);this.textures.length=0;for(let e=0,s=t.textures.length;e<s;e++){this.textures[e]=t.textures[e].clone();this.textures[e].isRenderTargetTexture=true;this.textures[e].renderTarget=this;const s=Object.assign({},t.textures[e].image);this.textures[e].source=new ih(s)}this.depthBuffer=t.depthBuffer;this.stencilBuffer=t.stencilBuffer;this.resolveDepthBuffer=t.resolveDepthBuffer;this.resolveStencilBuffer=t.resolveStencilBuffer;if(t.depthTexture!==null)this.depthTexture=t.depthTexture.clone();this.samples=t.samples;return this}dispose(){this.dispatchEvent({type:"dispose"})}}class im extends ip{constructor(t=1,e=1,s={}){super(t,e,s);this.isWebGLRenderTarget=true}}class iy extends iu{constructor(t=null,e=1,s=1,i=1){super(null);this.isDataArrayTexture=true;this.image={data:t,width:e,height:s,depth:i};this.magFilter=tb;this.minFilter=tb;this.wrapR=tg;this.generateMipmaps=false;this.flipY=false;this.unpackAlignment=1;this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class ig extends im{constructor(t=1,e=1,s=1,i={}){super(t,e,i);this.isWebGLArrayRenderTarget=true;this.depth=s;this.texture=new iy(null,t,e,s);this.texture.isRenderTargetTexture=true}}class ix extends iu{constructor(t=null,e=1,s=1,i=1){super(null);this.isData3DTexture=true;this.image={data:t,width:e,height:s,depth:i};this.magFilter=tb;this.minFilter=tb;this.wrapR=tg;this.generateMipmaps=false;this.flipY=false;this.unpackAlignment=1}}class ib extends im{constructor(t=1,e=1,s=1,i={}){super(t,e,i);this.isWebGL3DRenderTarget=true;this.depth=s;this.texture=new ix(null,t,e,s);this.texture.isRenderTargetTexture=true}}class iw{constructor(t=0,e=0,s=0,i=1){this.isQuaternion=true;this._x=t;this._y=e;this._z=s;this._w=i}static slerpFlat(t,e,s,i,n,r,o){let a=s[i+0],h=s[i+1],c=s[i+2],l=s[i+3];const u=n[r+0],d=n[r+1],p=n[r+2],f=n[r+3];if(o===0){t[e+0]=a;t[e+1]=h;t[e+2]=c;t[e+3]=l;return}if(o===1){t[e+0]=u;t[e+1]=d;t[e+2]=p;t[e+3]=f;return}if(l!==f||a!==u||h!==d||c!==p){let t=1-o;const e=a*u+h*d+c*p+l*f,s=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const n=Math.sqrt(i),r=Math.atan2(n,e*s);t=Math.sin(t*r)/n;o=Math.sin(o*r)/n}const n=o*s;a=a*t+u*n;h=h*t+d*n;c=c*t+p*n;l=l*t+f*n;if(t===1-o){const t=1/Math.sqrt(a*a+h*h+c*c+l*l);a*=t;h*=t;c*=t;l*=t}}t[e]=a;t[e+1]=h;t[e+2]=c;t[e+3]=l}static multiplyQuaternionsFlat(t,e,s,i,n,r){const o=s[i];const a=s[i+1];const h=s[i+2];const c=s[i+3];const l=n[r];const u=n[r+1];const d=n[r+2];const p=n[r+3];t[e]=o*p+c*l+a*d-h*u;t[e+1]=a*p+c*u+h*l-o*d;t[e+2]=h*p+c*d+o*u-a*l;t[e+3]=c*p-o*l-a*u-h*d;return t}get x(){return this._x}set x(t){this._x=t;this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t;this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t;this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t;this._onChangeCallback()}set(t,e,s,i){this._x=t;this._y=e;this._z=s;this._w=i;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){this._x=t.x;this._y=t.y;this._z=t.z;this._w=t.w;this._onChangeCallback();return this}setFromEuler(t,e=true){const s=t._x,i=t._y,n=t._z,r=t._order;const o=Math.cos;const a=Math.sin;const h=o(s/2);const c=o(i/2);const l=o(n/2);const u=a(s/2);const d=a(i/2);const p=a(n/2);switch(r){case"XYZ":this._x=u*c*l+h*d*p;this._y=h*d*l-u*c*p;this._z=h*c*p+u*d*l;this._w=h*c*l-u*d*p;break;case"YXZ":this._x=u*c*l+h*d*p;this._y=h*d*l-u*c*p;this._z=h*c*p-u*d*l;this._w=h*c*l+u*d*p;break;case"ZXY":this._x=u*c*l-h*d*p;this._y=h*d*l+u*c*p;this._z=h*c*p+u*d*l;this._w=h*c*l-u*d*p;break;case"ZYX":this._x=u*c*l-h*d*p;this._y=h*d*l+u*c*p;this._z=h*c*p-u*d*l;this._w=h*c*l+u*d*p;break;case"YZX":this._x=u*c*l+h*d*p;this._y=h*d*l+u*c*p;this._z=h*c*p-u*d*l;this._w=h*c*l-u*d*p;break;case"XZY":this._x=u*c*l-h*d*p;this._y=h*d*l-u*c*p;this._z=h*c*p+u*d*l;this._w=h*c*l+u*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+r)}if(e===true)this._onChangeCallback();return this}setFromAxisAngle(t,e){const s=e/2,i=Math.sin(s);this._x=t.x*i;this._y=t.y*i;this._z=t.z*i;this._w=Math.cos(s);this._onChangeCallback();return this}setFromRotationMatrix(t){const e=t.elements,s=e[0],i=e[4],n=e[8],r=e[1],o=e[5],a=e[9],h=e[2],c=e[6],l=e[10],u=s+o+l;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t;this._x=(c-a)*t;this._y=(n-h)*t;this._z=(r-i)*t}else if(s>o&&s>l){const t=2*Math.sqrt(1+s-o-l);this._w=(c-a)/t;this._x=.25*t;this._y=(i+r)/t;this._z=(n+h)/t}else if(o>l){const t=2*Math.sqrt(1+o-s-l);this._w=(n-h)/t;this._x=(i+r)/t;this._y=.25*t;this._z=(a+c)/t}else{const t=2*Math.sqrt(1+l-s-o);this._w=(r-i)/t;this._x=(n+h)/t;this._y=(a+c)/t;this._z=.25*t}this._onChangeCallback();return this}setFromUnitVectors(t,e){let s=t.dot(e)+1;if(s<Number.EPSILON){s=0;if(Math.abs(t.x)>Math.abs(t.z)){this._x=-t.y;this._y=t.x;this._z=0;this._w=s}else{this._x=0;this._y=-t.z;this._z=t.y;this._w=s}}else{this._x=t.y*e.z-t.z*e.y;this._y=t.z*e.x-t.x*e.z;this._z=t.x*e.y-t.y*e.x;this._w=s}return this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(sz(this.dot(t),-1,1)))}rotateTowards(t,e){const s=this.angleTo(t);if(s===0)return this;const i=Math.min(1,e/s);this.slerp(t,i);return this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){this._x*=-1;this._y*=-1;this._z*=-1;this._onChangeCallback();return this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();if(t===0){this._x=0;this._y=0;this._z=0;this._w=1}else{t=1/t;this._x=this._x*t;this._y=this._y*t;this._z=this._z*t;this._w=this._w*t}this._onChangeCallback();return this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const s=t._x,i=t._y,n=t._z,r=t._w;const o=e._x,a=e._y,h=e._z,c=e._w;this._x=s*c+r*o+i*h-n*a;this._y=i*c+r*a+n*o-s*h;this._z=n*c+r*h+s*a-i*o;this._w=r*c-s*o-i*a-n*h;this._onChangeCallback();return this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const s=this._x,i=this._y,n=this._z,r=this._w;let o=r*t._w+s*t._x+i*t._y+n*t._z;if(o<0){this._w=-t._w;this._x=-t._x;this._y=-t._y;this._z=-t._z;o=-o}else{this.copy(t)}if(o>=1){this._w=r;this._x=s;this._y=i;this._z=n;return this}const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;this._w=t*r+e*this._w;this._x=t*s+e*this._x;this._y=t*i+e*this._y;this._z=t*n+e*this._z;this.normalize();return this}const h=Math.sqrt(a);const c=Math.atan2(h,o);const l=Math.sin((1-e)*c)/h,u=Math.sin(e*c)/h;this._w=r*l+this._w*u;this._x=s*l+this._x*u;this._y=i*l+this._y*u;this._z=n*l+this._z*u;this._onChangeCallback();return this}slerpQuaternions(t,e,s){return this.copy(t).slerp(e,s)}random(){const t=2*Math.PI*Math.random();const e=2*Math.PI*Math.random();const s=Math.random();const i=Math.sqrt(1-s);const n=Math.sqrt(s);return this.set(i*Math.sin(t),i*Math.cos(t),n*Math.sin(e),n*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){this._x=t[e];this._y=t[e+1];this._z=t[e+2];this._w=t[e+3];this._onChangeCallback();return this}toArray(t=[],e=0){t[e]=this._x;t[e+1]=this._y;t[e+2]=this._z;t[e+3]=this._w;return t}fromBufferAttribute(t,e){this._x=t.getX(e);this._y=t.getY(e);this._z=t.getZ(e);this._w=t.getW(e);this._onChangeCallback();return this}toJSON(){return this.toArray()}_onChange(t){this._onChangeCallback=t;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._w}}class iM{constructor(t=0,e=0,s=0){iM.prototype.isVector3=true;this.x=t;this.y=e;this.z=s}set(t,e,s){if(s===undefined)s=this.z;this.x=t;this.y=e;this.z=s;return this}setScalar(t){this.x=t;this.y=t;this.z=t;return this}setX(t){this.x=t;return this}setY(t){this.y=t;return this}setZ(t){this.z=t;return this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){this.x=t.x;this.y=t.y;this.z=t.z;return this}add(t){this.x+=t.x;this.y+=t.y;this.z+=t.z;return this}addScalar(t){this.x+=t;this.y+=t;this.z+=t;return this}addVectors(t,e){this.x=t.x+e.x;this.y=t.y+e.y;this.z=t.z+e.z;return this}addScaledVector(t,e){this.x+=t.x*e;this.y+=t.y*e;this.z+=t.z*e;return this}sub(t){this.x-=t.x;this.y-=t.y;this.z-=t.z;return this}subScalar(t){this.x-=t;this.y-=t;this.z-=t;return this}subVectors(t,e){this.x=t.x-e.x;this.y=t.y-e.y;this.z=t.z-e.z;return this}multiply(t){this.x*=t.x;this.y*=t.y;this.z*=t.z;return this}multiplyScalar(t){this.x*=t;this.y*=t;this.z*=t;return this}multiplyVectors(t,e){this.x=t.x*e.x;this.y=t.y*e.y;this.z=t.z*e.z;return this}applyEuler(t){return this.applyQuaternion(iS.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(iS.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,s=this.y,i=this.z;const n=t.elements;this.x=n[0]*e+n[3]*s+n[6]*i;this.y=n[1]*e+n[4]*s+n[7]*i;this.z=n[2]*e+n[5]*s+n[8]*i;return this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,s=this.y,i=this.z;const n=t.elements;const r=1/(n[3]*e+n[7]*s+n[11]*i+n[15]);this.x=(n[0]*e+n[4]*s+n[8]*i+n[12])*r;this.y=(n[1]*e+n[5]*s+n[9]*i+n[13])*r;this.z=(n[2]*e+n[6]*s+n[10]*i+n[14])*r;return this}applyQuaternion(t){const e=this.x,s=this.y,i=this.z;const n=t.x,r=t.y,o=t.z,a=t.w;const h=2*(r*i-o*s);const c=2*(o*e-n*i);const l=2*(n*s-r*e);this.x=e+a*h+r*l-o*c;this.y=s+a*c+o*h-n*l;this.z=i+a*l+n*c-r*h;return this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,s=this.y,i=this.z;const n=t.elements;this.x=n[0]*e+n[4]*s+n[8]*i;this.y=n[1]*e+n[5]*s+n[9]*i;this.z=n[2]*e+n[6]*s+n[10]*i;return this.normalize()}divide(t){this.x/=t.x;this.y/=t.y;this.z/=t.z;return this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){this.x=Math.min(this.x,t.x);this.y=Math.min(this.y,t.y);this.z=Math.min(this.z,t.z);return this}max(t){this.x=Math.max(this.x,t.x);this.y=Math.max(this.y,t.y);this.z=Math.max(this.z,t.z);return this}clamp(t,e){this.x=sz(this.x,t.x,e.x);this.y=sz(this.y,t.y,e.y);this.z=sz(this.z,t.z,e.z);return this}clampScalar(t,e){this.x=sz(this.x,t,e);this.y=sz(this.y,t,e);this.z=sz(this.z,t,e);return this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(sz(s,t,e))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){this.x+=(t.x-this.x)*e;this.y+=(t.y-this.y)*e;this.z+=(t.z-this.z)*e;return this}lerpVectors(t,e,s){this.x=t.x+(e.x-t.x)*s;this.y=t.y+(e.y-t.y)*s;this.z=t.z+(e.z-t.z)*s;return this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const s=t.x,i=t.y,n=t.z;const r=e.x,o=e.y,a=e.z;this.x=i*a-n*o;this.y=n*r-s*a;this.z=s*o-i*r;return this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const s=t.dot(this)/e;return this.copy(t).multiplyScalar(s)}projectOnPlane(t){iv.copy(this).projectOnVector(t);return this.sub(iv)}reflect(t){return this.sub(iv.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const s=this.dot(t)/e;return Math.acos(sz(s,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y,i=this.z-t.z;return e*e+s*s+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,s){const i=Math.sin(e)*t;this.x=i*Math.sin(s);this.y=Math.cos(e)*t;this.z=i*Math.cos(s);return this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,s){this.x=t*Math.sin(e);this.y=s;this.z=t*Math.cos(e);return this}setFromMatrixPosition(t){const e=t.elements;this.x=e[12];this.y=e[13];this.z=e[14];return this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length();const s=this.setFromMatrixColumn(t,1).length();const i=this.setFromMatrixColumn(t,2).length();this.x=e;this.y=s;this.z=i;return this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){this.x=t._x;this.y=t._y;this.z=t._z;return this}setFromColor(t){this.x=t.r;this.y=t.g;this.z=t.b;return this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){this.x=t[e];this.y=t[e+1];this.z=t[e+2];return this}toArray(t=[],e=0){t[e]=this.x;t[e+1]=this.y;t[e+2]=this.z;return t}fromBufferAttribute(t,e){this.x=t.getX(e);this.y=t.getY(e);this.z=t.getZ(e);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();return this}randomDirection(){const t=Math.random()*Math.PI*2;const e=Math.random()*2-1;const s=Math.sqrt(1-e*e);this.x=s*Math.cos(t);this.y=e;this.z=s*Math.sin(t);return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z}}const iv=new iM;const iS=new iw;class i_{constructor(t=new iM(+Infinity,+Infinity,+Infinity),e=new iM(-Infinity,-Infinity,-Infinity)){this.isBox3=true;this.min=t;this.max=e}set(t,e){this.min.copy(t);this.max.copy(e);return this}setFromArray(t){this.makeEmpty();for(let e=0,s=t.length;e<s;e+=3){this.expandByPoint(iT.fromArray(t,e))}return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,s=t.count;e<s;e++){this.expandByPoint(iT.fromBufferAttribute(t,e))}return this}setFromPoints(t){this.makeEmpty();for(let e=0,s=t.length;e<s;e++){this.expandByPoint(t[e])}return this}setFromCenterAndSize(t,e){const s=iT.copy(e).multiplyScalar(.5);this.min.copy(t).sub(s);this.max.copy(t).add(s);return this}setFromObject(t,e=false){this.makeEmpty();return this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){this.min.copy(t.min);this.max.copy(t.max);return this}makeEmpty(){this.min.x=this.min.y=this.min.z=+Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){this.min.min(t);this.max.max(t);return this}expandByVector(t){this.min.sub(t);this.max.add(t);return this}expandByScalar(t){this.min.addScalar(-t);this.max.addScalar(t);return this}expandByObject(t,e=false){t.updateWorldMatrix(false,false);const s=t.geometry;if(s!==undefined){const i=s.getAttribute("position");if(e===true&&i!==undefined&&t.isInstancedMesh!==true){for(let e=0,s=i.count;e<s;e++){if(t.isMesh===true){t.getVertexPosition(e,iT)}else{iT.fromBufferAttribute(i,e)}iT.applyMatrix4(t.matrixWorld);this.expandByPoint(iT)}}else{if(t.boundingBox!==undefined){if(t.boundingBox===null){t.computeBoundingBox()}iz.copy(t.boundingBox)}else{if(s.boundingBox===null){s.computeBoundingBox()}iz.copy(s.boundingBox)}iz.applyMatrix4(t.matrixWorld);this.union(iz)}}const i=t.children;for(let t=0,s=i.length;t<s;t++){this.expandByObject(i[t],e)}return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){this.clampPoint(t.center,iT);return iT.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,s;if(t.normal.x>0){e=t.normal.x*this.min.x;s=t.normal.x*this.max.x}else{e=t.normal.x*this.max.x;s=t.normal.x*this.min.x}if(t.normal.y>0){e+=t.normal.y*this.min.y;s+=t.normal.y*this.max.y}else{e+=t.normal.y*this.max.y;s+=t.normal.y*this.min.y}if(t.normal.z>0){e+=t.normal.z*this.min.z;s+=t.normal.z*this.max.z}else{e+=t.normal.z*this.max.z;s+=t.normal.z*this.min.z}return e<=-t.constant&&s>=-t.constant}intersectsTriangle(t){if(this.isEmpty()){return false}this.getCenter(iP);iO.subVectors(this.max,iP);iI.subVectors(t.a,iP);iC.subVectors(t.b,iP);iB.subVectors(t.c,iP);ik.subVectors(iC,iI);iR.subVectors(iB,iC);iE.subVectors(iI,iB);let e=[0,-ik.z,ik.y,0,-iR.z,iR.y,0,-iE.z,iE.y,ik.z,0,-ik.x,iR.z,0,-iR.x,iE.z,0,-iE.x,-ik.y,ik.x,0,-iR.y,iR.x,0,-iE.y,iE.x,0];if(!iV(e,iI,iC,iB,iO)){return false}e=[1,0,0,0,1,0,0,0,1];if(!iV(e,iI,iC,iB,iO)){return false}iF.crossVectors(ik,iR);e=[iF.x,iF.y,iF.z];return iV(e,iI,iC,iB,iO)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,iT).distanceTo(t)}getBoundingSphere(t){if(this.isEmpty()){t.makeEmpty()}else{this.getCenter(t.center);t.radius=this.getSize(iT).length()*.5}return t}intersect(t){this.min.max(t.min);this.max.min(t.max);if(this.isEmpty())this.makeEmpty();return this}union(t){this.min.min(t.min);this.max.max(t.max);return this}applyMatrix4(t){if(this.isEmpty())return this;iA[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t);iA[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t);iA[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t);iA[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t);iA[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t);iA[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t);iA[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t);iA[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t);this.setFromPoints(iA);return this}translate(t){this.min.add(t);this.max.add(t);return this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const iA=[new iM,new iM,new iM,new iM,new iM,new iM,new iM,new iM];const iT=new iM;const iz=new i_;const iI=new iM;const iC=new iM;const iB=new iM;const ik=new iM;const iR=new iM;const iE=new iM;const iP=new iM;const iO=new iM;const iF=new iM;const iN=new iM;function iV(t,e,s,i,n){for(let r=0,o=t.length-3;r<=o;r+=3){iN.fromArray(t,r);const o=n.x*Math.abs(iN.x)+n.y*Math.abs(iN.y)+n.z*Math.abs(iN.z);const a=e.dot(iN);const h=s.dot(iN);const c=i.dot(iN);if(Math.max(-Math.max(a,h,c),Math.min(a,h,c))>o){return false}}return true}const iL=new i_;const ij=new iM;const iW=new iM;class iU{constructor(t=new iM,e=-1){this.isSphere=true;this.center=t;this.radius=e}set(t,e){this.center.copy(t);this.radius=e;return this}setFromPoints(t,e){const s=this.center;if(e!==undefined){s.copy(e)}else{iL.setFromPoints(t).getCenter(s)}let i=0;for(let e=0,n=t.length;e<n;e++){i=Math.max(i,s.distanceToSquared(t[e]))}this.radius=Math.sqrt(i);return this}copy(t){this.center.copy(t.center);this.radius=t.radius;return this}isEmpty(){return this.radius<0}makeEmpty(){this.center.set(0,0,0);this.radius=-1;return this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const s=this.center.distanceToSquared(t);e.copy(t);if(s>this.radius*this.radius){e.sub(this.center).normalize();e.multiplyScalar(this.radius).add(this.center)}return e}getBoundingBox(t){if(this.isEmpty()){t.makeEmpty();return t}t.set(this.center,this.center);t.expandByScalar(this.radius);return t}applyMatrix4(t){this.center.applyMatrix4(t);this.radius=this.radius*t.getMaxScaleOnAxis();return this}translate(t){this.center.add(t);return this}expandByPoint(t){if(this.isEmpty()){this.center.copy(t);this.radius=0;return this}ij.subVectors(t,this.center);const e=ij.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e);const s=(t-this.radius)*.5;this.center.addScaledVector(ij,s/t);this.radius+=s}return this}union(t){if(t.isEmpty()){return this}if(this.isEmpty()){this.copy(t);return this}if(this.center.equals(t.center)===true){this.radius=Math.max(this.radius,t.radius)}else{iW.subVectors(t.center,this.center).setLength(t.radius);this.expandByPoint(ij.copy(t.center).add(iW));this.expandByPoint(ij.copy(t.center).sub(iW))}return this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const iD=new iM;const iH=new iM;const iq=new iM;const iJ=new iM;const iX=new iM;const iY=new iM;const iZ=new iM;class iG{constructor(t=new iM,e=new iM(0,0,-1)){this.origin=t;this.direction=e}set(t,e){this.origin.copy(t);this.direction.copy(e);return this}copy(t){this.origin.copy(t.origin);this.direction.copy(t.direction);return this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){this.direction.copy(t).sub(this.origin).normalize();return this}recast(t){this.origin.copy(this.at(t,iD));return this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const s=e.dot(this.direction);if(s<0){return e.copy(this.origin)}return e.copy(this.origin).addScaledVector(this.direction,s)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=iD.subVectors(t,this.origin).dot(this.direction);if(e<0){return this.origin.distanceToSquared(t)}iD.copy(this.origin).addScaledVector(this.direction,e);return iD.distanceToSquared(t)}distanceSqToSegment(t,e,s,i){iH.copy(t).add(e).multiplyScalar(.5);iq.copy(e).sub(t).normalize();iJ.copy(this.origin).sub(iH);const n=t.distanceTo(e)*.5;const r=-this.direction.dot(iq);const o=iJ.dot(this.direction);const a=-iJ.dot(iq);const h=iJ.lengthSq();const c=Math.abs(1-r*r);let l,u,d,p;if(c>0){l=r*a-o;u=r*o-a;p=n*c;if(l>=0){if(u>=-p){if(u<=p){const t=1/c;l*=t;u*=t;d=l*(l+r*u+2*o)+u*(r*l+u+2*a)+h}else{u=n;l=Math.max(0,-(r*u+o));d=-l*l+u*(u+2*a)+h}}else{u=-n;l=Math.max(0,-(r*u+o));d=-l*l+u*(u+2*a)+h}}else{if(u<=-p){l=Math.max(0,-(-r*n+o));u=l>0?-n:Math.min(Math.max(-n,-a),n);d=-l*l+u*(u+2*a)+h}else if(u<=p){l=0;u=Math.min(Math.max(-n,-a),n);d=u*(u+2*a)+h}else{l=Math.max(0,-(r*n+o));u=l>0?n:Math.min(Math.max(-n,-a),n);d=-l*l+u*(u+2*a)+h}}}else{u=r>0?-n:n;l=Math.max(0,-(r*u+o));d=-l*l+u*(u+2*a)+h}if(s){s.copy(this.origin).addScaledVector(this.direction,l)}if(i){i.copy(iH).addScaledVector(iq,u)}return d}intersectSphere(t,e){iD.subVectors(t.center,this.origin);const s=iD.dot(this.direction);const i=iD.dot(iD)-s*s;const n=t.radius*t.radius;if(i>n)return null;const r=Math.sqrt(n-i);const o=s-r;const a=s+r;if(a<0)return null;if(o<0)return this.at(a,e);return this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0){if(t.distanceToPoint(this.origin)===0){return 0}return null}const s=-(this.origin.dot(t.normal)+t.constant)/e;return s>=0?s:null}intersectPlane(t,e){const s=this.distanceToPlane(t);if(s===null){return null}return this.at(s,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(e===0){return true}const s=t.normal.dot(this.direction);if(s*e<0){return true}return false}intersectBox(t,e){let s,i,n,r,o,a;const h=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z;const u=this.origin;if(h>=0){s=(t.min.x-u.x)*h;i=(t.max.x-u.x)*h}else{s=(t.max.x-u.x)*h;i=(t.min.x-u.x)*h}if(c>=0){n=(t.min.y-u.y)*c;r=(t.max.y-u.y)*c}else{n=(t.max.y-u.y)*c;r=(t.min.y-u.y)*c}if(s>r||n>i)return null;if(n>s||isNaN(s))s=n;if(r<i||isNaN(i))i=r;if(l>=0){o=(t.min.z-u.z)*l;a=(t.max.z-u.z)*l}else{o=(t.max.z-u.z)*l;a=(t.min.z-u.z)*l}if(s>a||o>i)return null;if(o>s||s!==s)s=o;if(a<i||i!==i)i=a;if(i<0)return null;return this.at(s>=0?s:i,e)}intersectsBox(t){return this.intersectBox(t,iD)!==null}intersectTriangle(t,e,s,i,n){iX.subVectors(e,t);iY.subVectors(s,t);iZ.crossVectors(iX,iY);let r=this.direction.dot(iZ);let o;if(r>0){if(i)return null;o=1}else if(r<0){o=-1;r=-r}else{return null}iJ.subVectors(this.origin,t);const a=o*this.direction.dot(iY.crossVectors(iJ,iY));if(a<0){return null}const h=o*this.direction.dot(iX.cross(iJ));if(h<0){return null}if(a+h>r){return null}const c=-o*iJ.dot(iZ);if(c<0){return null}return this.at(c/r,n)}applyMatrix4(t){this.origin.applyMatrix4(t);this.direction.transformDirection(t);return this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class i${constructor(t,e,s,i,n,r,o,a,h,c,l,u,d,p,f,m){i$.prototype.isMatrix4=true;this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];if(t!==undefined){this.set(t,e,s,i,n,r,o,a,h,c,l,u,d,p,f,m)}}set(t,e,s,i,n,r,o,a,h,c,l,u,d,p,f,m){const y=this.elements;y[0]=t;y[4]=e;y[8]=s;y[12]=i;y[1]=n;y[5]=r;y[9]=o;y[13]=a;y[2]=h;y[6]=c;y[10]=l;y[14]=u;y[3]=d;y[7]=p;y[11]=f;y[15]=m;return this}identity(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this}clone(){return new i$().fromArray(this.elements)}copy(t){const e=this.elements;const s=t.elements;e[0]=s[0];e[1]=s[1];e[2]=s[2];e[3]=s[3];e[4]=s[4];e[5]=s[5];e[6]=s[6];e[7]=s[7];e[8]=s[8];e[9]=s[9];e[10]=s[10];e[11]=s[11];e[12]=s[12];e[13]=s[13];e[14]=s[14];e[15]=s[15];return this}copyPosition(t){const e=this.elements,s=t.elements;e[12]=s[12];e[13]=s[13];e[14]=s[14];return this}setFromMatrix3(t){const e=t.elements;this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1);return this}extractBasis(t,e,s){t.setFromMatrixColumn(this,0);e.setFromMatrixColumn(this,1);s.setFromMatrixColumn(this,2);return this}makeBasis(t,e,s){this.set(t.x,e.x,s.x,0,t.y,e.y,s.y,0,t.z,e.z,s.z,0,0,0,0,1);return this}extractRotation(t){const e=this.elements;const s=t.elements;const i=1/iQ.setFromMatrixColumn(t,0).length();const n=1/iQ.setFromMatrixColumn(t,1).length();const r=1/iQ.setFromMatrixColumn(t,2).length();e[0]=s[0]*i;e[1]=s[1]*i;e[2]=s[2]*i;e[3]=0;e[4]=s[4]*n;e[5]=s[5]*n;e[6]=s[6]*n;e[7]=0;e[8]=s[8]*r;e[9]=s[9]*r;e[10]=s[10]*r;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return this}makeRotationFromEuler(t){const e=this.elements;const s=t.x,i=t.y,n=t.z;const r=Math.cos(s),o=Math.sin(s);const a=Math.cos(i),h=Math.sin(i);const c=Math.cos(n),l=Math.sin(n);if(t.order==="XYZ"){const t=r*c,s=r*l,i=o*c,n=o*l;e[0]=a*c;e[4]=-a*l;e[8]=h;e[1]=s+i*h;e[5]=t-n*h;e[9]=-o*a;e[2]=n-t*h;e[6]=i+s*h;e[10]=r*a}else if(t.order==="YXZ"){const t=a*c,s=a*l,i=h*c,n=h*l;e[0]=t+n*o;e[4]=i*o-s;e[8]=r*h;e[1]=r*l;e[5]=r*c;e[9]=-o;e[2]=s*o-i;e[6]=n+t*o;e[10]=r*a}else if(t.order==="ZXY"){const t=a*c,s=a*l,i=h*c,n=h*l;e[0]=t-n*o;e[4]=-r*l;e[8]=i+s*o;e[1]=s+i*o;e[5]=r*c;e[9]=n-t*o;e[2]=-r*h;e[6]=o;e[10]=r*a}else if(t.order==="ZYX"){const t=r*c,s=r*l,i=o*c,n=o*l;e[0]=a*c;e[4]=i*h-s;e[8]=t*h+n;e[1]=a*l;e[5]=n*h+t;e[9]=s*h-i;e[2]=-h;e[6]=o*a;e[10]=r*a}else if(t.order==="YZX"){const t=r*a,s=r*h,i=o*a,n=o*h;e[0]=a*c;e[4]=n-t*l;e[8]=i*l+s;e[1]=l;e[5]=r*c;e[9]=-o*c;e[2]=-h*c;e[6]=s*l+i;e[10]=t-n*l}else if(t.order==="XZY"){const t=r*a,s=r*h,i=o*a,n=o*h;e[0]=a*c;e[4]=-l;e[8]=h*c;e[1]=t*l+n;e[5]=r*c;e[9]=s*l-i;e[2]=i*l-s;e[6]=o*c;e[10]=n*l+t}e[3]=0;e[7]=0;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return this}makeRotationFromQuaternion(t){return this.compose(i0,t,i1)}lookAt(t,e,s){const i=this.elements;i5.subVectors(t,e);if(i5.lengthSq()===0){i5.z=1}i5.normalize();i2.crossVectors(s,i5);if(i2.lengthSq()===0){if(Math.abs(s.z)===1){i5.x+=1e-4}else{i5.z+=1e-4}i5.normalize();i2.crossVectors(s,i5)}i2.normalize();i3.crossVectors(i5,i2);i[0]=i2.x;i[4]=i3.x;i[8]=i5.x;i[1]=i2.y;i[5]=i3.y;i[9]=i5.y;i[2]=i2.z;i[6]=i3.z;i[10]=i5.z;return this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const s=t.elements;const i=e.elements;const n=this.elements;const r=s[0],o=s[4],a=s[8],h=s[12];const c=s[1],l=s[5],u=s[9],d=s[13];const p=s[2],f=s[6],m=s[10],y=s[14];const g=s[3],x=s[7],b=s[11],w=s[15];const M=i[0],v=i[4],S=i[8],_=i[12];const A=i[1],T=i[5],z=i[9],I=i[13];const C=i[2],B=i[6],k=i[10],R=i[14];const E=i[3],P=i[7],O=i[11],F=i[15];n[0]=r*M+o*A+a*C+h*E;n[4]=r*v+o*T+a*B+h*P;n[8]=r*S+o*z+a*k+h*O;n[12]=r*_+o*I+a*R+h*F;n[1]=c*M+l*A+u*C+d*E;n[5]=c*v+l*T+u*B+d*P;n[9]=c*S+l*z+u*k+d*O;n[13]=c*_+l*I+u*R+d*F;n[2]=p*M+f*A+m*C+y*E;n[6]=p*v+f*T+m*B+y*P;n[10]=p*S+f*z+m*k+y*O;n[14]=p*_+f*I+m*R+y*F;n[3]=g*M+x*A+b*C+w*E;n[7]=g*v+x*T+b*B+w*P;n[11]=g*S+x*z+b*k+w*O;n[15]=g*_+x*I+b*R+w*F;return this}multiplyScalar(t){const e=this.elements;e[0]*=t;e[4]*=t;e[8]*=t;e[12]*=t;e[1]*=t;e[5]*=t;e[9]*=t;e[13]*=t;e[2]*=t;e[6]*=t;e[10]*=t;e[14]*=t;e[3]*=t;e[7]*=t;e[11]*=t;e[15]*=t;return this}determinant(){const t=this.elements;const e=t[0],s=t[4],i=t[8],n=t[12];const r=t[1],o=t[5],a=t[9],h=t[13];const c=t[2],l=t[6],u=t[10],d=t[14];const p=t[3],f=t[7],m=t[11],y=t[15];return p*(+n*a*l-i*h*l-n*o*u+s*h*u+i*o*d-s*a*d)+f*(+e*a*d-e*h*u+n*r*u-i*r*d+i*h*c-n*a*c)+m*(+e*h*l-e*o*d-n*r*l+s*r*d+n*o*c-s*h*c)+y*(-i*o*c-e*a*l+e*o*u+i*r*l-s*r*u+s*a*c)}transpose(){const t=this.elements;let e;e=t[1];t[1]=t[4];t[4]=e;e=t[2];t[2]=t[8];t[8]=e;e=t[6];t[6]=t[9];t[9]=e;e=t[3];t[3]=t[12];t[12]=e;e=t[7];t[7]=t[13];t[13]=e;e=t[11];t[11]=t[14];t[14]=e;return this}setPosition(t,e,s){const i=this.elements;if(t.isVector3){i[12]=t.x;i[13]=t.y;i[14]=t.z}else{i[12]=t;i[13]=e;i[14]=s}return this}invert(){const t=this.elements,e=t[0],s=t[1],i=t[2],n=t[3],r=t[4],o=t[5],a=t[6],h=t[7],c=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],m=t[14],y=t[15],g=l*m*h-f*u*h+f*a*d-o*m*d-l*a*y+o*u*y,x=p*u*h-c*m*h-p*a*d+r*m*d+c*a*y-r*u*y,b=c*f*h-p*l*h+p*o*d-r*f*d-c*o*y+r*l*y,w=p*l*a-c*f*a-p*o*u+r*f*u+c*o*m-r*l*m;const M=e*g+s*x+i*b+n*w;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const v=1/M;t[0]=g*v;t[1]=(f*u*n-l*m*n-f*i*d+s*m*d+l*i*y-s*u*y)*v;t[2]=(o*m*n-f*a*n+f*i*h-s*m*h-o*i*y+s*a*y)*v;t[3]=(l*a*n-o*u*n-l*i*h+s*u*h+o*i*d-s*a*d)*v;t[4]=x*v;t[5]=(c*m*n-p*u*n+p*i*d-e*m*d-c*i*y+e*u*y)*v;t[6]=(p*a*n-r*m*n-p*i*h+e*m*h+r*i*y-e*a*y)*v;t[7]=(r*u*n-c*a*n+c*i*h-e*u*h-r*i*d+e*a*d)*v;t[8]=b*v;t[9]=(p*l*n-c*f*n-p*s*d+e*f*d+c*s*y-e*l*y)*v;t[10]=(r*f*n-p*o*n+p*s*h-e*f*h-r*s*y+e*o*y)*v;t[11]=(c*o*n-r*l*n-c*s*h+e*l*h+r*s*d-e*o*d)*v;t[12]=w*v;t[13]=(c*f*i-p*l*i+p*s*u-e*f*u-c*s*m+e*l*m)*v;t[14]=(p*o*i-r*f*i-p*s*a+e*f*a+r*s*m-e*o*m)*v;t[15]=(r*l*i-c*o*i+c*s*a-e*l*a-r*s*u+e*o*u)*v;return this}scale(t){const e=this.elements;const s=t.x,i=t.y,n=t.z;e[0]*=s;e[4]*=i;e[8]*=n;e[1]*=s;e[5]*=i;e[9]*=n;e[2]*=s;e[6]*=i;e[10]*=n;e[3]*=s;e[7]*=i;e[11]*=n;return this}getMaxScaleOnAxis(){const t=this.elements;const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];const s=t[4]*t[4]+t[5]*t[5]+t[6]*t[6];const i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,s,i))}makeTranslation(t,e,s){if(t.isVector3){this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1)}else{this.set(1,0,0,t,0,1,0,e,0,0,1,s,0,0,0,1)}return this}makeRotationX(t){const e=Math.cos(t),s=Math.sin(t);this.set(1,0,0,0,0,e,-s,0,0,s,e,0,0,0,0,1);return this}makeRotationY(t){const e=Math.cos(t),s=Math.sin(t);this.set(e,0,s,0,0,1,0,0,-s,0,e,0,0,0,0,1);return this}makeRotationZ(t){const e=Math.cos(t),s=Math.sin(t);this.set(e,-s,0,0,s,e,0,0,0,0,1,0,0,0,0,1);return this}makeRotationAxis(t,e){const s=Math.cos(e);const i=Math.sin(e);const n=1-s;const r=t.x,o=t.y,a=t.z;const h=n*r,c=n*o;this.set(h*r+s,h*o-i*a,h*a+i*o,0,h*o+i*a,c*o+s,c*a-i*r,0,h*a-i*o,c*a+i*r,n*a*a+s,0,0,0,0,1);return this}makeScale(t,e,s){this.set(t,0,0,0,0,e,0,0,0,0,s,0,0,0,0,1);return this}makeShear(t,e,s,i,n,r){this.set(1,s,n,0,t,1,r,0,e,i,1,0,0,0,0,1);return this}compose(t,e,s){const i=this.elements;const n=e._x,r=e._y,o=e._z,a=e._w;const h=n+n,c=r+r,l=o+o;const u=n*h,d=n*c,p=n*l;const f=r*c,m=r*l,y=o*l;const g=a*h,x=a*c,b=a*l;const w=s.x,M=s.y,v=s.z;i[0]=(1-(f+y))*w;i[1]=(d+b)*w;i[2]=(p-x)*w;i[3]=0;i[4]=(d-b)*M;i[5]=(1-(u+y))*M;i[6]=(m+g)*M;i[7]=0;i[8]=(p+x)*v;i[9]=(m-g)*v;i[10]=(1-(u+f))*v;i[11]=0;i[12]=t.x;i[13]=t.y;i[14]=t.z;i[15]=1;return this}decompose(t,e,s){const i=this.elements;let n=iQ.set(i[0],i[1],i[2]).length();const r=iQ.set(i[4],i[5],i[6]).length();const o=iQ.set(i[8],i[9],i[10]).length();const a=this.determinant();if(a<0)n=-n;t.x=i[12];t.y=i[13];t.z=i[14];iK.copy(this);const h=1/n;const c=1/r;const l=1/o;iK.elements[0]*=h;iK.elements[1]*=h;iK.elements[2]*=h;iK.elements[4]*=c;iK.elements[5]*=c;iK.elements[6]*=c;iK.elements[8]*=l;iK.elements[9]*=l;iK.elements[10]*=l;e.setFromRotationMatrix(iK);s.x=n;s.y=r;s.z=o;return this}makePerspective(t,e,s,i,n,r,o=sy){const a=this.elements;const h=2*n/(e-t);const c=2*n/(s-i);const l=(e+t)/(e-t);const u=(s+i)/(s-i);let d,p;if(o===sy){d=-(r+n)/(r-n);p=-2*r*n/(r-n)}else if(o===sg){d=-r/(r-n);p=-r*n/(r-n)}else{throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o)}a[0]=h;a[4]=0;a[8]=l;a[12]=0;a[1]=0;a[5]=c;a[9]=u;a[13]=0;a[2]=0;a[6]=0;a[10]=d;a[14]=p;a[3]=0;a[7]=0;a[11]=-1;a[15]=0;return this}makeOrthographic(t,e,s,i,n,r,o=sy){const a=this.elements;const h=1/(e-t);const c=1/(s-i);const l=1/(r-n);const u=(e+t)*h;const d=(s+i)*c;let p,f;if(o===sy){p=(r+n)*l;f=-2*l}else if(o===sg){p=n*l;f=-1*l}else{throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o)}a[0]=2*h;a[4]=0;a[8]=0;a[12]=-u;a[1]=0;a[5]=2*c;a[9]=0;a[13]=-d;a[2]=0;a[6]=0;a[10]=f;a[14]=-p;a[3]=0;a[7]=0;a[11]=0;a[15]=1;return this}equals(t){const e=this.elements;const s=t.elements;for(let t=0;t<16;t++){if(e[t]!==s[t])return false}return true}fromArray(t,e=0){for(let s=0;s<16;s++){this.elements[s]=t[s+e]}return this}toArray(t=[],e=0){const s=this.elements;t[e]=s[0];t[e+1]=s[1];t[e+2]=s[2];t[e+3]=s[3];t[e+4]=s[4];t[e+5]=s[5];t[e+6]=s[6];t[e+7]=s[7];t[e+8]=s[8];t[e+9]=s[9];t[e+10]=s[10];t[e+11]=s[11];t[e+12]=s[12];t[e+13]=s[13];t[e+14]=s[14];t[e+15]=s[15];return t}}const iQ=new iM;const iK=new i$;const i0=new iM(0,0,0);const i1=new iM(1,1,1);const i2=new iM;const i3=new iM;const i5=new iM;const i4=new i$;const i6=new iw;class i8{constructor(t=0,e=0,s=0,i=i8.DEFAULT_ORDER){this.isEuler=true;this._x=t;this._y=e;this._z=s;this._order=i}get x(){return this._x}set x(t){this._x=t;this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t;this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t;this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t;this._onChangeCallback()}set(t,e,s,i=this._order){this._x=t;this._y=e;this._z=s;this._order=i;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){this._x=t._x;this._y=t._y;this._z=t._z;this._order=t._order;this._onChangeCallback();return this}setFromRotationMatrix(t,e=this._order,s=true){const i=t.elements;const n=i[0],r=i[4],o=i[8];const a=i[1],h=i[5],c=i[9];const l=i[2],u=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(sz(o,-1,1));if(Math.abs(o)<.9999999){this._x=Math.atan2(-c,d);this._z=Math.atan2(-r,n)}else{this._x=Math.atan2(u,h);this._z=0}break;case"YXZ":this._x=Math.asin(-sz(c,-1,1));if(Math.abs(c)<.9999999){this._y=Math.atan2(o,d);this._z=Math.atan2(a,h)}else{this._y=Math.atan2(-l,n);this._z=0}break;case"ZXY":this._x=Math.asin(sz(u,-1,1));if(Math.abs(u)<.9999999){this._y=Math.atan2(-l,d);this._z=Math.atan2(-r,h)}else{this._y=0;this._z=Math.atan2(a,n)}break;case"ZYX":this._y=Math.asin(-sz(l,-1,1));if(Math.abs(l)<.9999999){this._x=Math.atan2(u,d);this._z=Math.atan2(a,n)}else{this._x=0;this._z=Math.atan2(-r,h)}break;case"YZX":this._z=Math.asin(sz(a,-1,1));if(Math.abs(a)<.9999999){this._x=Math.atan2(-c,h);this._y=Math.atan2(-l,n)}else{this._x=0;this._y=Math.atan2(o,d)}break;case"XZY":this._z=Math.asin(-sz(r,-1,1));if(Math.abs(r)<.9999999){this._x=Math.atan2(u,h);this._y=Math.atan2(o,n)}else{this._x=Math.atan2(-c,d);this._y=0}break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}this._order=e;if(s===true)this._onChangeCallback();return this}setFromQuaternion(t,e,s){i4.makeRotationFromQuaternion(t);return this.setFromRotationMatrix(i4,e,s)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){i6.setFromEuler(this);return this.setFromQuaternion(i6,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){this._x=t[0];this._y=t[1];this._z=t[2];if(t[3]!==undefined)this._order=t[3];this._onChangeCallback();return this}toArray(t=[],e=0){t[e]=this._x;t[e+1]=this._y;t[e+2]=this._z;t[e+3]=this._order;return t}_onChange(t){this._onChangeCallback=t;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._order}}i8.DEFAULT_ORDER="XYZ";class i9{constructor(){this.mask=1|0}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=0xffffffff|0}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let i7=0;const nt=new iM;const ne=new iw;const ns=new i$;const ni=new iM;const nn=new iM;const nr=new iM;const no=new iw;const na=new iM(1,0,0);const nh=new iM(0,1,0);const nc=new iM(0,0,1);const nl={type:"added"};const nu={type:"removed"};const nd={type:"childadded",child:null};const np={type:"childremoved",child:null};class nf extends sM{constructor(){super();this.isObject3D=true;Object.defineProperty(this,"id",{value:i7++});this.uuid=sT();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=nf.DEFAULT_UP.clone();const t=new iM;const e=new i8;const s=new iw;const i=new iM(1,1,1);function n(){s.setFromEuler(e,false)}function r(){e.setFromQuaternion(s,undefined,false)}e._onChange(n);s._onChange(r);Object.defineProperties(this,{position:{configurable:true,enumerable:true,value:t},rotation:{configurable:true,enumerable:true,value:e},quaternion:{configurable:true,enumerable:true,value:s},scale:{configurable:true,enumerable:true,value:i},modelViewMatrix:{value:new i$},normalMatrix:{value:new sG}});this.matrix=new i$;this.matrixWorld=new i$;this.matrixAutoUpdate=nf.DEFAULT_MATRIX_AUTO_UPDATE;this.matrixWorldAutoUpdate=nf.DEFAULT_MATRIX_WORLD_AUTO_UPDATE;this.matrixWorldNeedsUpdate=false;this.layers=new i9;this.visible=true;this.castShadow=false;this.receiveShadow=false;this.frustumCulled=true;this.renderOrder=0;this.animations=[];this.customDepthMaterial=undefined;this.customDistanceMaterial=undefined;this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){if(this.matrixAutoUpdate)this.updateMatrix();this.matrix.premultiply(t);this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){this.quaternion.premultiply(t);return this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,true)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){ne.setFromAxisAngle(t,e);this.quaternion.multiply(ne);return this}rotateOnWorldAxis(t,e){ne.setFromAxisAngle(t,e);this.quaternion.premultiply(ne);return this}rotateX(t){return this.rotateOnAxis(na,t)}rotateY(t){return this.rotateOnAxis(nh,t)}rotateZ(t){return this.rotateOnAxis(nc,t)}translateOnAxis(t,e){nt.copy(t).applyQuaternion(this.quaternion);this.position.add(nt.multiplyScalar(e));return this}translateX(t){return this.translateOnAxis(na,t)}translateY(t){return this.translateOnAxis(nh,t)}translateZ(t){return this.translateOnAxis(nc,t)}localToWorld(t){this.updateWorldMatrix(true,false);return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){this.updateWorldMatrix(true,false);return t.applyMatrix4(ns.copy(this.matrixWorld).invert())}lookAt(t,e,s){if(t.isVector3){ni.copy(t)}else{ni.set(t,e,s)}const i=this.parent;this.updateWorldMatrix(true,false);nn.setFromMatrixPosition(this.matrixWorld);if(this.isCamera||this.isLight){ns.lookAt(nn,ni,this.up)}else{ns.lookAt(ni,nn,this.up)}this.quaternion.setFromRotationMatrix(ns);if(i){ns.extractRotation(i.matrixWorld);ne.setFromRotationMatrix(ns);this.quaternion.premultiply(ne.invert())}}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++){this.add(arguments[t])}return this}if(t===this){console.error("THREE.Object3D.add: object can't be added as a child of itself.",t);return this}if(t&&t.isObject3D){t.removeFromParent();t.parent=this;this.children.push(t);t.dispatchEvent(nl);nd.child=t;this.dispatchEvent(nd);nd.child=null}else{console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t)}return this}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++){this.remove(arguments[t])}return this}const e=this.children.indexOf(t);if(e!==-1){t.parent=null;this.children.splice(e,1);t.dispatchEvent(nu);np.child=t;this.dispatchEvent(np);np.child=null}return this}removeFromParent(){const t=this.parent;if(t!==null){t.remove(this)}return this}clear(){return this.remove(...this.children)}attach(t){this.updateWorldMatrix(true,false);ns.copy(this.matrixWorld).invert();if(t.parent!==null){t.parent.updateWorldMatrix(true,false);ns.multiply(t.parent.matrixWorld)}t.applyMatrix4(ns);t.removeFromParent();t.parent=this;this.children.push(t);t.updateWorldMatrix(false,true);t.dispatchEvent(nl);nd.child=t;this.dispatchEvent(nd);nd.child=null;return this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let s=0,i=this.children.length;s<i;s++){const i=this.children[s];const n=i.getObjectByProperty(t,e);if(n!==undefined){return n}}return undefined}getObjectsByProperty(t,e,s=[]){if(this[t]===e)s.push(this);const i=this.children;for(let n=0,r=i.length;n<r;n++){i[n].getObjectsByProperty(t,e,s)}return s}getWorldPosition(t){this.updateWorldMatrix(true,false);return t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){this.updateWorldMatrix(true,false);this.matrixWorld.decompose(nn,t,nr);return t}getWorldScale(t){this.updateWorldMatrix(true,false);this.matrixWorld.decompose(nn,no,t);return t}getWorldDirection(t){this.updateWorldMatrix(true,false);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let s=0,i=e.length;s<i;s++){e[s].traverse(t)}}traverseVisible(t){if(this.visible===false)return;t(this);const e=this.children;for(let s=0,i=e.length;s<i;s++){e[s].traverseVisible(t)}}traverseAncestors(t){const e=this.parent;if(e!==null){t(e);e.traverseAncestors(t)}}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=true}updateMatrixWorld(t){if(this.matrixAutoUpdate)this.updateMatrix();if(this.matrixWorldNeedsUpdate||t){if(this.matrixWorldAutoUpdate===true){if(this.parent===null){this.matrixWorld.copy(this.matrix)}else{this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)}}this.matrixWorldNeedsUpdate=false;t=true}const e=this.children;for(let s=0,i=e.length;s<i;s++){const i=e[s];i.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const s=this.parent;if(t===true&&s!==null){s.updateWorldMatrix(true,false)}if(this.matrixAutoUpdate)this.updateMatrix();if(this.matrixWorldAutoUpdate===true){if(this.parent===null){this.matrixWorld.copy(this.matrix)}else{this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)}}if(e===true){const t=this.children;for(let e=0,s=t.length;e<s;e++){const s=t[e];s.updateWorldMatrix(false,true)}}}toJSON(t){const e=t===undefined||typeof t==="string";const s={};if(e){t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}};s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"}}const i={};i.uuid=this.uuid;i.type=this.type;if(this.name!=="")i.name=this.name;if(this.castShadow===true)i.castShadow=true;if(this.receiveShadow===true)i.receiveShadow=true;if(this.visible===false)i.visible=false;if(this.frustumCulled===false)i.frustumCulled=false;if(this.renderOrder!==0)i.renderOrder=this.renderOrder;if(Object.keys(this.userData).length>0)i.userData=this.userData;i.layers=this.layers.mask;i.matrix=this.matrix.toArray();i.up=this.up.toArray();if(this.matrixAutoUpdate===false)i.matrixAutoUpdate=false;if(this.isInstancedMesh){i.type="InstancedMesh";i.count=this.count;i.instanceMatrix=this.instanceMatrix.toJSON();if(this.instanceColor!==null)i.instanceColor=this.instanceColor.toJSON()}if(this.isBatchedMesh){i.type="BatchedMesh";i.perObjectFrustumCulled=this.perObjectFrustumCulled;i.sortObjects=this.sortObjects;i.drawRanges=this._drawRanges;i.reservedRanges=this._reservedRanges;i.geometryInfo=this._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox?{min:t.boundingBox.min.toArray(),max:t.boundingBox.max.toArray()}:undefined,boundingSphere:t.boundingSphere?{radius:t.boundingSphere.radius,center:t.boundingSphere.center.toArray()}:undefined}));i.instanceInfo=this._instanceInfo.map(t=>({...t}));i.availableInstanceIds=this._availableInstanceIds.slice();i.availableGeometryIds=this._availableGeometryIds.slice();i.nextIndexStart=this._nextIndexStart;i.nextVertexStart=this._nextVertexStart;i.geometryCount=this._geometryCount;i.maxInstanceCount=this._maxInstanceCount;i.maxVertexCount=this._maxVertexCount;i.maxIndexCount=this._maxIndexCount;i.geometryInitialized=this._geometryInitialized;i.matricesTexture=this._matricesTexture.toJSON(t);i.indirectTexture=this._indirectTexture.toJSON(t);if(this._colorsTexture!==null){i.colorsTexture=this._colorsTexture.toJSON(t)}if(this.boundingSphere!==null){i.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}}if(this.boundingBox!==null){i.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}}}function n(e,s){if(e[s.uuid]===undefined){e[s.uuid]=s.toJSON(t)}return s.uuid}if(this.isScene){if(this.background){if(this.background.isColor){i.background=this.background.toJSON()}else if(this.background.isTexture){i.background=this.background.toJSON(t).uuid}}if(this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==true){i.environment=this.environment.toJSON(t).uuid}}else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(t.geometries,this.geometry);const e=this.geometry.parameters;if(e!==undefined&&e.shapes!==undefined){const s=e.shapes;if(Array.isArray(s)){for(let e=0,i=s.length;e<i;e++){const i=s[e];n(t.shapes,i)}}else{n(t.shapes,s)}}}if(this.isSkinnedMesh){i.bindMode=this.bindMode;i.bindMatrix=this.bindMatrix.toArray();if(this.skeleton!==undefined){n(t.skeletons,this.skeleton);i.skeleton=this.skeleton.uuid}}if(this.material!==undefined){if(Array.isArray(this.material)){const e=[];for(let s=0,i=this.material.length;s<i;s++){e.push(n(t.materials,this.material[s]))}i.material=e}else{i.material=n(t.materials,this.material)}}if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++){i.children.push(this.children[e].toJSON(t).object)}}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const s=this.animations[e];i.animations.push(n(t.animations,s))}}if(e){const e=r(t.geometries);const i=r(t.materials);const n=r(t.textures);const o=r(t.images);const a=r(t.shapes);const h=r(t.skeletons);const c=r(t.animations);const l=r(t.nodes);if(e.length>0)s.geometries=e;if(i.length>0)s.materials=i;if(n.length>0)s.textures=n;if(o.length>0)s.images=o;if(a.length>0)s.shapes=a;if(h.length>0)s.skeletons=h;if(c.length>0)s.animations=c;if(l.length>0)s.nodes=l}s.object=i;return s;function r(t){const e=[];for(const s in t){const i=t[s];delete i.metadata;e.push(i)}return e}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=true){this.name=t.name;this.up.copy(t.up);this.position.copy(t.position);this.rotation.order=t.rotation.order;this.quaternion.copy(t.quaternion);this.scale.copy(t.scale);this.matrix.copy(t.matrix);this.matrixWorld.copy(t.matrixWorld);this.matrixAutoUpdate=t.matrixAutoUpdate;this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate;this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate;this.layers.mask=t.layers.mask;this.visible=t.visible;this.castShadow=t.castShadow;this.receiveShadow=t.receiveShadow;this.frustumCulled=t.frustumCulled;this.renderOrder=t.renderOrder;this.animations=t.animations.slice();this.userData=JSON.parse(JSON.stringify(t.userData));if(e===true){for(let e=0;e<t.children.length;e++){const s=t.children[e];this.add(s.clone())}}return this}}nf.DEFAULT_UP=new iM(0,1,0);nf.DEFAULT_MATRIX_AUTO_UPDATE=true;nf.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=true;const nm=new iM;const ny=new iM;const ng=new iM;const nx=new iM;const nb=new iM;const nw=new iM;const nM=new iM;const nv=new iM;const nS=new iM;const n_=new iM;const nA=new id;const nT=new id;const nz=new id;class nI{constructor(t=new iM,e=new iM,s=new iM){this.a=t;this.b=e;this.c=s}static getNormal(t,e,s,i){i.subVectors(s,e);nm.subVectors(t,e);i.cross(nm);const n=i.lengthSq();if(n>0){return i.multiplyScalar(1/Math.sqrt(n))}return i.set(0,0,0)}static getBarycoord(t,e,s,i,n){nm.subVectors(i,e);ny.subVectors(s,e);ng.subVectors(t,e);const r=nm.dot(nm);const o=nm.dot(ny);const a=nm.dot(ng);const h=ny.dot(ny);const c=ny.dot(ng);const l=r*h-o*o;if(l===0){n.set(0,0,0);return null}const u=1/l;const d=(h*a-o*c)*u;const p=(r*c-o*a)*u;return n.set(1-d-p,p,d)}static containsPoint(t,e,s,i){if(this.getBarycoord(t,e,s,i,nx)===null){return false}return nx.x>=0&&nx.y>=0&&nx.x+nx.y<=1}static getInterpolation(t,e,s,i,n,r,o,a){if(this.getBarycoord(t,e,s,i,nx)===null){a.x=0;a.y=0;if("z"in a)a.z=0;if("w"in a)a.w=0;return null}a.setScalar(0);a.addScaledVector(n,nx.x);a.addScaledVector(r,nx.y);a.addScaledVector(o,nx.z);return a}static getInterpolatedAttribute(t,e,s,i,n,r){nA.setScalar(0);nT.setScalar(0);nz.setScalar(0);nA.fromBufferAttribute(t,e);nT.fromBufferAttribute(t,s);nz.fromBufferAttribute(t,i);r.setScalar(0);r.addScaledVector(nA,n.x);r.addScaledVector(nT,n.y);r.addScaledVector(nz,n.z);return r}static isFrontFacing(t,e,s,i){nm.subVectors(s,e);ny.subVectors(t,e);return nm.cross(ny).dot(i)<0?true:false}set(t,e,s){this.a.copy(t);this.b.copy(e);this.c.copy(s);return this}setFromPointsAndIndices(t,e,s,i){this.a.copy(t[e]);this.b.copy(t[s]);this.c.copy(t[i]);return this}setFromAttributeAndIndices(t,e,s,i){this.a.fromBufferAttribute(t,e);this.b.fromBufferAttribute(t,s);this.c.fromBufferAttribute(t,i);return this}clone(){return new this.constructor().copy(this)}copy(t){this.a.copy(t.a);this.b.copy(t.b);this.c.copy(t.c);return this}getArea(){nm.subVectors(this.c,this.b);ny.subVectors(this.a,this.b);return nm.cross(ny).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return nI.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return nI.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,s,i,n){return nI.getInterpolation(t,this.a,this.b,this.c,e,s,i,n)}containsPoint(t){return nI.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return nI.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const s=this.a,i=this.b,n=this.c;let r,o;nb.subVectors(i,s);nw.subVectors(n,s);nv.subVectors(t,s);const a=nb.dot(nv);const h=nw.dot(nv);if(a<=0&&h<=0){return e.copy(s)}nS.subVectors(t,i);const c=nb.dot(nS);const l=nw.dot(nS);if(c>=0&&l<=c){return e.copy(i)}const u=a*l-c*h;if(u<=0&&a>=0&&c<=0){r=a/(a-c);return e.copy(s).addScaledVector(nb,r)}n_.subVectors(t,n);const d=nb.dot(n_);const p=nw.dot(n_);if(p>=0&&d<=p){return e.copy(n)}const f=d*h-a*p;if(f<=0&&h>=0&&p<=0){o=h/(h-p);return e.copy(s).addScaledVector(nw,o)}const m=c*p-d*l;if(m<=0&&l-c>=0&&d-p>=0){nM.subVectors(n,i);o=(l-c)/(l-c+(d-p));return e.copy(i).addScaledVector(nM,o)}const y=1/(m+f+u);r=f*y;o=u*y;return e.copy(s).addScaledVector(nb,r).addScaledVector(nw,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const nC={"aliceblue":0xf0f8ff,"antiquewhite":0xfaebd7,"aqua":65535,"aquamarine":8388564,"azure":0xf0ffff,"beige":0xf5f5dc,"bisque":0xffe4c4,"black":0,"blanchedalmond":0xffebcd,"blue":255,"blueviolet":9055202,"brown":0xa52a2a,"burlywood":0xdeb887,"cadetblue":6266528,"chartreuse":8388352,"chocolate":0xd2691e,"coral":0xff7f50,"cornflowerblue":6591981,"cornsilk":0xfff8dc,"crimson":0xdc143c,"cyan":65535,"darkblue":139,"darkcyan":35723,"darkgoldenrod":0xb8860b,"darkgray":0xa9a9a9,"darkgreen":25600,"darkgrey":0xa9a9a9,"darkkhaki":0xbdb76b,"darkmagenta":9109643,"darkolivegreen":5597999,"darkorange":0xff8c00,"darkorchid":0x9932cc,"darkred":9109504,"darksalmon":0xe9967a,"darkseagreen":9419919,"darkslateblue":4734347,"darkslategray":3100495,"darkslategrey":3100495,"darkturquoise":52945,"darkviolet":9699539,"deeppink":0xff1493,"deepskyblue":49151,"dimgray":6908265,"dimgrey":6908265,"dodgerblue":2003199,"firebrick":0xb22222,"floralwhite":0xfffaf0,"forestgreen":2263842,"fuchsia":0xff00ff,"gainsboro":0xdcdcdc,"ghostwhite":0xf8f8ff,"gold":0xffd700,"goldenrod":0xdaa520,"gray":8421504,"green":32768,"greenyellow":0xadff2f,"grey":8421504,"honeydew":0xf0fff0,"hotpink":0xff69b4,"indianred":0xcd5c5c,"indigo":4915330,"ivory":0xfffff0,"khaki":0xf0e68c,"lavender":0xe6e6fa,"lavenderblush":0xfff0f5,"lawngreen":8190976,"lemonchiffon":0xfffacd,"lightblue":0xadd8e6,"lightcoral":0xf08080,"lightcyan":0xe0ffff,"lightgoldenrodyellow":0xfafad2,"lightgray":0xd3d3d3,"lightgreen":9498256,"lightgrey":0xd3d3d3,"lightpink":0xffb6c1,"lightsalmon":0xffa07a,"lightseagreen":2142890,"lightskyblue":8900346,"lightslategray":7833753,"lightslategrey":7833753,"lightsteelblue":0xb0c4de,"lightyellow":0xffffe0,"lime":65280,"limegreen":3329330,"linen":0xfaf0e6,"magenta":0xff00ff,"maroon":8388608,"mediumaquamarine":6737322,"mediumblue":205,"mediumorchid":0xba55d3,"mediumpurple":9662683,"mediumseagreen":3978097,"mediumslateblue":8087790,"mediumspringgreen":64154,"mediumturquoise":4772300,"mediumvioletred":0xc71585,"midnightblue":1644912,"mintcream":0xf5fffa,"mistyrose":0xffe4e1,"moccasin":0xffe4b5,"navajowhite":0xffdead,"navy":128,"oldlace":0xfdf5e6,"olive":8421376,"olivedrab":7048739,"orange":0xffa500,"orangered":0xff4500,"orchid":0xda70d6,"palegoldenrod":0xeee8aa,"palegreen":0x98fb98,"paleturquoise":0xafeeee,"palevioletred":0xdb7093,"papayawhip":0xffefd5,"peachpuff":0xffdab9,"peru":0xcd853f,"pink":0xffc0cb,"plum":0xdda0dd,"powderblue":0xb0e0e6,"purple":8388736,"rebeccapurple":6697881,"red":0xff0000,"rosybrown":0xbc8f8f,"royalblue":4286945,"saddlebrown":9127187,"salmon":0xfa8072,"sandybrown":0xf4a460,"seagreen":3050327,"seashell":0xfff5ee,"sienna":0xa0522d,"silver":0xc0c0c0,"skyblue":8900331,"slateblue":6970061,"slategray":7372944,"slategrey":7372944,"snow":0xfffafa,"springgreen":65407,"steelblue":4620980,"tan":0xd2b48c,"teal":32896,"thistle":0xd8bfd8,"tomato":0xff6347,"turquoise":4251856,"violet":0xee82ee,"wheat":0xf5deb3,"white":0xffffff,"whitesmoke":0xf5f5f5,"yellow":0xffff00,"yellowgreen":0x9acd32};const nB={h:0,s:0,l:0};const nk={h:0,s:0,l:0};function nR(t,e,s){if(s<0)s+=1;if(s>1)s-=1;if(s<1/6)return t+(e-t)*6*s;if(s<1/2)return e;if(s<2/3)return t+(e-t)*6*(2/3-s);return t}class nE{constructor(t,e,s){this.isColor=true;this.r=1;this.g=1;this.b=1;return this.set(t,e,s)}set(t,e,s){if(e===undefined&&s===undefined){const e=t;if(e&&e.isColor){this.copy(e)}else if(typeof e==="number"){this.setHex(e)}else if(typeof e==="string"){this.setStyle(e)}}else{this.setRGB(t,e,s)}return this}setScalar(t){this.r=t;this.g=t;this.b=t;return this}setHex(t,e=eW){t=Math.floor(t);this.r=(t>>16&255)/255;this.g=(t>>8&255)/255;this.b=(t&255)/255;ie.toWorkingColorSpace(this,e);return this}setRGB(t,e,s,i=ie.workingColorSpace){this.r=t;this.g=e;this.b=s;ie.toWorkingColorSpace(this,i);return this}setHSL(t,e,s,i=ie.workingColorSpace){t=sI(t,1);e=sz(e,0,1);s=sz(s,0,1);if(e===0){this.r=this.g=this.b=s}else{const i=s<=.5?s*(1+e):s+e-s*e;const n=2*s-i;this.r=nR(n,i,t+1/3);this.g=nR(n,i,t);this.b=nR(n,i,t-1/3)}ie.toWorkingColorSpace(this,i);return this}setStyle(t,e=eW){function s(e){if(e===undefined)return;if(parseFloat(e)<1){console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let n;const r=i[1];const o=i[2];switch(r){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){s(n[4]);return this.setRGB(Math.min(255,parseInt(n[1],10))/255,Math.min(255,parseInt(n[2],10))/255,Math.min(255,parseInt(n[3],10))/255,e)}if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){s(n[4]);return this.setRGB(Math.min(100,parseInt(n[1],10))/100,Math.min(100,parseInt(n[2],10))/100,Math.min(100,parseInt(n[3],10))/100,e)}break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){s(n[4]);return this.setHSL(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,e)}break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=i[1];const n=s.length;if(n===3){return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,e)}else if(n===6){return this.setHex(parseInt(s,16),e)}else{console.warn("THREE.Color: Invalid hex color "+t)}}else if(t&&t.length>0){return this.setColorName(t,e)}return this}setColorName(t,e=eW){const s=nC[t.toLowerCase()];if(s!==undefined){this.setHex(s,e)}else{console.warn("THREE.Color: Unknown color "+t)}return this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){this.r=t.r;this.g=t.g;this.b=t.b;return this}copySRGBToLinear(t){this.r=is(t.r);this.g=is(t.g);this.b=is(t.b);return this}copyLinearToSRGB(t){this.r=ii(t.r);this.g=ii(t.g);this.b=ii(t.b);return this}convertSRGBToLinear(){this.copySRGBToLinear(this);return this}convertLinearToSRGB(){this.copyLinearToSRGB(this);return this}getHex(t=eW){ie.fromWorkingColorSpace(nP.copy(this),t);return Math.round(sz(nP.r*255,0,255))*65536+Math.round(sz(nP.g*255,0,255))*256+Math.round(sz(nP.b*255,0,255))}getHexString(t=eW){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=ie.workingColorSpace){ie.fromWorkingColorSpace(nP.copy(this),e);const s=nP.r,i=nP.g,n=nP.b;const r=Math.max(s,i,n);const o=Math.min(s,i,n);let a,h;const c=(o+r)/2;if(o===r){a=0;h=0}else{const t=r-o;h=c<=.5?t/(r+o):t/(2-r-o);switch(r){case s:a=(i-n)/t+(i<n?6:0);break;case i:a=(n-s)/t+2;break;case n:a=(s-i)/t+4;break}a/=6}t.h=a;t.s=h;t.l=c;return t}getRGB(t,e=ie.workingColorSpace){ie.fromWorkingColorSpace(nP.copy(this),e);t.r=nP.r;t.g=nP.g;t.b=nP.b;return t}getStyle(t=eW){ie.fromWorkingColorSpace(nP.copy(this),t);const e=nP.r,s=nP.g,i=nP.b;if(t!==eW){return`color(${t} ${e.toFixed(3)} ${s.toFixed(3)} ${i.toFixed(3)})`}return`rgb(${Math.round(e*255)},${Math.round(s*255)},${Math.round(i*255)})`}offsetHSL(t,e,s){this.getHSL(nB);return this.setHSL(nB.h+t,nB.s+e,nB.l+s)}add(t){this.r+=t.r;this.g+=t.g;this.b+=t.b;return this}addColors(t,e){this.r=t.r+e.r;this.g=t.g+e.g;this.b=t.b+e.b;return this}addScalar(t){this.r+=t;this.g+=t;this.b+=t;return this}sub(t){this.r=Math.max(0,this.r-t.r);this.g=Math.max(0,this.g-t.g);this.b=Math.max(0,this.b-t.b);return this}multiply(t){this.r*=t.r;this.g*=t.g;this.b*=t.b;return this}multiplyScalar(t){this.r*=t;this.g*=t;this.b*=t;return this}lerp(t,e){this.r+=(t.r-this.r)*e;this.g+=(t.g-this.g)*e;this.b+=(t.b-this.b)*e;return this}lerpColors(t,e,s){this.r=t.r+(e.r-t.r)*s;this.g=t.g+(e.g-t.g)*s;this.b=t.b+(e.b-t.b)*s;return this}lerpHSL(t,e){this.getHSL(nB);t.getHSL(nk);const s=sk(nB.h,nk.h,e);const i=sk(nB.s,nk.s,e);const n=sk(nB.l,nk.l,e);this.setHSL(s,i,n);return this}setFromVector3(t){this.r=t.x;this.g=t.y;this.b=t.z;return this}applyMatrix3(t){const e=this.r,s=this.g,i=this.b;const n=t.elements;this.r=n[0]*e+n[3]*s+n[6]*i;this.g=n[1]*e+n[4]*s+n[7]*i;this.b=n[2]*e+n[5]*s+n[8]*i;return this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){this.r=t[e];this.g=t[e+1];this.b=t[e+2];return this}toArray(t=[],e=0){t[e]=this.r;t[e+1]=this.g;t[e+2]=this.b;return t}fromBufferAttribute(t,e){this.r=t.getX(e);this.g=t.getY(e);this.b=t.getZ(e);return this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r;yield this.g;yield this.b}}const nP=new nE;nE.NAMES=nC;let nO=0;class nF extends sM{constructor(){super();this.isMaterial=true;Object.defineProperty(this,"id",{value:nO++});this.uuid=sT();this.name="";this.type="Material";this.blending=x;this.side=f;this.vertexColors=false;this.opacity=1;this.transparent=false;this.alphaHash=false;this.blendSrc=R;this.blendDst=E;this.blendEquation=S;this.blendSrcAlpha=null;this.blendDstAlpha=null;this.blendEquationAlpha=null;this.blendColor=new nE(0,0,0);this.blendAlpha=0;this.depthFunc=J;this.depthTest=true;this.depthWrite=true;this.stencilWriteMask=255;this.stencilFunc=e6;this.stencilRef=0;this.stencilFuncMask=255;this.stencilFail=eJ;this.stencilZFail=eJ;this.stencilZPass=eJ;this.stencilWrite=false;this.clippingPlanes=null;this.clipIntersection=false;this.clipShadows=false;this.shadowSide=null;this.colorWrite=true;this.precision=null;this.polygonOffset=false;this.polygonOffsetFactor=0;this.polygonOffsetUnits=0;this.dithering=false;this.alphaToCoverage=false;this.premultipliedAlpha=false;this.forceSinglePass=false;this.allowOverride=true;this.visible=true;this.toneMapped=true;this.userData={};this.version=0;this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){if(this._alphaTest>0!==t>0){this.version++}this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t===undefined)return;for(const e in t){const s=t[e];if(s===undefined){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const i=this[e];if(i===undefined){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}if(i&&i.isColor){i.set(s)}else if(i&&i.isVector3&&s&&s.isVector3){i.copy(s)}else{this[e]=s}}}toJSON(t){const e=t===undefined||typeof t==="string";if(e){t={textures:{},images:{}}}const s={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};s.uuid=this.uuid;s.type=this.type;if(this.name!=="")s.name=this.name;if(this.color&&this.color.isColor)s.color=this.color.getHex();if(this.roughness!==undefined)s.roughness=this.roughness;if(this.metalness!==undefined)s.metalness=this.metalness;if(this.sheen!==undefined)s.sheen=this.sheen;if(this.sheenColor&&this.sheenColor.isColor)s.sheenColor=this.sheenColor.getHex();if(this.sheenRoughness!==undefined)s.sheenRoughness=this.sheenRoughness;if(this.emissive&&this.emissive.isColor)s.emissive=this.emissive.getHex();if(this.emissiveIntensity!==undefined&&this.emissiveIntensity!==1)s.emissiveIntensity=this.emissiveIntensity;if(this.specular&&this.specular.isColor)s.specular=this.specular.getHex();if(this.specularIntensity!==undefined)s.specularIntensity=this.specularIntensity;if(this.specularColor&&this.specularColor.isColor)s.specularColor=this.specularColor.getHex();if(this.shininess!==undefined)s.shininess=this.shininess;if(this.clearcoat!==undefined)s.clearcoat=this.clearcoat;if(this.clearcoatRoughness!==undefined)s.clearcoatRoughness=this.clearcoatRoughness;if(this.clearcoatMap&&this.clearcoatMap.isTexture){s.clearcoatMap=this.clearcoatMap.toJSON(t).uuid}if(this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture){s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid}if(this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture){s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid;s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()}if(this.dispersion!==undefined)s.dispersion=this.dispersion;if(this.iridescence!==undefined)s.iridescence=this.iridescence;if(this.iridescenceIOR!==undefined)s.iridescenceIOR=this.iridescenceIOR;if(this.iridescenceThicknessRange!==undefined)s.iridescenceThicknessRange=this.iridescenceThicknessRange;if(this.iridescenceMap&&this.iridescenceMap.isTexture){s.iridescenceMap=this.iridescenceMap.toJSON(t).uuid}if(this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture){s.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid}if(this.anisotropy!==undefined)s.anisotropy=this.anisotropy;if(this.anisotropyRotation!==undefined)s.anisotropyRotation=this.anisotropyRotation;if(this.anisotropyMap&&this.anisotropyMap.isTexture){s.anisotropyMap=this.anisotropyMap.toJSON(t).uuid}if(this.map&&this.map.isTexture)s.map=this.map.toJSON(t).uuid;if(this.matcap&&this.matcap.isTexture)s.matcap=this.matcap.toJSON(t).uuid;if(this.alphaMap&&this.alphaMap.isTexture)s.alphaMap=this.alphaMap.toJSON(t).uuid;if(this.lightMap&&this.lightMap.isTexture){s.lightMap=this.lightMap.toJSON(t).uuid;s.lightMapIntensity=this.lightMapIntensity}if(this.aoMap&&this.aoMap.isTexture){s.aoMap=this.aoMap.toJSON(t).uuid;s.aoMapIntensity=this.aoMapIntensity}if(this.bumpMap&&this.bumpMap.isTexture){s.bumpMap=this.bumpMap.toJSON(t).uuid;s.bumpScale=this.bumpScale}if(this.normalMap&&this.normalMap.isTexture){s.normalMap=this.normalMap.toJSON(t).uuid;s.normalMapType=this.normalMapType;s.normalScale=this.normalScale.toArray()}if(this.displacementMap&&this.displacementMap.isTexture){s.displacementMap=this.displacementMap.toJSON(t).uuid;s.displacementScale=this.displacementScale;s.displacementBias=this.displacementBias}if(this.roughnessMap&&this.roughnessMap.isTexture)s.roughnessMap=this.roughnessMap.toJSON(t).uuid;if(this.metalnessMap&&this.metalnessMap.isTexture)s.metalnessMap=this.metalnessMap.toJSON(t).uuid;if(this.emissiveMap&&this.emissiveMap.isTexture)s.emissiveMap=this.emissiveMap.toJSON(t).uuid;if(this.specularMap&&this.specularMap.isTexture)s.specularMap=this.specularMap.toJSON(t).uuid;if(this.specularIntensityMap&&this.specularIntensityMap.isTexture)s.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid;if(this.specularColorMap&&this.specularColorMap.isTexture)s.specularColorMap=this.specularColorMap.toJSON(t).uuid;if(this.envMap&&this.envMap.isTexture){s.envMap=this.envMap.toJSON(t).uuid;if(this.combine!==undefined)s.combine=this.combine}if(this.envMapRotation!==undefined)s.envMapRotation=this.envMapRotation.toArray();if(this.envMapIntensity!==undefined)s.envMapIntensity=this.envMapIntensity;if(this.reflectivity!==undefined)s.reflectivity=this.reflectivity;if(this.refractionRatio!==undefined)s.refractionRatio=this.refractionRatio;if(this.gradientMap&&this.gradientMap.isTexture){s.gradientMap=this.gradientMap.toJSON(t).uuid}if(this.transmission!==undefined)s.transmission=this.transmission;if(this.transmissionMap&&this.transmissionMap.isTexture)s.transmissionMap=this.transmissionMap.toJSON(t).uuid;if(this.thickness!==undefined)s.thickness=this.thickness;if(this.thicknessMap&&this.thicknessMap.isTexture)s.thicknessMap=this.thicknessMap.toJSON(t).uuid;if(this.attenuationDistance!==undefined&&this.attenuationDistance!==Infinity)s.attenuationDistance=this.attenuationDistance;if(this.attenuationColor!==undefined)s.attenuationColor=this.attenuationColor.getHex();if(this.size!==undefined)s.size=this.size;if(this.shadowSide!==null)s.shadowSide=this.shadowSide;if(this.sizeAttenuation!==undefined)s.sizeAttenuation=this.sizeAttenuation;if(this.blending!==x)s.blending=this.blending;if(this.side!==f)s.side=this.side;if(this.vertexColors===true)s.vertexColors=true;if(this.opacity<1)s.opacity=this.opacity;if(this.transparent===true)s.transparent=true;if(this.blendSrc!==R)s.blendSrc=this.blendSrc;if(this.blendDst!==E)s.blendDst=this.blendDst;if(this.blendEquation!==S)s.blendEquation=this.blendEquation;if(this.blendSrcAlpha!==null)s.blendSrcAlpha=this.blendSrcAlpha;if(this.blendDstAlpha!==null)s.blendDstAlpha=this.blendDstAlpha;if(this.blendEquationAlpha!==null)s.blendEquationAlpha=this.blendEquationAlpha;if(this.blendColor&&this.blendColor.isColor)s.blendColor=this.blendColor.getHex();if(this.blendAlpha!==0)s.blendAlpha=this.blendAlpha;if(this.depthFunc!==J)s.depthFunc=this.depthFunc;if(this.depthTest===false)s.depthTest=this.depthTest;if(this.depthWrite===false)s.depthWrite=this.depthWrite;if(this.colorWrite===false)s.colorWrite=this.colorWrite;if(this.stencilWriteMask!==255)s.stencilWriteMask=this.stencilWriteMask;if(this.stencilFunc!==e6)s.stencilFunc=this.stencilFunc;if(this.stencilRef!==0)s.stencilRef=this.stencilRef;if(this.stencilFuncMask!==255)s.stencilFuncMask=this.stencilFuncMask;if(this.stencilFail!==eJ)s.stencilFail=this.stencilFail;if(this.stencilZFail!==eJ)s.stencilZFail=this.stencilZFail;if(this.stencilZPass!==eJ)s.stencilZPass=this.stencilZPass;if(this.stencilWrite===true)s.stencilWrite=this.stencilWrite;if(this.rotation!==undefined&&this.rotation!==0)s.rotation=this.rotation;if(this.polygonOffset===true)s.polygonOffset=true;if(this.polygonOffsetFactor!==0)s.polygonOffsetFactor=this.polygonOffsetFactor;if(this.polygonOffsetUnits!==0)s.polygonOffsetUnits=this.polygonOffsetUnits;if(this.linewidth!==undefined&&this.linewidth!==1)s.linewidth=this.linewidth;if(this.dashSize!==undefined)s.dashSize=this.dashSize;if(this.gapSize!==undefined)s.gapSize=this.gapSize;if(this.scale!==undefined)s.scale=this.scale;if(this.dithering===true)s.dithering=true;if(this.alphaTest>0)s.alphaTest=this.alphaTest;if(this.alphaHash===true)s.alphaHash=true;if(this.alphaToCoverage===true)s.alphaToCoverage=true;if(this.premultipliedAlpha===true)s.premultipliedAlpha=true;if(this.forceSinglePass===true)s.forceSinglePass=true;if(this.wireframe===true)s.wireframe=true;if(this.wireframeLinewidth>1)s.wireframeLinewidth=this.wireframeLinewidth;if(this.wireframeLinecap!=="round")s.wireframeLinecap=this.wireframeLinecap;if(this.wireframeLinejoin!=="round")s.wireframeLinejoin=this.wireframeLinejoin;if(this.flatShading===true)s.flatShading=true;if(this.visible===false)s.visible=false;if(this.toneMapped===false)s.toneMapped=false;if(this.fog===false)s.fog=false;if(Object.keys(this.userData).length>0)s.userData=this.userData;function i(t){const e=[];for(const s in t){const i=t[s];delete i.metadata;e.push(i)}return e}if(e){const e=i(t.textures);const n=i(t.images);if(e.length>0)s.textures=e;if(n.length>0)s.images=n}return s}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name;this.blending=t.blending;this.side=t.side;this.vertexColors=t.vertexColors;this.opacity=t.opacity;this.transparent=t.transparent;this.blendSrc=t.blendSrc;this.blendDst=t.blendDst;this.blendEquation=t.blendEquation;this.blendSrcAlpha=t.blendSrcAlpha;this.blendDstAlpha=t.blendDstAlpha;this.blendEquationAlpha=t.blendEquationAlpha;this.blendColor.copy(t.blendColor);this.blendAlpha=t.blendAlpha;this.depthFunc=t.depthFunc;this.depthTest=t.depthTest;this.depthWrite=t.depthWrite;this.stencilWriteMask=t.stencilWriteMask;this.stencilFunc=t.stencilFunc;this.stencilRef=t.stencilRef;this.stencilFuncMask=t.stencilFuncMask;this.stencilFail=t.stencilFail;this.stencilZFail=t.stencilZFail;this.stencilZPass=t.stencilZPass;this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let s=null;if(e!==null){const t=e.length;s=new Array(t);for(let i=0;i!==t;++i){s[i]=e[i].clone()}}this.clippingPlanes=s;this.clipIntersection=t.clipIntersection;this.clipShadows=t.clipShadows;this.shadowSide=t.shadowSide;this.colorWrite=t.colorWrite;this.precision=t.precision;this.polygonOffset=t.polygonOffset;this.polygonOffsetFactor=t.polygonOffsetFactor;this.polygonOffsetUnits=t.polygonOffsetUnits;this.dithering=t.dithering;this.alphaTest=t.alphaTest;this.alphaHash=t.alphaHash;this.alphaToCoverage=t.alphaToCoverage;this.premultipliedAlpha=t.premultipliedAlpha;this.forceSinglePass=t.forceSinglePass;this.visible=t.visible;this.toneMapped=t.toneMapped;this.userData=JSON.parse(JSON.stringify(t.userData));return this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){if(t===true)this.version++}}class nN extends nF{constructor(t){super();this.isMeshBasicMaterial=true;this.type="MeshBasicMaterial";this.color=new nE(0xffffff);this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.envMapRotation=new i8;this.combine=$;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.color.copy(t.color);this.map=t.map;this.lightMap=t.lightMap;this.lightMapIntensity=t.lightMapIntensity;this.aoMap=t.aoMap;this.aoMapIntensity=t.aoMapIntensity;this.specularMap=t.specularMap;this.alphaMap=t.alphaMap;this.envMap=t.envMap;this.envMapRotation.copy(t.envMapRotation);this.combine=t.combine;this.reflectivity=t.reflectivity;this.refractionRatio=t.refractionRatio;this.wireframe=t.wireframe;this.wireframeLinewidth=t.wireframeLinewidth;this.wireframeLinecap=t.wireframeLinecap;this.wireframeLinejoin=t.wireframeLinejoin;this.fog=t.fog;return this}}const nV=nL();function nL(){const t=new ArrayBuffer(4);const e=new Float32Array(t);const s=new Uint32Array(t);const i=new Uint32Array(512);const n=new Uint32Array(512);for(let t=0;t<256;++t){const e=t-127;if(e<-27){i[t]=0;i[t|256]=32768;n[t]=24;n[t|256]=24}else if(e<-14){i[t]=1024>>-e-14;i[t|256]=1024>>-e-14|32768;n[t]=-e-1;n[t|256]=-e-1}else if(e<=15){i[t]=e+15<<10;i[t|256]=e+15<<10|32768;n[t]=13;n[t|256]=13}else if(e<128){i[t]=31744;i[t|256]=64512;n[t]=24;n[t|256]=24}else{i[t]=31744;i[t|256]=64512;n[t]=13;n[t|256]=13}}const r=new Uint32Array(2048);const o=new Uint32Array(64);const a=new Uint32Array(64);for(let t=1;t<1024;++t){let e=t<<13;let s=0;while((e&8388608)===0){e<<=1;s-=8388608}e&=-8388609;s+=0x38800000;r[t]=e|s}for(let t=1024;t<2048;++t){r[t]=0x38000000+(t-1024<<13)}for(let t=1;t<31;++t){o[t]=t<<23}o[31]=0x47800000;o[32]=0x80000000;for(let t=33;t<63;++t){o[t]=0x80000000+(t-32<<23)}o[63]=0xc7800000;for(let t=1;t<64;++t){if(t!==32){a[t]=1024}}return{floatView:e,uint32View:s,baseTable:i,shiftTable:n,mantissaTable:r,exponentTable:o,offsetTable:a}}function nj(t){if(Math.abs(t)>65504)console.warn("THREE.DataUtils.toHalfFloat(): Value out of range.");t=sz(t,-65504,65504);nV.floatView[0]=t;const e=nV.uint32View[0];const s=e>>23&511;return nV.baseTable[s]+((e&8388607)>>nV.shiftTable[s])}function nW(t){const e=t>>10;nV.uint32View[0]=nV.mantissaTable[nV.offsetTable[e]+(t&1023)]+nV.exponentTable[e];return nV.floatView[0]}class nU{static toHalfFloat(t){return nj(t)}static fromHalfFloat(t){return nW(t)}}const nD=new iM;const nH=new sZ;let nq=0;class nJ{constructor(t,e,s=false){if(Array.isArray(t)){throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.")}this.isBufferAttribute=true;Object.defineProperty(this,"id",{value:nq++});this.name="";this.array=t;this.itemSize=e;this.count=t!==undefined?t.length/e:0;this.normalized=s;this.usage=sr;this.updateRanges=[];this.gpuType=tO;this.version=0}onUploadCallback(){}set needsUpdate(t){if(t===true)this.version++}setUsage(t){this.usage=t;return this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){this.name=t.name;this.array=new t.array.constructor(t.array);this.itemSize=t.itemSize;this.count=t.count;this.normalized=t.normalized;this.usage=t.usage;this.gpuType=t.gpuType;return this}copyAt(t,e,s){t*=this.itemSize;s*=e.itemSize;for(let i=0,n=this.itemSize;i<n;i++){this.array[t+i]=e.array[s+i]}return this}copyArray(t){this.array.set(t);return this}applyMatrix3(t){if(this.itemSize===2){for(let e=0,s=this.count;e<s;e++){nH.fromBufferAttribute(this,e);nH.applyMatrix3(t);this.setXY(e,nH.x,nH.y)}}else if(this.itemSize===3){for(let e=0,s=this.count;e<s;e++){nD.fromBufferAttribute(this,e);nD.applyMatrix3(t);this.setXYZ(e,nD.x,nD.y,nD.z)}}return this}applyMatrix4(t){for(let e=0,s=this.count;e<s;e++){nD.fromBufferAttribute(this,e);nD.applyMatrix4(t);this.setXYZ(e,nD.x,nD.y,nD.z)}return this}applyNormalMatrix(t){for(let e=0,s=this.count;e<s;e++){nD.fromBufferAttribute(this,e);nD.applyNormalMatrix(t);this.setXYZ(e,nD.x,nD.y,nD.z)}return this}transformDirection(t){for(let e=0,s=this.count;e<s;e++){nD.fromBufferAttribute(this,e);nD.transformDirection(t);this.setXYZ(e,nD.x,nD.y,nD.z)}return this}set(t,e=0){this.array.set(t,e);return this}getComponent(t,e){let s=this.array[t*this.itemSize+e];if(this.normalized)s=sJ(s,this.array);return s}setComponent(t,e,s){if(this.normalized)s=sX(s,this.array);this.array[t*this.itemSize+e]=s;return this}getX(t){let e=this.array[t*this.itemSize];if(this.normalized)e=sJ(e,this.array);return e}setX(t,e){if(this.normalized)e=sX(e,this.array);this.array[t*this.itemSize]=e;return this}getY(t){let e=this.array[t*this.itemSize+1];if(this.normalized)e=sJ(e,this.array);return e}setY(t,e){if(this.normalized)e=sX(e,this.array);this.array[t*this.itemSize+1]=e;return this}getZ(t){let e=this.array[t*this.itemSize+2];if(this.normalized)e=sJ(e,this.array);return e}setZ(t,e){if(this.normalized)e=sX(e,this.array);this.array[t*this.itemSize+2]=e;return this}getW(t){let e=this.array[t*this.itemSize+3];if(this.normalized)e=sJ(e,this.array);return e}setW(t,e){if(this.normalized)e=sX(e,this.array);this.array[t*this.itemSize+3]=e;return this}setXY(t,e,s){t*=this.itemSize;if(this.normalized){e=sX(e,this.array);s=sX(s,this.array)}this.array[t+0]=e;this.array[t+1]=s;return this}setXYZ(t,e,s,i){t*=this.itemSize;if(this.normalized){e=sX(e,this.array);s=sX(s,this.array);i=sX(i,this.array)}this.array[t+0]=e;this.array[t+1]=s;this.array[t+2]=i;return this}setXYZW(t,e,s,i,n){t*=this.itemSize;if(this.normalized){e=sX(e,this.array);s=sX(s,this.array);i=sX(i,this.array);n=sX(n,this.array)}this.array[t+0]=e;this.array[t+1]=s;this.array[t+2]=i;this.array[t+3]=n;return this}onUpload(t){this.onUploadCallback=t;return this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};if(this.name!=="")t.name=this.name;if(this.usage!==sr)t.usage=this.usage;return t}}class nX extends nJ{constructor(t,e,s){super(new Int8Array(t),e,s)}}class nY extends nJ{constructor(t,e,s){super(new Uint8Array(t),e,s)}}class nZ extends nJ{constructor(t,e,s){super(new Uint8ClampedArray(t),e,s)}}class nG extends nJ{constructor(t,e,s){super(new Int16Array(t),e,s)}}class n$ extends nJ{constructor(t,e,s){super(new Uint16Array(t),e,s)}}class nQ extends nJ{constructor(t,e,s){super(new Int32Array(t),e,s)}}class nK extends nJ{constructor(t,e,s){super(new Uint32Array(t),e,s)}}class n0 extends nJ{constructor(t,e,s){super(new Uint16Array(t),e,s);this.isFloat16BufferAttribute=true}getX(t){let e=nW(this.array[t*this.itemSize]);if(this.normalized)e=sJ(e,this.array);return e}setX(t,e){if(this.normalized)e=sX(e,this.array);this.array[t*this.itemSize]=nj(e);return this}getY(t){let e=nW(this.array[t*this.itemSize+1]);if(this.normalized)e=sJ(e,this.array);return e}setY(t,e){if(this.normalized)e=sX(e,this.array);this.array[t*this.itemSize+1]=nj(e);return this}getZ(t){let e=nW(this.array[t*this.itemSize+2]);if(this.normalized)e=sJ(e,this.array);return e}setZ(t,e){if(this.normalized)e=sX(e,this.array);this.array[t*this.itemSize+2]=nj(e);return this}getW(t){let e=nW(this.array[t*this.itemSize+3]);if(this.normalized)e=sJ(e,this.array);return e}setW(t,e){if(this.normalized)e=sX(e,this.array);this.array[t*this.itemSize+3]=nj(e);return this}setXY(t,e,s){t*=this.itemSize;if(this.normalized){e=sX(e,this.array);s=sX(s,this.array)}this.array[t+0]=nj(e);this.array[t+1]=nj(s);return this}setXYZ(t,e,s,i){t*=this.itemSize;if(this.normalized){e=sX(e,this.array);s=sX(s,this.array);i=sX(i,this.array)}this.array[t+0]=nj(e);this.array[t+1]=nj(s);this.array[t+2]=nj(i);return this}setXYZW(t,e,s,i,n){t*=this.itemSize;if(this.normalized){e=sX(e,this.array);s=sX(s,this.array);i=sX(i,this.array);n=sX(n,this.array)}this.array[t+0]=nj(e);this.array[t+1]=nj(s);this.array[t+2]=nj(i);this.array[t+3]=nj(n);return this}}class n1 extends nJ{constructor(t,e,s){super(new Float32Array(t),e,s)}}let n2=0;const n3=new i$;const n5=new nf;const n4=new iM;const n6=new i_;const n8=new i_;const n9=new iM;class n7 extends sM{constructor(){super();this.isBufferGeometry=true;Object.defineProperty(this,"id",{value:n2++});this.uuid=sT();this.name="";this.type="BufferGeometry";this.index=null;this.indirect=null;this.attributes={};this.morphAttributes={};this.morphTargetsRelative=false;this.groups=[];this.boundingBox=null;this.boundingSphere=null;this.drawRange={start:0,count:Infinity};this.userData={}}getIndex(){return this.index}setIndex(t){if(Array.isArray(t)){this.index=new(sQ(t)?nK:n$)(t,1)}else{this.index=t}return this}setIndirect(t){this.indirect=t;return this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){this.attributes[t]=e;return this}deleteAttribute(t){delete this.attributes[t];return this}hasAttribute(t){return this.attributes[t]!==undefined}addGroup(t,e,s=0){this.groups.push({start:t,count:e,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t;this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;if(e!==undefined){e.applyMatrix4(t);e.needsUpdate=true}const s=this.attributes.normal;if(s!==undefined){const e=new sG().getNormalMatrix(t);s.applyNormalMatrix(e);s.needsUpdate=true}const i=this.attributes.tangent;if(i!==undefined){i.transformDirection(t);i.needsUpdate=true}if(this.boundingBox!==null){this.computeBoundingBox()}if(this.boundingSphere!==null){this.computeBoundingSphere()}return this}applyQuaternion(t){n3.makeRotationFromQuaternion(t);this.applyMatrix4(n3);return this}rotateX(t){n3.makeRotationX(t);this.applyMatrix4(n3);return this}rotateY(t){n3.makeRotationY(t);this.applyMatrix4(n3);return this}rotateZ(t){n3.makeRotationZ(t);this.applyMatrix4(n3);return this}translate(t,e,s){n3.makeTranslation(t,e,s);this.applyMatrix4(n3);return this}scale(t,e,s){n3.makeScale(t,e,s);this.applyMatrix4(n3);return this}lookAt(t){n5.lookAt(t);n5.updateMatrix();this.applyMatrix4(n5.matrix);return this}center(){this.computeBoundingBox();this.boundingBox.getCenter(n4).negate();this.translate(n4.x,n4.y,n4.z);return this}setFromPoints(t){const e=this.getAttribute("position");if(e===undefined){const e=[];for(let s=0,i=t.length;s<i;s++){const i=t[s];e.push(i.x,i.y,i.z||0)}this.setAttribute("position",new n1(e,3))}else{const s=Math.min(t.length,e.count);for(let i=0;i<s;i++){const s=t[i];e.setXYZ(i,s.x,s.y,s.z||0)}if(t.length>e.count){console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry.")}e.needsUpdate=true}return this}computeBoundingBox(){if(this.boundingBox===null){this.boundingBox=new i_}const t=this.attributes.position;const e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this);this.boundingBox.set(new iM(-Infinity,-Infinity,-Infinity),new iM(+Infinity,+Infinity,+Infinity));return}if(t!==undefined){this.boundingBox.setFromBufferAttribute(t);if(e){for(let t=0,s=e.length;t<s;t++){const s=e[t];n6.setFromBufferAttribute(s);if(this.morphTargetsRelative){n9.addVectors(this.boundingBox.min,n6.min);this.boundingBox.expandByPoint(n9);n9.addVectors(this.boundingBox.max,n6.max);this.boundingBox.expandByPoint(n9)}else{this.boundingBox.expandByPoint(n6.min);this.boundingBox.expandByPoint(n6.max)}}}}else{this.boundingBox.makeEmpty()}if(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)){console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}computeBoundingSphere(){if(this.boundingSphere===null){this.boundingSphere=new iU}const t=this.attributes.position;const e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this);this.boundingSphere.set(new iM,Infinity);return}if(t){const s=this.boundingSphere.center;n6.setFromBufferAttribute(t);if(e){for(let t=0,s=e.length;t<s;t++){const s=e[t];n8.setFromBufferAttribute(s);if(this.morphTargetsRelative){n9.addVectors(n6.min,n8.min);n6.expandByPoint(n9);n9.addVectors(n6.max,n8.max);n6.expandByPoint(n9)}else{n6.expandByPoint(n8.min);n6.expandByPoint(n8.max)}}}n6.getCenter(s);let i=0;for(let e=0,n=t.count;e<n;e++){n9.fromBufferAttribute(t,e);i=Math.max(i,s.distanceToSquared(n9))}if(e){for(let n=0,r=e.length;n<r;n++){const r=e[n];const o=this.morphTargetsRelative;for(let e=0,n=r.count;e<n;e++){n9.fromBufferAttribute(r,e);if(o){n4.fromBufferAttribute(t,e);n9.add(n4)}i=Math.max(i,s.distanceToSquared(n9))}}}this.boundingSphere.radius=Math.sqrt(i);if(isNaN(this.boundingSphere.radius)){console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}computeTangents(){const t=this.index;const e=this.attributes;if(t===null||e.position===undefined||e.normal===undefined||e.uv===undefined){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const s=e.position;const i=e.normal;const n=e.uv;if(this.hasAttribute("tangent")===false){this.setAttribute("tangent",new nJ(new Float32Array(4*s.count),4))}const r=this.getAttribute("tangent");const o=[],a=[];for(let t=0;t<s.count;t++){o[t]=new iM;a[t]=new iM}const h=new iM,c=new iM,l=new iM,u=new sZ,d=new sZ,p=new sZ,f=new iM,m=new iM;function y(t,e,i){h.fromBufferAttribute(s,t);c.fromBufferAttribute(s,e);l.fromBufferAttribute(s,i);u.fromBufferAttribute(n,t);d.fromBufferAttribute(n,e);p.fromBufferAttribute(n,i);c.sub(h);l.sub(h);d.sub(u);p.sub(u);const r=1/(d.x*p.y-p.x*d.y);if(!isFinite(r))return;f.copy(c).multiplyScalar(p.y).addScaledVector(l,-d.y).multiplyScalar(r);m.copy(l).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(r);o[t].add(f);o[e].add(f);o[i].add(f);a[t].add(m);a[e].add(m);a[i].add(m)}let g=this.groups;if(g.length===0){g=[{start:0,count:t.count}]}for(let e=0,s=g.length;e<s;++e){const s=g[e];const i=s.start;const n=s.count;for(let e=i,s=i+n;e<s;e+=3){y(t.getX(e+0),t.getX(e+1),t.getX(e+2))}}const x=new iM,b=new iM;const w=new iM,M=new iM;function v(t){w.fromBufferAttribute(i,t);M.copy(w);const e=o[t];x.copy(e);x.sub(w.multiplyScalar(w.dot(e))).normalize();b.crossVectors(M,e);const s=b.dot(a[t]);const n=s<0?-1:1;r.setXYZW(t,x.x,x.y,x.z,n)}for(let e=0,s=g.length;e<s;++e){const s=g[e];const i=s.start;const n=s.count;for(let e=i,s=i+n;e<s;e+=3){v(t.getX(e+0));v(t.getX(e+1));v(t.getX(e+2))}}}computeVertexNormals(){const t=this.index;const e=this.getAttribute("position");if(e!==undefined){let s=this.getAttribute("normal");if(s===undefined){s=new nJ(new Float32Array(e.count*3),3);this.setAttribute("normal",s)}else{for(let t=0,e=s.count;t<e;t++){s.setXYZ(t,0,0,0)}}const i=new iM,n=new iM,r=new iM;const o=new iM,a=new iM,h=new iM;const c=new iM,l=new iM;if(t){for(let u=0,d=t.count;u<d;u+=3){const d=t.getX(u+0);const p=t.getX(u+1);const f=t.getX(u+2);i.fromBufferAttribute(e,d);n.fromBufferAttribute(e,p);r.fromBufferAttribute(e,f);c.subVectors(r,n);l.subVectors(i,n);c.cross(l);o.fromBufferAttribute(s,d);a.fromBufferAttribute(s,p);h.fromBufferAttribute(s,f);o.add(c);a.add(c);h.add(c);s.setXYZ(d,o.x,o.y,o.z);s.setXYZ(p,a.x,a.y,a.z);s.setXYZ(f,h.x,h.y,h.z)}}else{for(let t=0,o=e.count;t<o;t+=3){i.fromBufferAttribute(e,t+0);n.fromBufferAttribute(e,t+1);r.fromBufferAttribute(e,t+2);c.subVectors(r,n);l.subVectors(i,n);c.cross(l);s.setXYZ(t+0,c.x,c.y,c.z);s.setXYZ(t+1,c.x,c.y,c.z);s.setXYZ(t+2,c.x,c.y,c.z)}}this.normalizeNormals();s.needsUpdate=true}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,s=t.count;e<s;e++){n9.fromBufferAttribute(t,e);n9.normalize();t.setXYZ(e,n9.x,n9.y,n9.z)}}toNonIndexed(){function t(t,e){const s=t.array;const i=t.itemSize;const n=t.normalized;const r=new s.constructor(e.length*i);let o=0,a=0;for(let n=0,h=e.length;n<h;n++){if(t.isInterleavedBufferAttribute){o=e[n]*t.data.stride+t.offset}else{o=e[n]*i}for(let t=0;t<i;t++){r[a++]=s[o++]}}return new nJ(r,i,n)}if(this.index===null){console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.");return this}const e=new n7;const s=this.index.array;const i=this.attributes;for(const n in i){const r=i[n];const o=t(r,s);e.setAttribute(n,o)}const n=this.morphAttributes;for(const i in n){const r=[];const o=n[i];for(let e=0,i=o.length;e<i;e++){const i=o[e];const n=t(i,s);r.push(n)}e.morphAttributes[i]=r}e.morphTargetsRelative=this.morphTargetsRelative;const r=this.groups;for(let t=0,s=r.length;t<s;t++){const s=r[t];e.addGroup(s.start,s.count,s.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};t.uuid=this.uuid;t.type=this.type;if(this.name!=="")t.name=this.name;if(Object.keys(this.userData).length>0)t.userData=this.userData;if(this.parameters!==undefined){const e=this.parameters;for(const s in e){if(e[s]!==undefined)t[s]=e[s]}return t}t.data={attributes:{}};const e=this.index;if(e!==null){t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)}}const s=this.attributes;for(const e in s){const i=s[e];t.data.attributes[e]=i.toJSON(t.data)}const i={};let n=false;for(const e in this.morphAttributes){const s=this.morphAttributes[e];const r=[];for(let e=0,i=s.length;e<i;e++){const i=s[e];r.push(i.toJSON(t.data))}if(r.length>0){i[e]=r;n=true}}if(n){t.data.morphAttributes=i;t.data.morphTargetsRelative=this.morphTargetsRelative}const r=this.groups;if(r.length>0){t.data.groups=JSON.parse(JSON.stringify(r))}const o=this.boundingSphere;if(o!==null){t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}}return t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingBox=null;this.boundingSphere=null;const e={};this.name=t.name;const s=t.index;if(s!==null){this.setIndex(s.clone())}const i=t.attributes;for(const t in i){const s=i[t];this.setAttribute(t,s.clone(e))}const n=t.morphAttributes;for(const t in n){const s=[];const i=n[t];for(let t=0,n=i.length;t<n;t++){s.push(i[t].clone(e))}this.morphAttributes[t]=s}this.morphTargetsRelative=t.morphTargetsRelative;const r=t.groups;for(let t=0,e=r.length;t<e;t++){const e=r[t];this.addGroup(e.start,e.count,e.materialIndex)}const o=t.boundingBox;if(o!==null){this.boundingBox=o.clone()}const a=t.boundingSphere;if(a!==null){this.boundingSphere=a.clone()}this.drawRange.start=t.drawRange.start;this.drawRange.count=t.drawRange.count;this.userData=t.userData;return this}dispose(){this.dispatchEvent({type:"dispose"})}}const rt=new i$;const re=new iG;const rs=new iU;const ri=new iM;const rn=new iM;const rr=new iM;const ro=new iM;const ra=new iM;const rh=new iM;const rc=new iM;const rl=new iM;class ru extends nf{constructor(t=new n7,e=new nN){super();this.isMesh=true;this.type="Mesh";this.geometry=t;this.material=e;this.morphTargetDictionary=undefined;this.morphTargetInfluences=undefined;this.updateMorphTargets()}copy(t,e){super.copy(t,e);if(t.morphTargetInfluences!==undefined){this.morphTargetInfluences=t.morphTargetInfluences.slice()}if(t.morphTargetDictionary!==undefined){this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)}this.material=Array.isArray(t.material)?t.material.slice():t.material;this.geometry=t.geometry;return this}updateMorphTargets(){const t=this.geometry;const e=t.morphAttributes;const s=Object.keys(e);if(s.length>0){const t=e[s[0]];if(t!==undefined){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let e=0,s=t.length;e<s;e++){const s=t[e].name||String(e);this.morphTargetInfluences.push(0);this.morphTargetDictionary[s]=e}}}}getVertexPosition(t,e){const s=this.geometry;const i=s.attributes.position;const n=s.morphAttributes.position;const r=s.morphTargetsRelative;e.fromBufferAttribute(i,t);const o=this.morphTargetInfluences;if(n&&o){rh.set(0,0,0);for(let s=0,i=n.length;s<i;s++){const i=o[s];const a=n[s];if(i===0)continue;ra.fromBufferAttribute(a,t);if(r){rh.addScaledVector(ra,i)}else{rh.addScaledVector(ra.sub(e),i)}}e.add(rh)}return e}raycast(t,e){const s=this.geometry;const i=this.material;const n=this.matrixWorld;if(i===undefined)return;if(s.boundingSphere===null)s.computeBoundingSphere();rs.copy(s.boundingSphere);rs.applyMatrix4(n);re.copy(t.ray).recast(t.near);if(rs.containsPoint(re.origin)===false){if(re.intersectSphere(rs,ri)===null)return;if(re.origin.distanceToSquared(ri)>(t.far-t.near)**2)return}rt.copy(n).invert();re.copy(t.ray).applyMatrix4(rt);if(s.boundingBox!==null){if(re.intersectsBox(s.boundingBox)===false)return}this._computeIntersections(t,e,re)}_computeIntersections(t,e,s){let i;const n=this.geometry;const r=this.material;const o=n.index;const a=n.attributes.position;const h=n.attributes.uv;const c=n.attributes.uv1;const l=n.attributes.normal;const u=n.groups;const d=n.drawRange;if(o!==null){if(Array.isArray(r)){for(let n=0,a=u.length;n<a;n++){const a=u[n];const p=r[a.materialIndex];const f=Math.max(a.start,d.start);const m=Math.min(o.count,Math.min(a.start+a.count,d.start+d.count));for(let n=f,r=m;n<r;n+=3){const r=o.getX(n);const u=o.getX(n+1);const d=o.getX(n+2);i=rp(this,p,t,s,h,c,l,r,u,d);if(i){i.faceIndex=Math.floor(n/3);i.face.materialIndex=a.materialIndex;e.push(i)}}}}else{const n=Math.max(0,d.start);const a=Math.min(o.count,d.start+d.count);for(let u=n,d=a;u<d;u+=3){const n=o.getX(u);const a=o.getX(u+1);const d=o.getX(u+2);i=rp(this,r,t,s,h,c,l,n,a,d);if(i){i.faceIndex=Math.floor(u/3);e.push(i)}}}}else if(a!==undefined){if(Array.isArray(r)){for(let n=0,o=u.length;n<o;n++){const o=u[n];const p=r[o.materialIndex];const f=Math.max(o.start,d.start);const m=Math.min(a.count,Math.min(o.start+o.count,d.start+d.count));for(let n=f,r=m;n<r;n+=3){const r=n;const a=n+1;const u=n+2;i=rp(this,p,t,s,h,c,l,r,a,u);if(i){i.faceIndex=Math.floor(n/3);i.face.materialIndex=o.materialIndex;e.push(i)}}}}else{const n=Math.max(0,d.start);const o=Math.min(a.count,d.start+d.count);for(let a=n,u=o;a<u;a+=3){const n=a;const o=a+1;const u=a+2;i=rp(this,r,t,s,h,c,l,n,o,u);if(i){i.faceIndex=Math.floor(a/3);e.push(i)}}}}}}function rd(t,e,s,i,n,r,o,a){let h;if(e.side===m){h=i.intersectTriangle(o,r,n,true,a)}else{h=i.intersectTriangle(n,r,o,e.side===f,a)}if(h===null)return null;rl.copy(a);rl.applyMatrix4(t.matrixWorld);const c=s.ray.origin.distanceTo(rl);if(c<s.near||c>s.far)return null;return{distance:c,point:rl.clone(),object:t}}function rp(t,e,s,i,n,r,o,a,h,c){t.getVertexPosition(a,rn);t.getVertexPosition(h,rr);t.getVertexPosition(c,ro);const l=rd(t,e,s,i,rn,rr,ro,rc);if(l){const t=new iM;nI.getBarycoord(rc,rn,rr,ro,t);if(n){l.uv=nI.getInterpolatedAttribute(n,a,h,c,t,new sZ)}if(r){l.uv1=nI.getInterpolatedAttribute(r,a,h,c,t,new sZ)}if(o){l.normal=nI.getInterpolatedAttribute(o,a,h,c,t,new iM);if(l.normal.dot(i.direction)>0){l.normal.multiplyScalar(-1)}}const e={a:a,b:h,c:c,normal:new iM,materialIndex:0};nI.getNormal(rn,rr,ro,e.normal);l.face=e;l.barycoord=t}return l}class rf extends n7{constructor(t=1,e=1,s=1,i=1,n=1,r=1){super();this.type="BoxGeometry";this.parameters={width:t,height:e,depth:s,widthSegments:i,heightSegments:n,depthSegments:r};const o=this;i=Math.floor(i);n=Math.floor(n);r=Math.floor(r);const a=[];const h=[];const c=[];const l=[];let u=0;let d=0;p("z","y","x",-1,-1,s,e,t,r,n,0);p("z","y","x",1,-1,s,e,-t,r,n,1);p("x","z","y",1,1,t,s,e,i,r,2);p("x","z","y",1,-1,t,s,-e,i,r,3);p("x","y","z",1,-1,t,e,s,i,n,4);p("x","y","z",-1,-1,t,e,-s,i,n,5);this.setIndex(a);this.setAttribute("position",new n1(h,3));this.setAttribute("normal",new n1(c,3));this.setAttribute("uv",new n1(l,2));function p(t,e,s,i,n,r,p,f,m,y,g){const x=r/m;const b=p/y;const w=r/2;const M=p/2;const v=f/2;const S=m+1;const _=y+1;let A=0;let T=0;const z=new iM;for(let r=0;r<_;r++){const o=r*b-M;for(let a=0;a<S;a++){const u=a*x-w;z[t]=u*i;z[e]=o*n;z[s]=v;h.push(z.x,z.y,z.z);z[t]=0;z[e]=0;z[s]=f>0?1:-1;c.push(z.x,z.y,z.z);l.push(a/m);l.push(1-r/y);A+=1}}for(let t=0;t<y;t++){for(let e=0;e<m;e++){const s=u+e+S*t;const i=u+e+S*(t+1);const n=u+(e+1)+S*(t+1);const r=u+(e+1)+S*t;a.push(s,i,r);a.push(i,n,r);T+=6}}o.addGroup(d,T,g);d+=T;u+=A}}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new rf(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function rm(t){const e={};for(const s in t){e[s]={};for(const i in t[s]){const n=t[s][i];if(n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)){if(n.isRenderTargetTexture){console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms().");e[s][i]=null}else{e[s][i]=n.clone()}}else if(Array.isArray(n)){e[s][i]=n.slice()}else{e[s][i]=n}}}return e}function ry(t){const e={};for(let s=0;s<t.length;s++){const i=rm(t[s]);for(const t in i){e[t]=i[t]}}return e}function rg(t){const e=[];for(let s=0;s<t.length;s++){e.push(t[s].clone())}return e}function rx(t){const e=t.getRenderTarget();if(e===null){return t.outputColorSpace}if(e.isXRRenderTarget===true){return e.texture.colorSpace}return ie.workingColorSpace}const rb={clone:rm,merge:ry};var rw="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";var rM="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";class rv extends nF{constructor(t){super();this.isShaderMaterial=true;this.type="ShaderMaterial";this.defines={};this.uniforms={};this.uniformsGroups=[];this.vertexShader=rw;this.fragmentShader=rM;this.linewidth=1;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.clipping=false;this.forceSinglePass=true;this.extensions={clipCullDistance:false,multiDraw:false};this.defaultAttributeValues={"color":[1,1,1],"uv":[0,0],"uv1":[0,0]};this.index0AttributeName=undefined;this.uniformsNeedUpdate=false;this.glslVersion=null;if(t!==undefined){this.setValues(t)}}copy(t){super.copy(t);this.fragmentShader=t.fragmentShader;this.vertexShader=t.vertexShader;this.uniforms=rm(t.uniforms);this.uniformsGroups=rg(t.uniformsGroups);this.defines=Object.assign({},t.defines);this.wireframe=t.wireframe;this.wireframeLinewidth=t.wireframeLinewidth;this.fog=t.fog;this.lights=t.lights;this.clipping=t.clipping;this.extensions=Object.assign({},t.extensions);this.glslVersion=t.glslVersion;return this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion;e.uniforms={};for(const s in this.uniforms){const i=this.uniforms[s];const n=i.value;if(n&&n.isTexture){e.uniforms[s]={type:"t",value:n.toJSON(t).uuid}}else if(n&&n.isColor){e.uniforms[s]={type:"c",value:n.getHex()}}else if(n&&n.isVector2){e.uniforms[s]={type:"v2",value:n.toArray()}}else if(n&&n.isVector3){e.uniforms[s]={type:"v3",value:n.toArray()}}else if(n&&n.isVector4){e.uniforms[s]={type:"v4",value:n.toArray()}}else if(n&&n.isMatrix3){e.uniforms[s]={type:"m3",value:n.toArray()}}else if(n&&n.isMatrix4){e.uniforms[s]={type:"m4",value:n.toArray()}}else{e.uniforms[s]={value:n}}}if(Object.keys(this.defines).length>0)e.defines=this.defines;e.vertexShader=this.vertexShader;e.fragmentShader=this.fragmentShader;e.lights=this.lights;e.clipping=this.clipping;const s={};for(const t in this.extensions){if(this.extensions[t]===true)s[t]=true}if(Object.keys(s).length>0)e.extensions=s;return e}}class rS extends nf{constructor(){super();this.isCamera=true;this.type="Camera";this.matrixWorldInverse=new i$;this.projectionMatrix=new i$;this.projectionMatrixInverse=new i$;this.coordinateSystem=sy}copy(t,e){super.copy(t,e);this.matrixWorldInverse.copy(t.matrixWorldInverse);this.projectionMatrix.copy(t.projectionMatrix);this.projectionMatrixInverse.copy(t.projectionMatrixInverse);this.coordinateSystem=t.coordinateSystem;return this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t);this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e);this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const r_=new iM;const rA=new sZ;const rT=new sZ;class rz extends rS{constructor(t=50,e=1,s=.1,i=2e3){super();this.isPerspectiveCamera=true;this.type="PerspectiveCamera";this.fov=t;this.zoom=1;this.near=s;this.far=i;this.focus=10;this.aspect=e;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}copy(t,e){super.copy(t,e);this.fov=t.fov;this.zoom=t.zoom;this.near=t.near;this.far=t.far;this.focus=t.focus;this.aspect=t.aspect;this.view=t.view===null?null:Object.assign({},t.view);this.filmGauge=t.filmGauge;this.filmOffset=t.filmOffset;return this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=sA*2*Math.atan(e);this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(s_*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return sA*2*Math.atan(Math.tan(s_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,e,s){r_.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse);e.set(r_.x,r_.y).multiplyScalar(-t/r_.z);r_.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse);s.set(r_.x,r_.y).multiplyScalar(-t/r_.z)}getViewSize(t,e){this.getViewBounds(t,rA,rT);return e.subVectors(rT,rA)}setViewOffset(t,e,s,i,n,r){this.aspect=t/e;if(this.view===null){this.view={enabled:true,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}}this.view.enabled=true;this.view.fullWidth=t;this.view.fullHeight=e;this.view.offsetX=s;this.view.offsetY=i;this.view.width=n;this.view.height=r;this.updateProjectionMatrix()}clearViewOffset(){if(this.view!==null){this.view.enabled=false}this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(s_*.5*this.fov)/this.zoom;let s=2*e;let i=this.aspect*s;let n=-.5*i;const r=this.view;if(this.view!==null&&this.view.enabled){const t=r.fullWidth,o=r.fullHeight;n+=r.offsetX*i/t;e-=r.offsetY*s/o;i*=r.width/t;s*=r.height/o}const o=this.filmOffset;if(o!==0)n+=t*o/this.getFilmWidth();this.projectionMatrix.makePerspective(n,n+i,e,e-s,t,this.far,this.coordinateSystem);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);e.object.fov=this.fov;e.object.zoom=this.zoom;e.object.near=this.near;e.object.far=this.far;e.object.focus=this.focus;e.object.aspect=this.aspect;if(this.view!==null)e.object.view=Object.assign({},this.view);e.object.filmGauge=this.filmGauge;e.object.filmOffset=this.filmOffset;return e}}const rI=-90;const rC=1;class rB extends nf{constructor(t,e,s){super();this.type="CubeCamera";this.renderTarget=s;this.coordinateSystem=null;this.activeMipmapLevel=0;const i=new rz(rI,rC,t,e);i.layers=this.layers;this.add(i);const n=new rz(rI,rC,t,e);n.layers=this.layers;this.add(n);const r=new rz(rI,rC,t,e);r.layers=this.layers;this.add(r);const o=new rz(rI,rC,t,e);o.layers=this.layers;this.add(o);const a=new rz(rI,rC,t,e);a.layers=this.layers;this.add(a);const h=new rz(rI,rC,t,e);h.layers=this.layers;this.add(h)}updateCoordinateSystem(){const t=this.coordinateSystem;const e=this.children.concat();const[s,i,n,r,o,a]=e;for(const t of e)this.remove(t);if(t===sy){s.up.set(0,1,0);s.lookAt(1,0,0);i.up.set(0,1,0);i.lookAt(-1,0,0);n.up.set(0,0,-1);n.lookAt(0,1,0);r.up.set(0,0,1);r.lookAt(0,-1,0);o.up.set(0,1,0);o.lookAt(0,0,1);a.up.set(0,1,0);a.lookAt(0,0,-1)}else if(t===sg){s.up.set(0,-1,0);s.lookAt(-1,0,0);i.up.set(0,-1,0);i.lookAt(1,0,0);n.up.set(0,0,1);n.lookAt(0,1,0);r.up.set(0,0,-1);r.lookAt(0,-1,0);o.up.set(0,-1,0);o.lookAt(0,0,1);a.up.set(0,-1,0);a.lookAt(0,0,-1)}else{throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t)}for(const t of e){this.add(t);t.updateMatrixWorld()}}update(t,e){if(this.parent===null)this.updateMatrixWorld();const{renderTarget:s,activeMipmapLevel:i}=this;if(this.coordinateSystem!==t.coordinateSystem){this.coordinateSystem=t.coordinateSystem;this.updateCoordinateSystem()}const[n,r,o,a,h,c]=this.children;const l=t.getRenderTarget();const u=t.getActiveCubeFace();const d=t.getActiveMipmapLevel();const p=t.xr.enabled;t.xr.enabled=false;const f=s.texture.generateMipmaps;s.texture.generateMipmaps=false;t.setRenderTarget(s,0,i);t.render(e,n);t.setRenderTarget(s,1,i);t.render(e,r);t.setRenderTarget(s,2,i);t.render(e,o);t.setRenderTarget(s,3,i);t.render(e,a);t.setRenderTarget(s,4,i);t.render(e,h);s.texture.generateMipmaps=f;t.setRenderTarget(s,5,i);t.render(e,c);t.setRenderTarget(l,u,d);t.xr.enabled=p;s.texture.needsPMREMUpdate=true}}class rk extends iu{constructor(t=[],e=tu,s,i,n,r,o,a,h,c){super(t,e,s,i,n,r,o,a,h,c);this.isCubeTexture=true;this.flipY=false}get images(){return this.image}set images(t){this.image=t}}class rR extends im{constructor(t=1,e={}){super(t,t,e);this.isWebGLCubeRenderTarget=true;const s={width:t,height:t,depth:1};const i=[s,s,s,s,s,s];this.texture=new rk(i,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.colorSpace);this.texture.isRenderTargetTexture=true;this.texture.generateMipmaps=e.generateMipmaps!==undefined?e.generateMipmaps:false;this.texture.minFilter=e.minFilter!==undefined?e.minFilter:t_}fromEquirectangularTexture(t,e){this.texture.type=e.type;this.texture.colorSpace=e.colorSpace;this.texture.generateMipmaps=e.generateMipmaps;this.texture.minFilter=e.minFilter;this.texture.magFilter=e.magFilter;const s={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`};const i=new rf(5,5,5);const n=new rv({name:"CubemapFromEquirect",uniforms:rm(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,side:m,blending:g});n.uniforms.tEquirect.value=e;const r=new ru(i,n);const o=e.minFilter;if(e.minFilter===tz)e.minFilter=t_;const a=new rB(1,10,this);a.update(t,r);e.minFilter=o;r.geometry.dispose();r.material.dispose();return this}clear(t,e=true,s=true,i=true){const n=t.getRenderTarget();for(let n=0;n<6;n++){t.setRenderTarget(this,n);t.clear(e,s,i)}t.setRenderTarget(n)}}class rE extends nf{constructor(){super();this.isGroup=true;this.type="Group"}}const rP={type:"move"};class rO{constructor(){this._targetRay=null;this._grip=null;this._hand=null}getHandSpace(){if(this._hand===null){this._hand=new rE;this._hand.matrixAutoUpdate=false;this._hand.visible=false;this._hand.joints={};this._hand.inputState={pinching:false}}return this._hand}getTargetRaySpace(){if(this._targetRay===null){this._targetRay=new rE;this._targetRay.matrixAutoUpdate=false;this._targetRay.visible=false;this._targetRay.hasLinearVelocity=false;this._targetRay.linearVelocity=new iM;this._targetRay.hasAngularVelocity=false;this._targetRay.angularVelocity=new iM}return this._targetRay}getGripSpace(){if(this._grip===null){this._grip=new rE;this._grip.matrixAutoUpdate=false;this._grip.visible=false;this._grip.hasLinearVelocity=false;this._grip.linearVelocity=new iM;this._grip.hasAngularVelocity=false;this._grip.angularVelocity=new iM}return this._grip}dispatchEvent(t){if(this._targetRay!==null){this._targetRay.dispatchEvent(t)}if(this._grip!==null){this._grip.dispatchEvent(t)}if(this._hand!==null){this._hand.dispatchEvent(t)}return this}connect(t){if(t&&t.hand){const e=this._hand;if(e){for(const s of t.hand.values()){this._getHandJoint(e,s)}}}this.dispatchEvent({type:"connected",data:t});return this}disconnect(t){this.dispatchEvent({type:"disconnected",data:t});if(this._targetRay!==null){this._targetRay.visible=false}if(this._grip!==null){this._grip.visible=false}if(this._hand!==null){this._hand.visible=false}return this}update(t,e,s){let i=null;let n=null;let r=null;const o=this._targetRay;const a=this._grip;const h=this._hand;if(t&&e.session.visibilityState!=="visible-blurred"){if(h&&t.hand){r=true;for(const i of t.hand.values()){const t=e.getJointPose(i,s);const n=this._getHandJoint(h,i);if(t!==null){n.matrix.fromArray(t.transform.matrix);n.matrix.decompose(n.position,n.rotation,n.scale);n.matrixWorldNeedsUpdate=true;n.jointRadius=t.radius}n.visible=t!==null}const i=h.joints["index-finger-tip"];const n=h.joints["thumb-tip"];const o=i.position.distanceTo(n.position);const a=.02;const c=.005;if(h.inputState.pinching&&o>a+c){h.inputState.pinching=false;this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})}else if(!h.inputState.pinching&&o<=a-c){h.inputState.pinching=true;this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this})}}else{if(a!==null&&t.gripSpace){n=e.getPose(t.gripSpace,s);if(n!==null){a.matrix.fromArray(n.transform.matrix);a.matrix.decompose(a.position,a.rotation,a.scale);a.matrixWorldNeedsUpdate=true;if(n.linearVelocity){a.hasLinearVelocity=true;a.linearVelocity.copy(n.linearVelocity)}else{a.hasLinearVelocity=false}if(n.angularVelocity){a.hasAngularVelocity=true;a.angularVelocity.copy(n.angularVelocity)}else{a.hasAngularVelocity=false}}}}if(o!==null){i=e.getPose(t.targetRaySpace,s);if(i===null&&n!==null){i=n}if(i!==null){o.matrix.fromArray(i.transform.matrix);o.matrix.decompose(o.position,o.rotation,o.scale);o.matrixWorldNeedsUpdate=true;if(i.linearVelocity){o.hasLinearVelocity=true;o.linearVelocity.copy(i.linearVelocity)}else{o.hasLinearVelocity=false}if(i.angularVelocity){o.hasAngularVelocity=true;o.angularVelocity.copy(i.angularVelocity)}else{o.hasAngularVelocity=false}this.dispatchEvent(rP)}}}if(o!==null){o.visible=i!==null}if(a!==null){a.visible=n!==null}if(h!==null){h.visible=r!==null}return this}_getHandJoint(t,e){if(t.joints[e.jointName]===undefined){const s=new rE;s.matrixAutoUpdate=false;s.visible=false;t.joints[e.jointName]=s;t.add(s)}return t.joints[e.jointName]}}class rF{constructor(t,e=25e-5){this.isFogExp2=true;this.name="";this.color=new nE(t);this.density=e}clone(){return new rF(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class rN{constructor(t,e=1,s=1e3){this.isFog=true;this.name="";this.color=new nE(t);this.near=e;this.far=s}clone(){return new rN(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class rV extends nf{constructor(){super();this.isScene=true;this.type="Scene";this.background=null;this.environment=null;this.fog=null;this.backgroundBlurriness=0;this.backgroundIntensity=1;this.backgroundRotation=new i8;this.environmentIntensity=1;this.environmentRotation=new i8;this.overrideMaterial=null;if(typeof __THREE_DEVTOOLS__!=="undefined"){__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}copy(t,e){super.copy(t,e);if(t.background!==null)this.background=t.background.clone();if(t.environment!==null)this.environment=t.environment.clone();if(t.fog!==null)this.fog=t.fog.clone();this.backgroundBlurriness=t.backgroundBlurriness;this.backgroundIntensity=t.backgroundIntensity;this.backgroundRotation.copy(t.backgroundRotation);this.environmentIntensity=t.environmentIntensity;this.environmentRotation.copy(t.environmentRotation);if(t.overrideMaterial!==null)this.overrideMaterial=t.overrideMaterial.clone();this.matrixAutoUpdate=t.matrixAutoUpdate;return this}toJSON(t){const e=super.toJSON(t);if(this.fog!==null)e.object.fog=this.fog.toJSON();if(this.backgroundBlurriness>0)e.object.backgroundBlurriness=this.backgroundBlurriness;if(this.backgroundIntensity!==1)e.object.backgroundIntensity=this.backgroundIntensity;e.object.backgroundRotation=this.backgroundRotation.toArray();if(this.environmentIntensity!==1)e.object.environmentIntensity=this.environmentIntensity;e.object.environmentRotation=this.environmentRotation.toArray();return e}}class rL{constructor(t,e){this.isInterleavedBuffer=true;this.array=t;this.stride=e;this.count=t!==undefined?t.length/e:0;this.usage=sr;this.updateRanges=[];this.version=0;this.uuid=sT()}onUploadCallback(){}set needsUpdate(t){if(t===true)this.version++}setUsage(t){this.usage=t;return this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){this.array=new t.array.constructor(t.array);this.count=t.count;this.stride=t.stride;this.usage=t.usage;return this}copyAt(t,e,s){t*=this.stride;s*=e.stride;for(let i=0,n=this.stride;i<n;i++){this.array[t+i]=e.array[s+i]}return this}set(t,e=0){this.array.set(t,e);return this}clone(t){if(t.arrayBuffers===undefined){t.arrayBuffers={}}if(this.array.buffer._uuid===undefined){this.array.buffer._uuid=sT()}if(t.arrayBuffers[this.array.buffer._uuid]===undefined){t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer}const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]);const s=new this.constructor(e,this.stride);s.setUsage(this.usage);return s}onUpload(t){this.onUploadCallback=t;return this}toJSON(t){if(t.arrayBuffers===undefined){t.arrayBuffers={}}if(this.array.buffer._uuid===undefined){this.array.buffer._uuid=sT()}if(t.arrayBuffers[this.array.buffer._uuid]===undefined){t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))}return{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const rj=new iM;class rW{constructor(t,e,s,i=false){this.isInterleavedBufferAttribute=true;this.name="";this.data=t;this.itemSize=e;this.offset=s;this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,s=this.data.count;e<s;e++){rj.fromBufferAttribute(this,e);rj.applyMatrix4(t);this.setXYZ(e,rj.x,rj.y,rj.z)}return this}applyNormalMatrix(t){for(let e=0,s=this.count;e<s;e++){rj.fromBufferAttribute(this,e);rj.applyNormalMatrix(t);this.setXYZ(e,rj.x,rj.y,rj.z)}return this}transformDirection(t){for(let e=0,s=this.count;e<s;e++){rj.fromBufferAttribute(this,e);rj.transformDirection(t);this.setXYZ(e,rj.x,rj.y,rj.z)}return this}getComponent(t,e){let s=this.array[t*this.data.stride+this.offset+e];if(this.normalized)s=sJ(s,this.array);return s}setComponent(t,e,s){if(this.normalized)s=sX(s,this.array);this.data.array[t*this.data.stride+this.offset+e]=s;return this}setX(t,e){if(this.normalized)e=sX(e,this.array);this.data.array[t*this.data.stride+this.offset]=e;return this}setY(t,e){if(this.normalized)e=sX(e,this.array);this.data.array[t*this.data.stride+this.offset+1]=e;return this}setZ(t,e){if(this.normalized)e=sX(e,this.array);this.data.array[t*this.data.stride+this.offset+2]=e;return this}setW(t,e){if(this.normalized)e=sX(e,this.array);this.data.array[t*this.data.stride+this.offset+3]=e;return this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];if(this.normalized)e=sJ(e,this.array);return e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];if(this.normalized)e=sJ(e,this.array);return e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];if(this.normalized)e=sJ(e,this.array);return e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];if(this.normalized)e=sJ(e,this.array);return e}setXY(t,e,s){t=t*this.data.stride+this.offset;if(this.normalized){e=sX(e,this.array);s=sX(s,this.array)}this.data.array[t+0]=e;this.data.array[t+1]=s;return this}setXYZ(t,e,s,i){t=t*this.data.stride+this.offset;if(this.normalized){e=sX(e,this.array);s=sX(s,this.array);i=sX(i,this.array)}this.data.array[t+0]=e;this.data.array[t+1]=s;this.data.array[t+2]=i;return this}setXYZW(t,e,s,i,n){t=t*this.data.stride+this.offset;if(this.normalized){e=sX(e,this.array);s=sX(s,this.array);i=sX(i,this.array);n=sX(n,this.array)}this.data.array[t+0]=e;this.data.array[t+1]=s;this.data.array[t+2]=i;this.data.array[t+3]=n;return this}clone(t){if(t===undefined){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const s=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++){t.push(this.data.array[s+e])}}return new nJ(new this.array.constructor(t),this.itemSize,this.normalized)}else{if(t.interleavedBuffers===undefined){t.interleavedBuffers={}}if(t.interleavedBuffers[this.data.uuid]===undefined){t.interleavedBuffers[this.data.uuid]=this.data.clone(t)}return new rW(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}}toJSON(t){if(t===undefined){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const s=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++){t.push(this.data.array[s+e])}}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else{if(t.interleavedBuffers===undefined){t.interleavedBuffers={}}if(t.interleavedBuffers[this.data.uuid]===undefined){t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)}return{isInterleavedBufferAttribute:true,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}}class rU extends nF{constructor(t){super();this.isSpriteMaterial=true;this.type="SpriteMaterial";this.color=new nE(0xffffff);this.map=null;this.alphaMap=null;this.rotation=0;this.sizeAttenuation=true;this.transparent=true;this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.color.copy(t.color);this.map=t.map;this.alphaMap=t.alphaMap;this.rotation=t.rotation;this.sizeAttenuation=t.sizeAttenuation;this.fog=t.fog;return this}}let rD;const rH=new iM;const rq=new iM;const rJ=new iM;const rX=new sZ;const rY=new sZ;const rZ=new i$;const rG=new iM;const r$=new iM;const rQ=new iM;const rK=new sZ;const r0=new sZ;const r1=new sZ;class r2 extends nf{constructor(t=new rU){super();this.isSprite=true;this.type="Sprite";if(rD===undefined){rD=new n7;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);const e=new rL(t,5);rD.setIndex([0,1,2,0,2,3]);rD.setAttribute("position",new rW(e,3,0,false));rD.setAttribute("uv",new rW(e,2,3,false))}this.geometry=rD;this.material=t;this.center=new sZ(.5,.5)}raycast(t,e){if(t.camera===null){console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.')}rq.setFromMatrixScale(this.matrixWorld);rZ.copy(t.camera.matrixWorld);this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld);rJ.setFromMatrixPosition(this.modelViewMatrix);if(t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===false){rq.multiplyScalar(-rJ.z)}const s=this.material.rotation;let i,n;if(s!==0){n=Math.cos(s);i=Math.sin(s)}const r=this.center;r3(rG.set(-.5,-.5,0),rJ,r,rq,i,n);r3(r$.set(.5,-.5,0),rJ,r,rq,i,n);r3(rQ.set(.5,.5,0),rJ,r,rq,i,n);rK.set(0,0);r0.set(1,0);r1.set(1,1);let o=t.ray.intersectTriangle(rG,r$,rQ,false,rH);if(o===null){r3(r$.set(-.5,.5,0),rJ,r,rq,i,n);r0.set(0,1);o=t.ray.intersectTriangle(rG,rQ,r$,false,rH);if(o===null){return}}const a=t.ray.origin.distanceTo(rH);if(a<t.near||a>t.far)return;e.push({distance:a,point:rH.clone(),uv:nI.getInterpolation(rH,rG,r$,rQ,rK,r0,r1,new sZ),face:null,object:this})}copy(t,e){super.copy(t,e);if(t.center!==undefined)this.center.copy(t.center);this.material=t.material;return this}}function r3(t,e,s,i,n,r){rX.subVectors(t,s).addScalar(.5).multiply(i);if(n!==undefined){rY.x=r*rX.x-n*rX.y;rY.y=n*rX.x+r*rX.y}else{rY.copy(rX)}t.copy(e);t.x+=rY.x;t.y+=rY.y;t.applyMatrix4(rZ)}const r5=new iM;const r4=new iM;class r6 extends nf{constructor(){super();this.isLOD=true;this._currentLevel=0;this.type="LOD";Object.defineProperties(this,{levels:{enumerable:true,value:[]}});this.autoUpdate=true}copy(t){super.copy(t,false);const e=t.levels;for(let t=0,s=e.length;t<s;t++){const s=e[t];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}this.autoUpdate=t.autoUpdate;return this}addLevel(t,e=0,s=0){e=Math.abs(e);const i=this.levels;let n;for(n=0;n<i.length;n++){if(e<i[n].distance){break}}i.splice(n,0,{distance:e,hysteresis:s,object:t});this.add(t);return this}removeLevel(t){const e=this.levels;for(let s=0;s<e.length;s++){if(e[s].distance===t){const t=e.splice(s,1);this.remove(t[0].object);return true}}return false}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const e=this.levels;if(e.length>0){let s,i;for(s=1,i=e.length;s<i;s++){let i=e[s].distance;if(e[s].object.visible){i-=i*e[s].hysteresis}if(t<i){break}}return e[s-1].object}return null}raycast(t,e){const s=this.levels;if(s.length>0){r5.setFromMatrixPosition(this.matrixWorld);const s=t.ray.origin.distanceTo(r5);this.getObjectForDistance(s).raycast(t,e)}}update(t){const e=this.levels;if(e.length>1){r5.setFromMatrixPosition(t.matrixWorld);r4.setFromMatrixPosition(this.matrixWorld);const s=r5.distanceTo(r4)/t.zoom;e[0].object.visible=true;let i,n;for(i=1,n=e.length;i<n;i++){let t=e[i].distance;if(e[i].object.visible){t-=t*e[i].hysteresis}if(s>=t){e[i-1].object.visible=false;e[i].object.visible=true}else{break}}this._currentLevel=i-1;for(;i<n;i++){e[i].object.visible=false}}}toJSON(t){const e=super.toJSON(t);if(this.autoUpdate===false)e.object.autoUpdate=false;e.object.levels=[];const s=this.levels;for(let t=0,i=s.length;t<i;t++){const i=s[t];e.object.levels.push({object:i.object.uuid,distance:i.distance,hysteresis:i.hysteresis})}return e}}const r8=new iM;const r9=new id;const r7=new id;const ot=new iM;const oe=new i$;const os=new iM;const oi=new iU;const on=new i$;const or=new iG;class oo extends ru{constructor(t,e){super(t,e);this.isSkinnedMesh=true;this.type="SkinnedMesh";this.bindMode=th;this.bindMatrix=new i$;this.bindMatrixInverse=new i$;this.boundingBox=null;this.boundingSphere=null}computeBoundingBox(){const t=this.geometry;if(this.boundingBox===null){this.boundingBox=new i_}this.boundingBox.makeEmpty();const e=t.getAttribute("position");for(let t=0;t<e.count;t++){this.getVertexPosition(t,os);this.boundingBox.expandByPoint(os)}}computeBoundingSphere(){const t=this.geometry;if(this.boundingSphere===null){this.boundingSphere=new iU}this.boundingSphere.makeEmpty();const e=t.getAttribute("position");for(let t=0;t<e.count;t++){this.getVertexPosition(t,os);this.boundingSphere.expandByPoint(os)}}copy(t,e){super.copy(t,e);this.bindMode=t.bindMode;this.bindMatrix.copy(t.bindMatrix);this.bindMatrixInverse.copy(t.bindMatrixInverse);this.skeleton=t.skeleton;if(t.boundingBox!==null)this.boundingBox=t.boundingBox.clone();if(t.boundingSphere!==null)this.boundingSphere=t.boundingSphere.clone();return this}raycast(t,e){const s=this.material;const i=this.matrixWorld;if(s===undefined)return;if(this.boundingSphere===null)this.computeBoundingSphere();oi.copy(this.boundingSphere);oi.applyMatrix4(i);if(t.ray.intersectsSphere(oi)===false)return;on.copy(i).invert();or.copy(t.ray).applyMatrix4(on);if(this.boundingBox!==null){if(or.intersectsBox(this.boundingBox)===false)return}this._computeIntersections(t,e,or)}getVertexPosition(t,e){super.getVertexPosition(t,e);this.applyBoneTransform(t,e);return e}bind(t,e){this.skeleton=t;if(e===undefined){this.updateMatrixWorld(true);this.skeleton.calculateInverses();e=this.matrixWorld}this.bindMatrix.copy(e);this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new id;const e=this.geometry.attributes.skinWeight;for(let s=0,i=e.count;s<i;s++){t.fromBufferAttribute(e,s);const i=1/t.manhattanLength();if(i!==Infinity){t.multiplyScalar(i)}else{t.set(1,0,0,0)}e.setXYZW(s,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t);if(this.bindMode===th){this.bindMatrixInverse.copy(this.matrixWorld).invert()}else if(this.bindMode===tc){this.bindMatrixInverse.copy(this.bindMatrix).invert()}else{console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}}applyBoneTransform(t,e){const s=this.skeleton;const i=this.geometry;r9.fromBufferAttribute(i.attributes.skinIndex,t);r7.fromBufferAttribute(i.attributes.skinWeight,t);r8.copy(e).applyMatrix4(this.bindMatrix);e.set(0,0,0);for(let t=0;t<4;t++){const i=r7.getComponent(t);if(i!==0){const n=r9.getComponent(t);oe.multiplyMatrices(s.bones[n].matrixWorld,s.boneInverses[n]);e.addScaledVector(ot.copy(r8).applyMatrix4(oe),i)}}return e.applyMatrix4(this.bindMatrixInverse)}}class oa extends nf{constructor(){super();this.isBone=true;this.type="Bone"}}class oh extends iu{constructor(t=null,e=1,s=1,i,n,r,o,a,h=tb,c=tb,l,u){super(null,r,o,a,h,c,i,n,l,u);this.isDataTexture=true;this.image={data:t,width:e,height:s};this.generateMipmaps=false;this.flipY=false;this.unpackAlignment=1}}const oc=new i$;const ol=new i$;class ou{constructor(t=[],e=[]){this.uuid=sT();this.bones=t.slice(0);this.boneInverses=e;this.boneMatrices=null;this.boneTexture=null;this.init()}init(){const t=this.bones;const e=this.boneInverses;this.boneMatrices=new Float32Array(t.length*16);if(e.length===0){this.calculateInverses()}else{if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.");this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++){this.boneInverses.push(new i$)}}}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new i$;if(this.bones[t]){e.copy(this.bones[t].matrixWorld).invert()}this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];if(e){e.matrixWorld.copy(this.boneInverses[t]).invert()}}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];if(e){if(e.parent&&e.parent.isBone){e.matrix.copy(e.parent.matrixWorld).invert();e.matrix.multiply(e.matrixWorld)}else{e.matrix.copy(e.matrixWorld)}e.matrix.decompose(e.position,e.quaternion,e.scale)}}}update(){const t=this.bones;const e=this.boneInverses;const s=this.boneMatrices;const i=this.boneTexture;for(let i=0,n=t.length;i<n;i++){const n=t[i]?t[i].matrixWorld:ol;oc.multiplyMatrices(n,e[i]);oc.toArray(s,i*16)}if(i!==null){i.needsUpdate=true}}clone(){return new ou(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=Math.ceil(t/4)*4;t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const s=new oh(e,t,t,tD,tO);s.needsUpdate=true;this.boneMatrices=e;this.boneTexture=s;return this}getBoneByName(t){for(let e=0,s=this.bones.length;e<s;e++){const s=this.bones[e];if(s.name===t){return s}}return undefined}dispose(){if(this.boneTexture!==null){this.boneTexture.dispose();this.boneTexture=null}}fromJSON(t,e){this.uuid=t.uuid;for(let s=0,i=t.bones.length;s<i;s++){const i=t.bones[s];let n=e[i];if(n===undefined){console.warn("THREE.Skeleton: No bone found with UUID:",i);n=new oa}this.bones.push(n);this.boneInverses.push(new i$().fromArray(t.boneInverses[s]))}this.init();return this}toJSON(){const t={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones;const s=this.boneInverses;for(let i=0,n=e.length;i<n;i++){const n=e[i];t.bones.push(n.uuid);const r=s[i];t.boneInverses.push(r.toArray())}return t}}class od extends nJ{constructor(t,e,s,i=1){super(t,e,s);this.isInstancedBufferAttribute=true;this.meshPerAttribute=i}copy(t){super.copy(t);this.meshPerAttribute=t.meshPerAttribute;return this}toJSON(){const t=super.toJSON();t.meshPerAttribute=this.meshPerAttribute;t.isInstancedBufferAttribute=true;return t}}const op=new i$;const of=new i$;const om=[];const oy=new i_;const og=new i$;const ox=new ru;const ob=new iU;class ow extends ru{constructor(t,e,s){super(t,e);this.isInstancedMesh=true;this.instanceMatrix=new od(new Float32Array(s*16),16);this.instanceColor=null;this.morphTexture=null;this.count=s;this.boundingBox=null;this.boundingSphere=null;for(let t=0;t<s;t++){this.setMatrixAt(t,og)}}computeBoundingBox(){const t=this.geometry;const e=this.count;if(this.boundingBox===null){this.boundingBox=new i_}if(t.boundingBox===null){t.computeBoundingBox()}this.boundingBox.makeEmpty();for(let s=0;s<e;s++){this.getMatrixAt(s,op);oy.copy(t.boundingBox).applyMatrix4(op);this.boundingBox.union(oy)}}computeBoundingSphere(){const t=this.geometry;const e=this.count;if(this.boundingSphere===null){this.boundingSphere=new iU}if(t.boundingSphere===null){t.computeBoundingSphere()}this.boundingSphere.makeEmpty();for(let s=0;s<e;s++){this.getMatrixAt(s,op);ob.copy(t.boundingSphere).applyMatrix4(op);this.boundingSphere.union(ob)}}copy(t,e){super.copy(t,e);this.instanceMatrix.copy(t.instanceMatrix);if(t.morphTexture!==null)this.morphTexture=t.morphTexture.clone();if(t.instanceColor!==null)this.instanceColor=t.instanceColor.clone();this.count=t.count;if(t.boundingBox!==null)this.boundingBox=t.boundingBox.clone();if(t.boundingSphere!==null)this.boundingSphere=t.boundingSphere.clone();return this}getColorAt(t,e){e.fromArray(this.instanceColor.array,t*3)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,t*16)}getMorphAt(t,e){const s=e.morphTargetInfluences;const i=this.morphTexture.source.data.data;const n=s.length+1;const r=t*n+1;for(let t=0;t<s.length;t++){s[t]=i[r+t]}}raycast(t,e){const s=this.matrixWorld;const i=this.count;ox.geometry=this.geometry;ox.material=this.material;if(ox.material===undefined)return;if(this.boundingSphere===null)this.computeBoundingSphere();ob.copy(this.boundingSphere);ob.applyMatrix4(s);if(t.ray.intersectsSphere(ob)===false)return;for(let n=0;n<i;n++){this.getMatrixAt(n,op);of.multiplyMatrices(s,op);ox.matrixWorld=of;ox.raycast(t,om);for(let t=0,s=om.length;t<s;t++){const s=om[t];s.instanceId=n;s.object=this;e.push(s)}om.length=0}}setColorAt(t,e){if(this.instanceColor===null){this.instanceColor=new od(new Float32Array(this.instanceMatrix.count*3).fill(1),3)}e.toArray(this.instanceColor.array,t*3)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,t*16)}setMorphAt(t,e){const s=e.morphTargetInfluences;const i=s.length+1;if(this.morphTexture===null){this.morphTexture=new oh(new Float32Array(i*this.count),i,this.count,tJ,tO)}const n=this.morphTexture.source.data.data;let r=0;for(let t=0;t<s.length;t++){r+=s[t]}const o=this.geometry.morphTargetsRelative?1:1-r;const a=i*t;n[a]=o;n.set(s,a+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"});if(this.morphTexture!==null){this.morphTexture.dispose();this.morphTexture=null}}}const oM=new iM;const ov=new iM;const oS=new sG;class o_{constructor(t=new iM(1,0,0),e=0){this.isPlane=true;this.normal=t;this.constant=e}set(t,e){this.normal.copy(t);this.constant=e;return this}setComponents(t,e,s,i){this.normal.set(t,e,s);this.constant=i;return this}setFromNormalAndCoplanarPoint(t,e){this.normal.copy(t);this.constant=-e.dot(this.normal);return this}setFromCoplanarPoints(t,e,s){const i=oM.subVectors(s,e).cross(ov.subVectors(t,e)).normalize();this.setFromNormalAndCoplanarPoint(i,t);return this}copy(t){this.normal.copy(t.normal);this.constant=t.constant;return this}normalize(){const t=1/this.normal.length();this.normal.multiplyScalar(t);this.constant*=t;return this}negate(){this.constant*=-1;this.normal.negate();return this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const s=t.delta(oM);const i=this.normal.dot(s);if(i===0){if(this.distanceToPoint(t.start)===0){return e.copy(t.start)}return null}const n=-(t.start.dot(this.normal)+this.constant)/i;if(n<0||n>1){return null}return e.copy(t.start).addScaledVector(s,n)}intersectsLine(t){const e=this.distanceToPoint(t.start);const s=this.distanceToPoint(t.end);return e<0&&s>0||s<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const s=e||oS.getNormalMatrix(t);const i=this.coplanarPoint(oM).applyMatrix4(t);const n=this.normal.applyMatrix3(s).normalize();this.constant=-i.dot(n);return this}translate(t){this.constant-=t.dot(this.normal);return this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const oA=new iU;const oT=new iM;class oz{constructor(t=new o_,e=new o_,s=new o_,i=new o_,n=new o_,r=new o_){this.planes=[t,e,s,i,n,r]}set(t,e,s,i,n,r){const o=this.planes;o[0].copy(t);o[1].copy(e);o[2].copy(s);o[3].copy(i);o[4].copy(n);o[5].copy(r);return this}copy(t){const e=this.planes;for(let s=0;s<6;s++){e[s].copy(t.planes[s])}return this}setFromProjectionMatrix(t,e=sy){const s=this.planes;const i=t.elements;const n=i[0],r=i[1],o=i[2],a=i[3];const h=i[4],c=i[5],l=i[6],u=i[7];const d=i[8],p=i[9],f=i[10],m=i[11];const y=i[12],g=i[13],x=i[14],b=i[15];s[0].setComponents(a-n,u-h,m-d,b-y).normalize();s[1].setComponents(a+n,u+h,m+d,b+y).normalize();s[2].setComponents(a+r,u+c,m+p,b+g).normalize();s[3].setComponents(a-r,u-c,m-p,b-g).normalize();s[4].setComponents(a-o,u-l,m-f,b-x).normalize();if(e===sy){s[5].setComponents(a+o,u+l,m+f,b+x).normalize()}else if(e===sg){s[5].setComponents(o,l,f,x).normalize()}else{throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e)}return this}intersectsObject(t){if(t.boundingSphere!==undefined){if(t.boundingSphere===null)t.computeBoundingSphere();oA.copy(t.boundingSphere).applyMatrix4(t.matrixWorld)}else{const e=t.geometry;if(e.boundingSphere===null)e.computeBoundingSphere();oA.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(oA)}intersectsSprite(t){oA.center.set(0,0,0);oA.radius=.7071067811865476;oA.applyMatrix4(t.matrixWorld);return this.intersectsSphere(oA)}intersectsSphere(t){const e=this.planes;const s=t.center;const i=-t.radius;for(let t=0;t<6;t++){const n=e[t].distanceToPoint(s);if(n<i){return false}}return true}intersectsBox(t){const e=this.planes;for(let s=0;s<6;s++){const i=e[s];oT.x=i.normal.x>0?t.max.x:t.min.x;oT.y=i.normal.y>0?t.max.y:t.min.y;oT.z=i.normal.z>0?t.max.z:t.min.z;if(i.distanceToPoint(oT)<0){return false}}return true}containsPoint(t){const e=this.planes;for(let s=0;s<6;s++){if(e[s].distanceToPoint(t)<0){return false}}return true}clone(){return new this.constructor().copy(this)}}const oI=new i$;const oC=new oz;class oB{constructor(){this.coordinateSystem=sy}intersectsObject(t,e){if(!e.isArrayCamera||e.cameras.length===0){return false}for(let s=0;s<e.cameras.length;s++){const i=e.cameras[s];oI.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse);oC.setFromProjectionMatrix(oI,this.coordinateSystem);if(oC.intersectsObject(t)){return true}}return false}intersectsSprite(t,e){if(!e||!e.cameras||e.cameras.length===0){return false}for(let s=0;s<e.cameras.length;s++){const i=e.cameras[s];oI.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse);oC.setFromProjectionMatrix(oI,this.coordinateSystem);if(oC.intersectsSprite(t)){return true}}return false}intersectsSphere(t,e){if(!e||!e.cameras||e.cameras.length===0){return false}for(let s=0;s<e.cameras.length;s++){const i=e.cameras[s];oI.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse);oC.setFromProjectionMatrix(oI,this.coordinateSystem);if(oC.intersectsSphere(t)){return true}}return false}intersectsBox(t,e){if(!e||!e.cameras||e.cameras.length===0){return false}for(let s=0;s<e.cameras.length;s++){const i=e.cameras[s];oI.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse);oC.setFromProjectionMatrix(oI,this.coordinateSystem);if(oC.intersectsBox(t)){return true}}return false}containsPoint(t,e){if(!e||!e.cameras||e.cameras.length===0){return false}for(let s=0;s<e.cameras.length;s++){const i=e.cameras[s];oI.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse);oC.setFromProjectionMatrix(oI,this.coordinateSystem);if(oC.containsPoint(t)){return true}}return false}clone(){return new oB}}function ok(t,e){return t-e}function oR(t,e){return t.z-e.z}function oE(t,e){return e.z-t.z}class oP{constructor(){this.index=0;this.pool=[];this.list=[]}push(t,e,s,i){const n=this.pool;const r=this.list;if(this.index>=n.length){n.push({start:-1,count:-1,z:-1,index:-1})}const o=n[this.index];r.push(o);this.index++;o.start=t;o.count=e;o.z=s;o.index=i}reset(){this.list.length=0;this.index=0}}const oO=new i$;const oF=new nE(1,1,1);const oN=new oz;const oV=new oB;const oL=new i_;const oj=new iU;const oW=new iM;const oU=new iM;const oD=new iM;const oH=new oP;const oq=new ru;const oJ=[];function oX(t,e,s=0){const i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const n=t.count;for(let r=0;r<n;r++){for(let n=0;n<i;n++){e.setComponent(r+s,n,t.getComponent(r,n))}}}else{e.array.set(t.array,s*i)}e.needsUpdate=true}function oY(t,e){if(t.constructor!==e.constructor){const s=Math.min(t.length,e.length);for(let i=0;i<s;i++){e[i]=t[i]}}else{const s=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,s))}}class oZ extends ru{constructor(t,e,s=e*2,i){super(new n7,i);this.isBatchedMesh=true;this.perObjectFrustumCulled=true;this.sortObjects=true;this.boundingBox=null;this.boundingSphere=null;this.customSort=null;this._instanceInfo=[];this._geometryInfo=[];this._availableInstanceIds=[];this._availableGeometryIds=[];this._nextIndexStart=0;this._nextVertexStart=0;this._geometryCount=0;this._visibilityChanged=true;this._geometryInitialized=false;this._maxInstanceCount=t;this._maxVertexCount=e;this._maxIndexCount=s;this._multiDrawCounts=new Int32Array(t);this._multiDrawStarts=new Int32Array(t);this._multiDrawCount=0;this._multiDrawInstances=null;this._matricesTexture=null;this._indirectTexture=null;this._colorsTexture=null;this._initMatricesTexture();this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let t=Math.sqrt(this._maxInstanceCount*4);t=Math.ceil(t/4)*4;t=Math.max(t,4);const e=new Float32Array(t*t*4);const s=new oh(e,t,t,tD,tO);this._matricesTexture=s}_initIndirectTexture(){let t=Math.sqrt(this._maxInstanceCount);t=Math.ceil(t);const e=new Uint32Array(t*t);const s=new oh(e,t,t,tX,tP);this._indirectTexture=s}_initColorsTexture(){let t=Math.sqrt(this._maxInstanceCount);t=Math.ceil(t);const e=new Float32Array(t*t*4).fill(1);const s=new oh(e,t,t,tD,tO);s.colorSpace=ie.workingColorSpace;this._colorsTexture=s}_initializeGeometry(t){const e=this.geometry;const s=this._maxVertexCount;const i=this._maxIndexCount;if(this._geometryInitialized===false){for(const i in t.attributes){const n=t.getAttribute(i);const{array:r,itemSize:o,normalized:a}=n;const h=new r.constructor(s*o);const c=new nJ(h,o,a);e.setAttribute(i,c)}if(t.getIndex()!==null){const t=s>65535?new Uint32Array(i):new Uint16Array(i);e.setIndex(new nJ(t,1))}this._geometryInitialized=true}}_validateGeometry(t){const e=this.geometry;if(Boolean(t.getIndex())!==Boolean(e.getIndex())){throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".')}for(const s in e.attributes){if(!t.hasAttribute(s)){throw new Error(`THREE.BatchedMesh: Added geometry missing "${s}". All geometries must have consistent attributes.`)}const i=t.getAttribute(s);const n=e.getAttribute(s);if(i.itemSize!==n.itemSize||i.normalized!==n.normalized){throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}}validateInstanceId(t){const e=this._instanceInfo;if(t<0||t>=e.length||e[t].active===false){throw new Error(`THREE.BatchedMesh: Invalid instanceId ${t}. Instance is either out of range or has been deleted.`)}}validateGeometryId(t){const e=this._geometryInfo;if(t<0||t>=e.length||e[t].active===false){throw new Error(`THREE.BatchedMesh: Invalid geometryId ${t}. Geometry is either out of range or has been deleted.`)}}setCustomSort(t){this.customSort=t;return this}computeBoundingBox(){if(this.boundingBox===null){this.boundingBox=new i_}const t=this.boundingBox;const e=this._instanceInfo;t.makeEmpty();for(let s=0,i=e.length;s<i;s++){if(e[s].active===false)continue;const i=e[s].geometryIndex;this.getMatrixAt(s,oO);this.getBoundingBoxAt(i,oL).applyMatrix4(oO);t.union(oL)}}computeBoundingSphere(){if(this.boundingSphere===null){this.boundingSphere=new iU}const t=this.boundingSphere;const e=this._instanceInfo;t.makeEmpty();for(let s=0,i=e.length;s<i;s++){if(e[s].active===false)continue;const i=e[s].geometryIndex;this.getMatrixAt(s,oO);this.getBoundingSphereAt(i,oj).applyMatrix4(oO);t.union(oj)}}addInstance(t){const e=this._instanceInfo.length>=this.maxInstanceCount;if(e&&this._availableInstanceIds.length===0){throw new Error("THREE.BatchedMesh: Maximum item count reached.")}const s={visible:true,active:true,geometryIndex:t};let i=null;if(this._availableInstanceIds.length>0){this._availableInstanceIds.sort(ok);i=this._availableInstanceIds.shift();this._instanceInfo[i]=s}else{i=this._instanceInfo.length;this._instanceInfo.push(s)}const n=this._matricesTexture;oO.identity().toArray(n.image.data,i*16);n.needsUpdate=true;const r=this._colorsTexture;if(r){oF.toArray(r.image.data,i*4);r.needsUpdate=true}this._visibilityChanged=true;return i}addGeometry(t,e=-1,s=-1){this._initializeGeometry(t);this._validateGeometry(t);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:true};const n=this._geometryInfo;i.vertexStart=this._nextVertexStart;i.reservedVertexCount=e===-1?t.getAttribute("position").count:e;const r=t.getIndex();const o=r!==null;if(o){i.indexStart=this._nextIndexStart;i.reservedIndexCount=s===-1?r.count:s}if(i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount){throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.")}let a;if(this._availableGeometryIds.length>0){this._availableGeometryIds.sort(ok);a=this._availableGeometryIds.shift();n[a]=i}else{a=this._geometryCount;this._geometryCount++;n.push(i)}this.setGeometryAt(a,t);this._nextIndexStart=i.indexStart+i.reservedIndexCount;this._nextVertexStart=i.vertexStart+i.reservedVertexCount;return a}setGeometryAt(t,e){if(t>=this._geometryCount){throw new Error("THREE.BatchedMesh: Maximum geometry count reached.")}this._validateGeometry(e);const s=this.geometry;const i=s.getIndex()!==null;const n=s.getIndex();const r=e.getIndex();const o=this._geometryInfo[t];if(i&&r.count>o.reservedIndexCount||e.attributes.position.count>o.reservedVertexCount){throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.")}const a=o.vertexStart;const h=o.reservedVertexCount;o.vertexCount=e.getAttribute("position").count;for(const t in s.attributes){const i=e.getAttribute(t);const n=s.getAttribute(t);oX(i,n,a);const r=i.itemSize;for(let t=i.count,e=h;t<e;t++){const e=a+t;for(let t=0;t<r;t++){n.setComponent(e,t,0)}}n.needsUpdate=true;n.addUpdateRange(a*r,h*r)}if(i){const t=o.indexStart;const s=o.reservedIndexCount;o.indexCount=e.getIndex().count;for(let e=0;e<r.count;e++){n.setX(t+e,a+r.getX(e))}for(let e=r.count,i=s;e<i;e++){n.setX(t+e,a)}n.needsUpdate=true;n.addUpdateRange(t,o.reservedIndexCount)}o.start=i?o.indexStart:o.vertexStart;o.count=i?o.indexCount:o.vertexCount;o.boundingBox=null;if(e.boundingBox!==null){o.boundingBox=e.boundingBox.clone()}o.boundingSphere=null;if(e.boundingSphere!==null){o.boundingSphere=e.boundingSphere.clone()}this._visibilityChanged=true;return t}deleteGeometry(t){const e=this._geometryInfo;if(t>=e.length||e[t].active===false){return this}const s=this._instanceInfo;for(let e=0,i=s.length;e<i;e++){if(s[e].active&&s[e].geometryIndex===t){this.deleteInstance(e)}}e[t].active=false;this._availableGeometryIds.push(t);this._visibilityChanged=true;return this}deleteInstance(t){this.validateInstanceId(t);this._instanceInfo[t].active=false;this._availableInstanceIds.push(t);this._visibilityChanged=true;return this}optimize(){let t=0;let e=0;const s=this._geometryInfo;const i=s.map((t,e)=>e).sort((t,e)=>{return s[t].vertexStart-s[e].vertexStart});const n=this.geometry;for(let r=0,o=s.length;r<o;r++){const o=i[r];const a=s[o];if(a.active===false){continue}if(n.index!==null){if(a.indexStart!==e){const{indexStart:s,vertexStart:i,reservedIndexCount:r}=a;const o=n.index;const h=o.array;const c=t-i;for(let t=s;t<s+r;t++){h[t]=h[t]+c}o.array.copyWithin(e,s,s+r);o.addUpdateRange(e,r);a.indexStart=e}e+=a.reservedIndexCount}if(a.vertexStart!==t){const{vertexStart:e,reservedVertexCount:s}=a;const i=n.attributes;for(const n in i){const r=i[n];const{array:o,itemSize:a}=r;o.copyWithin(t*a,e*a,(e+s)*a);r.addUpdateRange(t*a,s*a)}a.vertexStart=t}t+=a.reservedVertexCount;a.start=n.index?a.indexStart:a.vertexStart;this._nextIndexStart=n.index?a.indexStart+a.reservedIndexCount:0;this._nextVertexStart=a.vertexStart+a.reservedVertexCount}return this}getBoundingBoxAt(t,e){if(t>=this._geometryCount){return null}const s=this.geometry;const i=this._geometryInfo[t];if(i.boundingBox===null){const t=new i_;const e=s.index;const n=s.attributes.position;for(let s=i.start,r=i.start+i.count;s<r;s++){let i=s;if(e){i=e.getX(i)}t.expandByPoint(oW.fromBufferAttribute(n,i))}i.boundingBox=t}e.copy(i.boundingBox);return e}getBoundingSphereAt(t,e){if(t>=this._geometryCount){return null}const s=this.geometry;const i=this._geometryInfo[t];if(i.boundingSphere===null){const e=new iU;this.getBoundingBoxAt(t,oL);oL.getCenter(e.center);const n=s.index;const r=s.attributes.position;let o=0;for(let t=i.start,s=i.start+i.count;t<s;t++){let s=t;if(n){s=n.getX(s)}oW.fromBufferAttribute(r,s);o=Math.max(o,e.center.distanceToSquared(oW))}e.radius=Math.sqrt(o);i.boundingSphere=e}e.copy(i.boundingSphere);return e}setMatrixAt(t,e){this.validateInstanceId(t);const s=this._matricesTexture;const i=this._matricesTexture.image.data;e.toArray(i,t*16);s.needsUpdate=true;return this}getMatrixAt(t,e){this.validateInstanceId(t);return e.fromArray(this._matricesTexture.image.data,t*16)}setColorAt(t,e){this.validateInstanceId(t);if(this._colorsTexture===null){this._initColorsTexture()}e.toArray(this._colorsTexture.image.data,t*4);this._colorsTexture.needsUpdate=true;return this}getColorAt(t,e){this.validateInstanceId(t);return e.fromArray(this._colorsTexture.image.data,t*4)}setVisibleAt(t,e){this.validateInstanceId(t);if(this._instanceInfo[t].visible===e){return this}this._instanceInfo[t].visible=e;this._visibilityChanged=true;return this}getVisibleAt(t){this.validateInstanceId(t);return this._instanceInfo[t].visible}setGeometryIdAt(t,e){this.validateInstanceId(t);this.validateGeometryId(e);this._instanceInfo[t].geometryIndex=e;return this}getGeometryIdAt(t){this.validateInstanceId(t);return this._instanceInfo[t].geometryIndex}getGeometryRangeAt(t,e={}){this.validateGeometryId(t);const s=this._geometryInfo[t];e.vertexStart=s.vertexStart;e.vertexCount=s.vertexCount;e.reservedVertexCount=s.reservedVertexCount;e.indexStart=s.indexStart;e.indexCount=s.indexCount;e.reservedIndexCount=s.reservedIndexCount;e.start=s.start;e.count=s.count;return e}setInstanceCount(t){const e=this._availableInstanceIds;const s=this._instanceInfo;e.sort(ok);while(e[e.length-1]===s.length){s.pop();e.pop()}if(t<s.length){throw new Error(`BatchedMesh: Instance ids outside the range ${t} are being used. Cannot shrink instance count.`)}const i=new Int32Array(t);const n=new Int32Array(t);oY(this._multiDrawCounts,i);oY(this._multiDrawStarts,n);this._multiDrawCounts=i;this._multiDrawStarts=n;this._maxInstanceCount=t;const r=this._indirectTexture;const o=this._matricesTexture;const a=this._colorsTexture;r.dispose();this._initIndirectTexture();oY(r.image.data,this._indirectTexture.image.data);o.dispose();this._initMatricesTexture();oY(o.image.data,this._matricesTexture.image.data);if(a){a.dispose();this._initColorsTexture();oY(a.image.data,this._colorsTexture.image.data)}}setGeometrySize(t,e){const s=[...this._geometryInfo].filter(t=>t.active);const i=Math.max(...s.map(t=>t.vertexStart+t.reservedVertexCount));if(i>t){throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${e}. Cannot shrink further.`)}if(this.geometry.index){const t=Math.max(...s.map(t=>t.indexStart+t.reservedIndexCount));if(t>e){throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${e}. Cannot shrink further.`)}}const n=this.geometry;n.dispose();this._maxVertexCount=t;this._maxIndexCount=e;if(this._geometryInitialized){this._geometryInitialized=false;this.geometry=new n7;this._initializeGeometry(n)}const r=this.geometry;if(n.index){oY(n.index.array,r.index.array)}for(const t in n.attributes){oY(n.attributes[t].array,r.attributes[t].array)}}raycast(t,e){const s=this._instanceInfo;const i=this._geometryInfo;const n=this.matrixWorld;const r=this.geometry;oq.material=this.material;oq.geometry.index=r.index;oq.geometry.attributes=r.attributes;if(oq.geometry.boundingBox===null){oq.geometry.boundingBox=new i_}if(oq.geometry.boundingSphere===null){oq.geometry.boundingSphere=new iU}for(let r=0,o=s.length;r<o;r++){if(!s[r].visible||!s[r].active){continue}const o=s[r].geometryIndex;const a=i[o];oq.geometry.setDrawRange(a.start,a.count);this.getMatrixAt(r,oq.matrixWorld).premultiply(n);this.getBoundingBoxAt(o,oq.geometry.boundingBox);this.getBoundingSphereAt(o,oq.geometry.boundingSphere);oq.raycast(t,oJ);for(let t=0,s=oJ.length;t<s;t++){const s=oJ[t];s.object=this;s.batchId=r;e.push(s)}oJ.length=0}oq.material=null;oq.geometry.index=null;oq.geometry.attributes={};oq.geometry.setDrawRange(0,Infinity)}copy(t){super.copy(t);this.geometry=t.geometry.clone();this.perObjectFrustumCulled=t.perObjectFrustumCulled;this.sortObjects=t.sortObjects;this.boundingBox=t.boundingBox!==null?t.boundingBox.clone():null;this.boundingSphere=t.boundingSphere!==null?t.boundingSphere.clone():null;this._geometryInfo=t._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null}));this._instanceInfo=t._instanceInfo.map(t=>({...t}));this._availableInstanceIds=t._availableInstanceIds.slice();this._availableGeometryIds=t._availableGeometryIds.slice();this._nextIndexStart=t._nextIndexStart;this._nextVertexStart=t._nextVertexStart;this._geometryCount=t._geometryCount;this._maxInstanceCount=t._maxInstanceCount;this._maxVertexCount=t._maxVertexCount;this._maxIndexCount=t._maxIndexCount;this._geometryInitialized=t._geometryInitialized;this._multiDrawCounts=t._multiDrawCounts.slice();this._multiDrawStarts=t._multiDrawStarts.slice();this._indirectTexture=t._indirectTexture.clone();this._indirectTexture.image.data=this._indirectTexture.image.data.slice();this._matricesTexture=t._matricesTexture.clone();this._matricesTexture.image.data=this._matricesTexture.image.data.slice();if(this._colorsTexture!==null){this._colorsTexture=t._colorsTexture.clone();this._colorsTexture.image.data=this._colorsTexture.image.data.slice()}return this}dispose(){this.geometry.dispose();this._matricesTexture.dispose();this._matricesTexture=null;this._indirectTexture.dispose();this._indirectTexture=null;if(this._colorsTexture!==null){this._colorsTexture.dispose();this._colorsTexture=null}}onBeforeRender(t,e,s,i,n){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects){return}const r=i.getIndex();const o=r===null?1:r.array.BYTES_PER_ELEMENT;const a=this._instanceInfo;const h=this._multiDrawStarts;const c=this._multiDrawCounts;const l=this._geometryInfo;const u=this.perObjectFrustumCulled;const d=this._indirectTexture;const p=d.image.data;const f=s.isArrayCamera?oV:oN;if(u&&!s.isArrayCamera){oO.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse).multiply(this.matrixWorld);oN.setFromProjectionMatrix(oO,t.coordinateSystem)}let m=0;if(this.sortObjects){oO.copy(this.matrixWorld).invert();oW.setFromMatrixPosition(s.matrixWorld).applyMatrix4(oO);oU.set(0,0,-1).transformDirection(s.matrixWorld).transformDirection(oO);for(let t=0,e=a.length;t<e;t++){if(a[t].visible&&a[t].active){const e=a[t].geometryIndex;this.getMatrixAt(t,oO);this.getBoundingSphereAt(e,oj).applyMatrix4(oO);let i=false;if(u){i=!f.intersectsSphere(oj,s)}if(!i){const s=l[e];const i=oD.subVectors(oj.center,oW).dot(oU);oH.push(s.start,s.count,i,t)}}}const t=oH.list;const e=this.customSort;if(e===null){t.sort(n.transparent?oE:oR)}else{e.call(this,t,s)}for(let e=0,s=t.length;e<s;e++){const s=t[e];h[m]=s.start*o;c[m]=s.count;p[m]=s.index;m++}oH.reset()}else{for(let t=0,e=a.length;t<e;t++){if(a[t].visible&&a[t].active){const e=a[t].geometryIndex;let i=false;if(u){this.getMatrixAt(t,oO);this.getBoundingSphereAt(e,oj).applyMatrix4(oO);i=!f.intersectsSphere(oj,s)}if(!i){const s=l[e];h[m]=s.start*o;c[m]=s.count;p[m]=t;m++}}}}d.needsUpdate=true;this._multiDrawCount=m;this._visibilityChanged=false}onBeforeShadow(t,e,s,i,n,r){this.onBeforeRender(t,null,i,n,r)}}class oG extends nF{constructor(t){super();this.isLineBasicMaterial=true;this.type="LineBasicMaterial";this.color=new nE(0xffffff);this.map=null;this.linewidth=1;this.linecap="round";this.linejoin="round";this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.color.copy(t.color);this.map=t.map;this.linewidth=t.linewidth;this.linecap=t.linecap;this.linejoin=t.linejoin;this.fog=t.fog;return this}}const o$=new iM;const oQ=new iM;const oK=new i$;const o0=new iG;const o1=new iU;const o2=new iM;const o3=new iM;class o5 extends nf{constructor(t=new n7,e=new oG){super();this.isLine=true;this.type="Line";this.geometry=t;this.material=e;this.morphTargetDictionary=undefined;this.morphTargetInfluences=undefined;this.updateMorphTargets()}copy(t,e){super.copy(t,e);this.material=Array.isArray(t.material)?t.material.slice():t.material;this.geometry=t.geometry;return this}computeLineDistances(){const t=this.geometry;if(t.index===null){const e=t.attributes.position;const s=[0];for(let t=1,i=e.count;t<i;t++){o$.fromBufferAttribute(e,t-1);oQ.fromBufferAttribute(e,t);s[t]=s[t-1];s[t]+=o$.distanceTo(oQ)}t.setAttribute("lineDistance",new n1(s,1))}else{console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.")}return this}raycast(t,e){const s=this.geometry;const i=this.matrixWorld;const n=t.params.Line.threshold;const r=s.drawRange;if(s.boundingSphere===null)s.computeBoundingSphere();o1.copy(s.boundingSphere);o1.applyMatrix4(i);o1.radius+=n;if(t.ray.intersectsSphere(o1)===false)return;oK.copy(i).invert();o0.copy(t.ray).applyMatrix4(oK);const o=n/((this.scale.x+this.scale.y+this.scale.z)/3);const a=o*o;const h=this.isLineSegments?2:1;const c=s.index;const l=s.attributes;const u=l.position;if(c!==null){const s=Math.max(0,r.start);const i=Math.min(c.count,r.start+r.count);for(let n=s,r=i-1;n<r;n+=h){const s=c.getX(n);const i=c.getX(n+1);const r=o4(this,t,o0,a,s,i,n);if(r){e.push(r)}}if(this.isLineLoop){const n=c.getX(i-1);const r=c.getX(s);const o=o4(this,t,o0,a,n,r,i-1);if(o){e.push(o)}}}else{const s=Math.max(0,r.start);const i=Math.min(u.count,r.start+r.count);for(let n=s,r=i-1;n<r;n+=h){const s=o4(this,t,o0,a,n,n+1,n);if(s){e.push(s)}}if(this.isLineLoop){const n=o4(this,t,o0,a,i-1,s,i-1);if(n){e.push(n)}}}}updateMorphTargets(){const t=this.geometry;const e=t.morphAttributes;const s=Object.keys(e);if(s.length>0){const t=e[s[0]];if(t!==undefined){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let e=0,s=t.length;e<s;e++){const s=t[e].name||String(e);this.morphTargetInfluences.push(0);this.morphTargetDictionary[s]=e}}}}}function o4(t,e,s,i,n,r,o){const a=t.geometry.attributes.position;o$.fromBufferAttribute(a,n);oQ.fromBufferAttribute(a,r);const h=s.distanceSqToSegment(o$,oQ,o2,o3);if(h>i)return;o2.applyMatrix4(t.matrixWorld);const c=e.ray.origin.distanceTo(o2);if(c<e.near||c>e.far)return;return{distance:c,point:o3.clone().applyMatrix4(t.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:t}}const o6=new iM;const o8=new iM;class o9 extends o5{constructor(t,e){super(t,e);this.isLineSegments=true;this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.index===null){const e=t.attributes.position;const s=[];for(let t=0,i=e.count;t<i;t+=2){o6.fromBufferAttribute(e,t);o8.fromBufferAttribute(e,t+1);s[t]=t===0?0:s[t-1];s[t+1]=s[t]+o6.distanceTo(o8)}t.setAttribute("lineDistance",new n1(s,1))}else{console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.")}return this}}class o7 extends o5{constructor(t,e){super(t,e);this.isLineLoop=true;this.type="LineLoop"}}class at extends nF{constructor(t){super();this.isPointsMaterial=true;this.type="PointsMaterial";this.color=new nE(0xffffff);this.map=null;this.alphaMap=null;this.size=1;this.sizeAttenuation=true;this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.color.copy(t.color);this.map=t.map;this.alphaMap=t.alphaMap;this.size=t.size;this.sizeAttenuation=t.sizeAttenuation;this.fog=t.fog;return this}}const ae=new i$;const as=new iG;const ai=new iU;const an=new iM;class ar extends nf{constructor(t=new n7,e=new at){super();this.isPoints=true;this.type="Points";this.geometry=t;this.material=e;this.morphTargetDictionary=undefined;this.morphTargetInfluences=undefined;this.updateMorphTargets()}copy(t,e){super.copy(t,e);this.material=Array.isArray(t.material)?t.material.slice():t.material;this.geometry=t.geometry;return this}raycast(t,e){const s=this.geometry;const i=this.matrixWorld;const n=t.params.Points.threshold;const r=s.drawRange;if(s.boundingSphere===null)s.computeBoundingSphere();ai.copy(s.boundingSphere);ai.applyMatrix4(i);ai.radius+=n;if(t.ray.intersectsSphere(ai)===false)return;ae.copy(i).invert();as.copy(t.ray).applyMatrix4(ae);const o=n/((this.scale.x+this.scale.y+this.scale.z)/3);const a=o*o;const h=s.index;const c=s.attributes;const l=c.position;if(h!==null){const s=Math.max(0,r.start);const n=Math.min(h.count,r.start+r.count);for(let r=s,o=n;r<o;r++){const s=h.getX(r);an.fromBufferAttribute(l,s);ao(an,s,a,i,t,e,this)}}else{const s=Math.max(0,r.start);const n=Math.min(l.count,r.start+r.count);for(let r=s,o=n;r<o;r++){an.fromBufferAttribute(l,r);ao(an,r,a,i,t,e,this)}}}updateMorphTargets(){const t=this.geometry;const e=t.morphAttributes;const s=Object.keys(e);if(s.length>0){const t=e[s[0]];if(t!==undefined){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let e=0,s=t.length;e<s;e++){const s=t[e].name||String(e);this.morphTargetInfluences.push(0);this.morphTargetDictionary[s]=e}}}}}function ao(t,e,s,i,n,r,o){const a=as.distanceSqToPoint(t);if(a<s){const s=new iM;as.closestPointToPoint(t,s);s.applyMatrix4(i);const h=n.ray.origin.distanceTo(s);if(h<n.near||h>n.far)return;r.push({distance:h,distanceToRay:Math.sqrt(a),point:s,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class aa extends iu{constructor(t,e,s,i,n=t_,r=t_,o,a,h){super(t,e,s,i,n,r,o,a,h);this.isVideoTexture=true;this.generateMipmaps=false;const c=this;function l(){c.needsUpdate=true;t.requestVideoFrameCallback(l)}if("requestVideoFrameCallback"in t){t.requestVideoFrameCallback(l)}}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;const e="requestVideoFrameCallback"in t;if(e===false&&t.readyState>=t.HAVE_CURRENT_DATA){this.needsUpdate=true}}}class ah extends aa{constructor(t,e,s,i,n,r,o,a){super({},t,e,s,i,n,r,o,a);this.isVideoFrameTexture=true}update(){}clone(){return new this.constructor().copy(this)}setFrame(t){this.image=t;this.needsUpdate=true}}class ac extends iu{constructor(t,e){super({width:t,height:e});this.isFramebufferTexture=true;this.magFilter=tb;this.minFilter=tb;this.generateMipmaps=false;this.needsUpdate=true}}class al extends iu{constructor(t,e,s,i,n,r,o,a,h,c,l,u){super(null,r,o,a,h,c,i,n,l,u);this.isCompressedTexture=true;this.image={width:e,height:s};this.mipmaps=t;this.flipY=false;this.generateMipmaps=false}}class au extends al{constructor(t,e,s,i,n,r){super(t,e,s,n,r);this.isCompressedArrayTexture=true;this.image.depth=i;this.wrapR=tg;this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class ad extends al{constructor(t,e,s){super(undefined,t[0].width,t[0].height,e,s,tu);this.isCompressedCubeTexture=true;this.isCubeTexture=true;this.image=t}}class ap extends iu{constructor(t,e,s,i,n,r,o,a,h){super(t,e,s,i,n,r,o,a,h);this.isCanvasTexture=true;this.needsUpdate=true}}class af extends iu{constructor(t,e,s=tP,i,n,r,o=tb,a=tb,h,c=tH){if(c!==tH&&c!==tq){throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat")}super(null,i,n,r,o,a,c,s,h);this.isDepthTexture=true;this.image={width:t,height:e};this.flipY=false;this.generateMipmaps=false;this.compareFunction=null}copy(t){super.copy(t);this.source=new ih(Object.assign({},t.image));this.compareFunction=t.compareFunction;return this}toJSON(t){const e=super.toJSON(t);if(this.compareFunction!==null)e.compareFunction=this.compareFunction;return e}}class am extends af{constructor(t=1,e=1,s=1){super(t,e);this.isDepthArrayTexture=true;this.image={width:t,height:e,depth:s};this.flipY=false;this.generateMipmaps=false;this.compareFunction=null;this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class ay extends n7{constructor(t=1,e=1,s=4,i=8,n=1){super();this.type="CapsuleGeometry";this.parameters={radius:t,height:e,capSegments:s,radialSegments:i,heightSegments:n};e=Math.max(0,e);s=Math.max(1,Math.floor(s));i=Math.max(3,Math.floor(i));n=Math.max(1,Math.floor(n));const r=[];const o=[];const a=[];const h=[];const c=e/2;const l=Math.PI/2*t;const u=e;const d=2*l+u;const p=s*2+n;const f=i+1;const m=new iM;const y=new iM;for(let g=0;g<=p;g++){let x=0;let b=0;let w=0;let M=0;if(g<=s){const e=g/s;const i=e*Math.PI/2;b=-c-t*Math.cos(i);w=t*Math.sin(i);M=-t*Math.cos(i);x=e*l}else if(g<=s+n){const i=(g-s)/n;b=-c+i*e;w=t;M=0;x=l+i*u}else{const e=(g-s-n)/s;const i=e*Math.PI/2;b=c+t*Math.sin(i);w=t*Math.cos(i);M=t*Math.sin(i);x=l+u+e*l}const v=Math.max(0,Math.min(1,x/d));let S=0;if(g===0){S=.5/i}else if(g===p){S=-.5/i}for(let t=0;t<=i;t++){const e=t/i;const s=e*Math.PI*2;const n=Math.sin(s);const r=Math.cos(s);y.x=-w*r;y.y=b;y.z=w*n;o.push(y.x,y.y,y.z);m.set(-w*r,M,w*n);m.normalize();a.push(m.x,m.y,m.z);h.push(e+S,v)}if(g>0){const t=(g-1)*f;for(let e=0;e<i;e++){const s=t+e;const i=t+e+1;const n=g*f+e;const o=g*f+e+1;r.push(s,i,n);r.push(i,o,n)}}}this.setIndex(r);this.setAttribute("position",new n1(o,3));this.setAttribute("normal",new n1(a,3));this.setAttribute("uv",new n1(h,2))}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new ay(t.radius,t.height,t.capSegments,t.radialSegments,t.heightSegments)}}class ag extends n7{constructor(t=1,e=32,s=0,i=Math.PI*2){super();this.type="CircleGeometry";this.parameters={radius:t,segments:e,thetaStart:s,thetaLength:i};e=Math.max(3,e);const n=[];const r=[];const o=[];const a=[];const h=new iM;const c=new sZ;r.push(0,0,0);o.push(0,0,1);a.push(.5,.5);for(let n=0,l=3;n<=e;n++,l+=3){const u=s+n/e*i;h.x=t*Math.cos(u);h.y=t*Math.sin(u);r.push(h.x,h.y,h.z);o.push(0,0,1);c.x=(r[l]/t+1)/2;c.y=(r[l+1]/t+1)/2;a.push(c.x,c.y)}for(let t=1;t<=e;t++){n.push(t,t+1,0)}this.setIndex(n);this.setAttribute("position",new n1(r,3));this.setAttribute("normal",new n1(o,3));this.setAttribute("uv",new n1(a,2))}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new ag(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class ax extends n7{constructor(t=1,e=1,s=1,i=32,n=1,r=false,o=0,a=Math.PI*2){super();this.type="CylinderGeometry";this.parameters={radiusTop:t,radiusBottom:e,height:s,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a};const h=this;i=Math.floor(i);n=Math.floor(n);const c=[];const l=[];const u=[];const d=[];let p=0;const f=[];const m=s/2;let y=0;g();if(r===false){if(t>0)x(true);if(e>0)x(false)}this.setIndex(c);this.setAttribute("position",new n1(l,3));this.setAttribute("normal",new n1(u,3));this.setAttribute("uv",new n1(d,2));function g(){const r=new iM;const g=new iM;let x=0;const b=(e-t)/s;for(let h=0;h<=n;h++){const c=[];const y=h/n;const x=y*(e-t)+t;for(let t=0;t<=i;t++){const e=t/i;const n=e*a+o;const h=Math.sin(n);const f=Math.cos(n);g.x=x*h;g.y=-y*s+m;g.z=x*f;l.push(g.x,g.y,g.z);r.set(h,b,f).normalize();u.push(r.x,r.y,r.z);d.push(e,1-y);c.push(p++)}f.push(c)}for(let s=0;s<i;s++){for(let i=0;i<n;i++){const r=f[i][s];const o=f[i+1][s];const a=f[i+1][s+1];const h=f[i][s+1];if(t>0||i!==0){c.push(r,o,h);x+=3}if(e>0||i!==n-1){c.push(o,a,h);x+=3}}}h.addGroup(y,x,0);y+=x}function x(s){const n=p;const r=new sZ;const f=new iM;let g=0;const x=s===true?t:e;const b=s===true?1:-1;for(let t=1;t<=i;t++){l.push(0,m*b,0);u.push(0,b,0);d.push(.5,.5);p++}const w=p;for(let t=0;t<=i;t++){const e=t/i;const s=e*a+o;const n=Math.cos(s);const h=Math.sin(s);f.x=x*h;f.y=m*b;f.z=x*n;l.push(f.x,f.y,f.z);u.push(0,b,0);r.x=n*.5+.5;r.y=h*.5*b+.5;d.push(r.x,r.y);p++}for(let t=0;t<i;t++){const e=n+t;const i=w+t;if(s===true){c.push(i,i+1,e)}else{c.push(i+1,i,e)}g+=3}h.addGroup(y,g,s===true?1:2);y+=g}}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new ax(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class ab extends ax{constructor(t=1,e=1,s=32,i=1,n=false,r=0,o=Math.PI*2){super(0,t,e,s,i,n,r,o);this.type="ConeGeometry";this.parameters={radius:t,height:e,radialSegments:s,heightSegments:i,openEnded:n,thetaStart:r,thetaLength:o}}static fromJSON(t){return new ab(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class aw extends n7{constructor(t=[],e=[],s=1,i=0){super();this.type="PolyhedronGeometry";this.parameters={vertices:t,indices:e,radius:s,detail:i};const n=[];const r=[];o(i);h(s);c();this.setAttribute("position",new n1(n,3));this.setAttribute("normal",new n1(n.slice(),3));this.setAttribute("uv",new n1(r,2));if(i===0){this.computeVertexNormals()}else{this.normalizeNormals()}function o(t){const s=new iM;const i=new iM;const n=new iM;for(let r=0;r<e.length;r+=3){d(e[r+0],s);d(e[r+1],i);d(e[r+2],n);a(s,i,n,t)}}function a(t,e,s,i){const n=i+1;const r=[];for(let i=0;i<=n;i++){r[i]=[];const o=t.clone().lerp(s,i/n);const a=e.clone().lerp(s,i/n);const h=n-i;for(let t=0;t<=h;t++){if(t===0&&i===n){r[i][t]=o}else{r[i][t]=o.clone().lerp(a,t/h)}}}for(let t=0;t<n;t++){for(let e=0;e<2*(n-t)-1;e++){const s=Math.floor(e/2);if(e%2===0){u(r[t][s+1]);u(r[t+1][s]);u(r[t][s])}else{u(r[t][s+1]);u(r[t+1][s+1]);u(r[t+1][s])}}}}function h(t){const e=new iM;for(let s=0;s<n.length;s+=3){e.x=n[s+0];e.y=n[s+1];e.z=n[s+2];e.normalize().multiplyScalar(t);n[s+0]=e.x;n[s+1]=e.y;n[s+2]=e.z}}function c(){const t=new iM;for(let e=0;e<n.length;e+=3){t.x=n[e+0];t.y=n[e+1];t.z=n[e+2];const s=m(t)/2/Math.PI+.5;const i=y(t)/Math.PI+.5;r.push(s,1-i)}p();l()}function l(){for(let t=0;t<r.length;t+=6){const e=r[t+0];const s=r[t+2];const i=r[t+4];const n=Math.max(e,s,i);const o=Math.min(e,s,i);if(n>.9&&o<.1){if(e<.2)r[t+0]+=1;if(s<.2)r[t+2]+=1;if(i<.2)r[t+4]+=1}}}function u(t){n.push(t.x,t.y,t.z)}function d(e,s){const i=e*3;s.x=t[i+0];s.y=t[i+1];s.z=t[i+2]}function p(){const t=new iM;const e=new iM;const s=new iM;const i=new iM;const o=new sZ;const a=new sZ;const h=new sZ;for(let c=0,l=0;c<n.length;c+=9,l+=6){t.set(n[c+0],n[c+1],n[c+2]);e.set(n[c+3],n[c+4],n[c+5]);s.set(n[c+6],n[c+7],n[c+8]);o.set(r[l+0],r[l+1]);a.set(r[l+2],r[l+3]);h.set(r[l+4],r[l+5]);i.copy(t).add(e).add(s).divideScalar(3);const u=m(i);f(o,l+0,t,u);f(a,l+2,e,u);f(h,l+4,s,u)}}function f(t,e,s,i){if(i<0&&t.x===1){r[e]=t.x-1}if(s.x===0&&s.z===0){r[e]=i/2/Math.PI+.5}}function m(t){return Math.atan2(t.z,-t.x)}function y(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new aw(t.vertices,t.indices,t.radius,t.details)}}class aM extends aw{constructor(t=1,e=0){const s=(1+Math.sqrt(5))/2;const i=1/s;const n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-s,0,-i,s,0,i,-s,0,i,s,-i,-s,0,-i,s,0,i,-s,0,i,s,0,-s,0,-i,s,0,-i,-s,0,i,s,0,i];const r=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,r,t,e);this.type="DodecahedronGeometry";this.parameters={radius:t,detail:e}}static fromJSON(t){return new aM(t.radius,t.detail)}}const av=new iM;const aS=new iM;const a_=new iM;const aA=new nI;class aT extends n7{constructor(t=null,e=1){super();this.type="EdgesGeometry";this.parameters={geometry:t,thresholdAngle:e};if(t!==null){const s=4;const i=Math.pow(10,s);const n=Math.cos(s_*e);const r=t.getIndex();const o=t.getAttribute("position");const a=r?r.count:o.count;const h=[0,0,0];const c=["a","b","c"];const l=new Array(3);const u={};const d=[];for(let t=0;t<a;t+=3){if(r){h[0]=r.getX(t);h[1]=r.getX(t+1);h[2]=r.getX(t+2)}else{h[0]=t;h[1]=t+1;h[2]=t+2}const{a:e,b:s,c:a}=aA;e.fromBufferAttribute(o,h[0]);s.fromBufferAttribute(o,h[1]);a.fromBufferAttribute(o,h[2]);aA.getNormal(a_);l[0]=`${Math.round(e.x*i)},${Math.round(e.y*i)},${Math.round(e.z*i)}`;l[1]=`${Math.round(s.x*i)},${Math.round(s.y*i)},${Math.round(s.z*i)}`;l[2]=`${Math.round(a.x*i)},${Math.round(a.y*i)},${Math.round(a.z*i)}`;if(l[0]===l[1]||l[1]===l[2]||l[2]===l[0]){continue}for(let t=0;t<3;t++){const e=(t+1)%3;const s=l[t];const i=l[e];const r=aA[c[t]];const o=aA[c[e]];const a=`${s}_${i}`;const p=`${i}_${s}`;if(p in u&&u[p]){if(a_.dot(u[p].normal)<=n){d.push(r.x,r.y,r.z);d.push(o.x,o.y,o.z)}u[p]=null}else if(!(a in u)){u[a]={index0:h[t],index1:h[e],normal:a_.clone()}}}}for(const t in u){if(u[t]){const{index0:e,index1:s}=u[t];av.fromBufferAttribute(o,e);aS.fromBufferAttribute(o,s);d.push(av.x,av.y,av.z);d.push(aS.x,aS.y,aS.z)}}this.setAttribute("position",new n1(d,3))}}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}}class az{constructor(){this.type="Curve";this.arcLengthDivisions=200;this.needsUpdate=false;this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(t,e){const s=this.getUtoTmapping(t);return this.getPoint(s,e)}getPoints(t=5){const e=[];for(let s=0;s<=t;s++){e.push(this.getPoint(s/t))}return e}getSpacedPoints(t=5){const e=[];for(let s=0;s<=t;s++){e.push(this.getPointAt(s/t))}return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate){return this.cacheArcLengths}this.needsUpdate=false;const e=[];let s,i=this.getPoint(0);let n=0;e.push(0);for(let r=1;r<=t;r++){s=this.getPoint(r/t);n+=s.distanceTo(i);e.push(n);i=s}this.cacheArcLengths=e;return e}updateArcLengths(){this.needsUpdate=true;this.getLengths()}getUtoTmapping(t,e=null){const s=this.getLengths();let i=0;const n=s.length;let r;if(e){r=e}else{r=t*s[n-1]}let o=0,a=n-1,h;while(o<=a){i=Math.floor(o+(a-o)/2);h=s[i]-r;if(h<0){o=i+1}else if(h>0){a=i-1}else{a=i;break}}i=a;if(s[i]===r){return i/(n-1)}const c=s[i];const l=s[i+1];const u=l-c;const d=(r-c)/u;const p=(i+d)/(n-1);return p}getTangent(t,e){const s=1e-4;let i=t-s;let n=t+s;if(i<0)i=0;if(n>1)n=1;const r=this.getPoint(i);const o=this.getPoint(n);const a=e||(r.isVector2?new sZ:new iM);a.copy(o).sub(r).normalize();return a}getTangentAt(t,e){const s=this.getUtoTmapping(t);return this.getTangent(s,e)}computeFrenetFrames(t,e=false){const s=new iM;const i=[];const n=[];const r=[];const o=new iM;const a=new i$;for(let e=0;e<=t;e++){const s=e/t;i[e]=this.getTangentAt(s,new iM)}n[0]=new iM;r[0]=new iM;let h=Number.MAX_VALUE;const c=Math.abs(i[0].x);const l=Math.abs(i[0].y);const u=Math.abs(i[0].z);if(c<=h){h=c;s.set(1,0,0)}if(l<=h){h=l;s.set(0,1,0)}if(u<=h){s.set(0,0,1)}o.crossVectors(i[0],s).normalize();n[0].crossVectors(i[0],o);r[0].crossVectors(i[0],n[0]);for(let e=1;e<=t;e++){n[e]=n[e-1].clone();r[e]=r[e-1].clone();o.crossVectors(i[e-1],i[e]);if(o.length()>Number.EPSILON){o.normalize();const t=Math.acos(sz(i[e-1].dot(i[e]),-1,1));n[e].applyMatrix4(a.makeRotationAxis(o,t))}r[e].crossVectors(i[e],n[e])}if(e===true){let e=Math.acos(sz(n[0].dot(n[t]),-1,1));e/=t;if(i[0].dot(o.crossVectors(n[0],n[t]))>0){e=-e}for(let s=1;s<=t;s++){n[s].applyMatrix4(a.makeRotationAxis(i[s],e*s));r[s].crossVectors(i[s],n[s])}}return{tangents:i,normals:n,binormals:r}}clone(){return new this.constructor().copy(this)}copy(t){this.arcLengthDivisions=t.arcLengthDivisions;return this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};t.arcLengthDivisions=this.arcLengthDivisions;t.type=this.type;return t}fromJSON(t){this.arcLengthDivisions=t.arcLengthDivisions;return this}}class aI extends az{constructor(t=0,e=0,s=1,i=1,n=0,r=Math.PI*2,o=false,a=0){super();this.isEllipseCurve=true;this.type="EllipseCurve";this.aX=t;this.aY=e;this.xRadius=s;this.yRadius=i;this.aStartAngle=n;this.aEndAngle=r;this.aClockwise=o;this.aRotation=a}getPoint(t,e=new sZ){const s=e;const i=Math.PI*2;let n=this.aEndAngle-this.aStartAngle;const r=Math.abs(n)<Number.EPSILON;while(n<0)n+=i;while(n>i)n-=i;if(n<Number.EPSILON){if(r){n=0}else{n=i}}if(this.aClockwise===true&&!r){if(n===i){n=-i}else{n=n-i}}const o=this.aStartAngle+t*n;let a=this.aX+this.xRadius*Math.cos(o);let h=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const t=Math.cos(this.aRotation);const e=Math.sin(this.aRotation);const s=a-this.aX;const i=h-this.aY;a=s*t-i*e+this.aX;h=s*e+i*t+this.aY}return s.set(a,h)}copy(t){super.copy(t);this.aX=t.aX;this.aY=t.aY;this.xRadius=t.xRadius;this.yRadius=t.yRadius;this.aStartAngle=t.aStartAngle;this.aEndAngle=t.aEndAngle;this.aClockwise=t.aClockwise;this.aRotation=t.aRotation;return this}toJSON(){const t=super.toJSON();t.aX=this.aX;t.aY=this.aY;t.xRadius=this.xRadius;t.yRadius=this.yRadius;t.aStartAngle=this.aStartAngle;t.aEndAngle=this.aEndAngle;t.aClockwise=this.aClockwise;t.aRotation=this.aRotation;return t}fromJSON(t){super.fromJSON(t);this.aX=t.aX;this.aY=t.aY;this.xRadius=t.xRadius;this.yRadius=t.yRadius;this.aStartAngle=t.aStartAngle;this.aEndAngle=t.aEndAngle;this.aClockwise=t.aClockwise;this.aRotation=t.aRotation;return this}}class aC extends aI{constructor(t,e,s,i,n,r){super(t,e,s,s,i,n,r);this.isArcCurve=true;this.type="ArcCurve"}}function aB(){let t=0,e=0,s=0,i=0;function n(n,r,o,a){t=n;e=o;s=-3*n+3*r-2*o-a;i=2*n-2*r+o+a}return{initCatmullRom:function(t,e,s,i,r){n(e,s,r*(s-t),r*(i-e))},initNonuniformCatmullRom:function(t,e,s,i,r,o,a){let h=(e-t)/r-(s-t)/(r+o)+(s-e)/o;let c=(s-e)/o-(i-e)/(o+a)+(i-s)/a;h*=o;c*=o;n(e,s,h,c)},calc:function(n){const r=n*n;const o=r*n;return t+e*n+s*r+i*o}}}const ak=new iM;const aR=new aB;const aE=new aB;const aP=new aB;class aO extends az{constructor(t=[],e=false,s="centripetal",i=.5){super();this.isCatmullRomCurve3=true;this.type="CatmullRomCurve3";this.points=t;this.closed=e;this.curveType=s;this.tension=i}getPoint(t,e=new iM){const s=e;const i=this.points;const n=i.length;const r=(n-(this.closed?0:1))*t;let o=Math.floor(r);let a=r-o;if(this.closed){o+=o>0?0:(Math.floor(Math.abs(o)/n)+1)*n}else if(a===0&&o===n-1){o=n-2;a=1}let h,c;if(this.closed||o>0){h=i[(o-1)%n]}else{ak.subVectors(i[0],i[1]).add(i[0]);h=ak}const l=i[o%n];const u=i[(o+1)%n];if(this.closed||o+2<n){c=i[(o+2)%n]}else{ak.subVectors(i[n-1],i[n-2]).add(i[n-1]);c=ak}if(this.curveType==="centripetal"||this.curveType==="chordal"){const t=this.curveType==="chordal"?.5:.25;let e=Math.pow(h.distanceToSquared(l),t);let s=Math.pow(l.distanceToSquared(u),t);let i=Math.pow(u.distanceToSquared(c),t);if(s<1e-4)s=1;if(e<1e-4)e=s;if(i<1e-4)i=s;aR.initNonuniformCatmullRom(h.x,l.x,u.x,c.x,e,s,i);aE.initNonuniformCatmullRom(h.y,l.y,u.y,c.y,e,s,i);aP.initNonuniformCatmullRom(h.z,l.z,u.z,c.z,e,s,i)}else if(this.curveType==="catmullrom"){aR.initCatmullRom(h.x,l.x,u.x,c.x,this.tension);aE.initCatmullRom(h.y,l.y,u.y,c.y,this.tension);aP.initCatmullRom(h.z,l.z,u.z,c.z,this.tension)}s.set(aR.calc(a),aE.calc(a),aP.calc(a));return s}copy(t){super.copy(t);this.points=[];for(let e=0,s=t.points.length;e<s;e++){const s=t.points[e];this.points.push(s.clone())}this.closed=t.closed;this.curveType=t.curveType;this.tension=t.tension;return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,s=this.points.length;e<s;e++){const s=this.points[e];t.points.push(s.toArray())}t.closed=this.closed;t.curveType=this.curveType;t.tension=this.tension;return t}fromJSON(t){super.fromJSON(t);this.points=[];for(let e=0,s=t.points.length;e<s;e++){const s=t.points[e];this.points.push(new iM().fromArray(s))}this.closed=t.closed;this.curveType=t.curveType;this.tension=t.tension;return this}}function aF(t,e,s,i,n){const r=(i-e)*.5;const o=(n-s)*.5;const a=t*t;const h=t*a;return(2*s-2*i+r+o)*h+(-3*s+3*i-2*r-o)*a+r*t+s}function aN(t,e){const s=1-t;return s*s*e}function aV(t,e){return 2*(1-t)*t*e}function aL(t,e){return t*t*e}function aj(t,e,s,i){return aN(t,e)+aV(t,s)+aL(t,i)}function aW(t,e){const s=1-t;return s*s*s*e}function aU(t,e){const s=1-t;return 3*s*s*t*e}function aD(t,e){return 3*(1-t)*t*t*e}function aH(t,e){return t*t*t*e}function aq(t,e,s,i,n){return aW(t,e)+aU(t,s)+aD(t,i)+aH(t,n)}class aJ extends az{constructor(t=new sZ,e=new sZ,s=new sZ,i=new sZ){super();this.isCubicBezierCurve=true;this.type="CubicBezierCurve";this.v0=t;this.v1=e;this.v2=s;this.v3=i}getPoint(t,e=new sZ){const s=e;const i=this.v0,n=this.v1,r=this.v2,o=this.v3;s.set(aq(t,i.x,n.x,r.x,o.x),aq(t,i.y,n.y,r.y,o.y));return s}copy(t){super.copy(t);this.v0.copy(t.v0);this.v1.copy(t.v1);this.v2.copy(t.v2);this.v3.copy(t.v3);return this}toJSON(){const t=super.toJSON();t.v0=this.v0.toArray();t.v1=this.v1.toArray();t.v2=this.v2.toArray();t.v3=this.v3.toArray();return t}fromJSON(t){super.fromJSON(t);this.v0.fromArray(t.v0);this.v1.fromArray(t.v1);this.v2.fromArray(t.v2);this.v3.fromArray(t.v3);return this}}class aX extends az{constructor(t=new iM,e=new iM,s=new iM,i=new iM){super();this.isCubicBezierCurve3=true;this.type="CubicBezierCurve3";this.v0=t;this.v1=e;this.v2=s;this.v3=i}getPoint(t,e=new iM){const s=e;const i=this.v0,n=this.v1,r=this.v2,o=this.v3;s.set(aq(t,i.x,n.x,r.x,o.x),aq(t,i.y,n.y,r.y,o.y),aq(t,i.z,n.z,r.z,o.z));return s}copy(t){super.copy(t);this.v0.copy(t.v0);this.v1.copy(t.v1);this.v2.copy(t.v2);this.v3.copy(t.v3);return this}toJSON(){const t=super.toJSON();t.v0=this.v0.toArray();t.v1=this.v1.toArray();t.v2=this.v2.toArray();t.v3=this.v3.toArray();return t}fromJSON(t){super.fromJSON(t);this.v0.fromArray(t.v0);this.v1.fromArray(t.v1);this.v2.fromArray(t.v2);this.v3.fromArray(t.v3);return this}}class aY extends az{constructor(t=new sZ,e=new sZ){super();this.isLineCurve=true;this.type="LineCurve";this.v1=t;this.v2=e}getPoint(t,e=new sZ){const s=e;if(t===1){s.copy(this.v2)}else{s.copy(this.v2).sub(this.v1);s.multiplyScalar(t).add(this.v1)}return s}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new sZ){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){super.copy(t);this.v1.copy(t.v1);this.v2.copy(t.v2);return this}toJSON(){const t=super.toJSON();t.v1=this.v1.toArray();t.v2=this.v2.toArray();return t}fromJSON(t){super.fromJSON(t);this.v1.fromArray(t.v1);this.v2.fromArray(t.v2);return this}}class aZ extends az{constructor(t=new iM,e=new iM){super();this.isLineCurve3=true;this.type="LineCurve3";this.v1=t;this.v2=e}getPoint(t,e=new iM){const s=e;if(t===1){s.copy(this.v2)}else{s.copy(this.v2).sub(this.v1);s.multiplyScalar(t).add(this.v1)}return s}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new iM){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){super.copy(t);this.v1.copy(t.v1);this.v2.copy(t.v2);return this}toJSON(){const t=super.toJSON();t.v1=this.v1.toArray();t.v2=this.v2.toArray();return t}fromJSON(t){super.fromJSON(t);this.v1.fromArray(t.v1);this.v2.fromArray(t.v2);return this}}class aG extends az{constructor(t=new sZ,e=new sZ,s=new sZ){super();this.isQuadraticBezierCurve=true;this.type="QuadraticBezierCurve";this.v0=t;this.v1=e;this.v2=s}getPoint(t,e=new sZ){const s=e;const i=this.v0,n=this.v1,r=this.v2;s.set(aj(t,i.x,n.x,r.x),aj(t,i.y,n.y,r.y));return s}copy(t){super.copy(t);this.v0.copy(t.v0);this.v1.copy(t.v1);this.v2.copy(t.v2);return this}toJSON(){const t=super.toJSON();t.v0=this.v0.toArray();t.v1=this.v1.toArray();t.v2=this.v2.toArray();return t}fromJSON(t){super.fromJSON(t);this.v0.fromArray(t.v0);this.v1.fromArray(t.v1);this.v2.fromArray(t.v2);return this}}class a$ extends az{constructor(t=new iM,e=new iM,s=new iM){super();this.isQuadraticBezierCurve3=true;this.type="QuadraticBezierCurve3";this.v0=t;this.v1=e;this.v2=s}getPoint(t,e=new iM){const s=e;const i=this.v0,n=this.v1,r=this.v2;s.set(aj(t,i.x,n.x,r.x),aj(t,i.y,n.y,r.y),aj(t,i.z,n.z,r.z));return s}copy(t){super.copy(t);this.v0.copy(t.v0);this.v1.copy(t.v1);this.v2.copy(t.v2);return this}toJSON(){const t=super.toJSON();t.v0=this.v0.toArray();t.v1=this.v1.toArray();t.v2=this.v2.toArray();return t}fromJSON(t){super.fromJSON(t);this.v0.fromArray(t.v0);this.v1.fromArray(t.v1);this.v2.fromArray(t.v2);return this}}class aQ extends az{constructor(t=[]){super();this.isSplineCurve=true;this.type="SplineCurve";this.points=t}getPoint(t,e=new sZ){const s=e;const i=this.points;const n=(i.length-1)*t;const r=Math.floor(n);const o=n-r;const a=i[r===0?r:r-1];const h=i[r];const c=i[r>i.length-2?i.length-1:r+1];const l=i[r>i.length-3?i.length-1:r+2];s.set(aF(o,a.x,h.x,c.x,l.x),aF(o,a.y,h.y,c.y,l.y));return s}copy(t){super.copy(t);this.points=[];for(let e=0,s=t.points.length;e<s;e++){const s=t.points[e];this.points.push(s.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,s=this.points.length;e<s;e++){const s=this.points[e];t.points.push(s.toArray())}return t}fromJSON(t){super.fromJSON(t);this.points=[];for(let e=0,s=t.points.length;e<s;e++){const s=t.points[e];this.points.push(new sZ().fromArray(s))}return this}}var aK=Object.freeze({__proto__:null,ArcCurve:aC,CatmullRomCurve3:aO,CubicBezierCurve:aJ,CubicBezierCurve3:aX,EllipseCurve:aI,LineCurve:aY,LineCurve3:aZ,QuadraticBezierCurve:aG,QuadraticBezierCurve3:a$,SplineCurve:aQ});class a0 extends az{constructor(){super();this.type="CurvePath";this.curves=[];this.autoClose=false}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0);const e=this.curves[this.curves.length-1].getPoint(1);if(!t.equals(e)){const s=t.isVector2===true?"LineCurve":"LineCurve3";this.curves.push(new aK[s](e,t))}return this}getPoint(t,e){const s=t*this.getLength();const i=this.getCurveLengths();let n=0;while(n<i.length){if(i[n]>=s){const t=i[n]-s;const r=this.curves[n];const o=r.getLength();const a=o===0?0:1-t/o;return r.getPointAt(a,e)}n++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=true;this.cacheLengths=null;this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length){return this.cacheLengths}const t=[];let e=0;for(let s=0,i=this.curves.length;s<i;s++){e+=this.curves[s].getLength();t.push(e)}this.cacheLengths=t;return t}getSpacedPoints(t=40){const e=[];for(let s=0;s<=t;s++){e.push(this.getPoint(s/t))}if(this.autoClose){e.push(e[0])}return e}getPoints(t=12){const e=[];let s;for(let i=0,n=this.curves;i<n.length;i++){const r=n[i];const o=r.isEllipseCurve?t*2:r.isLineCurve||r.isLineCurve3?1:r.isSplineCurve?t*r.points.length:t;const a=r.getPoints(o);for(let t=0;t<a.length;t++){const i=a[t];if(s&&s.equals(i))continue;e.push(i);s=i}}if(this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])){e.push(e[0])}return e}copy(t){super.copy(t);this.curves=[];for(let e=0,s=t.curves.length;e<s;e++){const s=t.curves[e];this.curves.push(s.clone())}this.autoClose=t.autoClose;return this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose;t.curves=[];for(let e=0,s=this.curves.length;e<s;e++){const s=this.curves[e];t.curves.push(s.toJSON())}return t}fromJSON(t){super.fromJSON(t);this.autoClose=t.autoClose;this.curves=[];for(let e=0,s=t.curves.length;e<s;e++){const s=t.curves[e];this.curves.push(new aK[s.type]().fromJSON(s))}return this}}class a1 extends a0{constructor(t){super();this.type="Path";this.currentPoint=new sZ;if(t){this.setFromPoints(t)}}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,s=t.length;e<s;e++){this.lineTo(t[e].x,t[e].y)}return this}moveTo(t,e){this.currentPoint.set(t,e);return this}lineTo(t,e){const s=new aY(this.currentPoint.clone(),new sZ(t,e));this.curves.push(s);this.currentPoint.set(t,e);return this}quadraticCurveTo(t,e,s,i){const n=new aG(this.currentPoint.clone(),new sZ(t,e),new sZ(s,i));this.curves.push(n);this.currentPoint.set(s,i);return this}bezierCurveTo(t,e,s,i,n,r){const o=new aJ(this.currentPoint.clone(),new sZ(t,e),new sZ(s,i),new sZ(n,r));this.curves.push(o);this.currentPoint.set(n,r);return this}splineThru(t){const e=[this.currentPoint.clone()].concat(t);const s=new aQ(e);this.curves.push(s);this.currentPoint.copy(t[t.length-1]);return this}arc(t,e,s,i,n,r){const o=this.currentPoint.x;const a=this.currentPoint.y;this.absarc(t+o,e+a,s,i,n,r);return this}absarc(t,e,s,i,n,r){this.absellipse(t,e,s,s,i,n,r);return this}ellipse(t,e,s,i,n,r,o,a){const h=this.currentPoint.x;const c=this.currentPoint.y;this.absellipse(t+h,e+c,s,i,n,r,o,a);return this}absellipse(t,e,s,i,n,r,o,a){const h=new aI(t,e,s,i,n,r,o,a);if(this.curves.length>0){const t=h.getPoint(0);if(!t.equals(this.currentPoint)){this.lineTo(t.x,t.y)}}this.curves.push(h);const c=h.getPoint(1);this.currentPoint.copy(c);return this}copy(t){super.copy(t);this.currentPoint.copy(t.currentPoint);return this}toJSON(){const t=super.toJSON();t.currentPoint=this.currentPoint.toArray();return t}fromJSON(t){super.fromJSON(t);this.currentPoint.fromArray(t.currentPoint);return this}}class a2 extends a1{constructor(t){super(t);this.uuid=sT();this.type="Shape";this.holes=[]}getPointsHoles(t){const e=[];for(let s=0,i=this.holes.length;s<i;s++){e[s]=this.holes[s].getPoints(t)}return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t);this.holes=[];for(let e=0,s=t.holes.length;e<s;e++){const s=t.holes[e];this.holes.push(s.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid;t.holes=[];for(let e=0,s=this.holes.length;e<s;e++){const s=this.holes[e];t.holes.push(s.toJSON())}return t}fromJSON(t){super.fromJSON(t);this.uuid=t.uuid;this.holes=[];for(let e=0,s=t.holes.length;e<s;e++){const s=t.holes[e];this.holes.push(new a1().fromJSON(s))}return this}}function a3(t,e,s=2){const i=e&&e.length;const n=i?e[0]*s:t.length;let r=a5(t,0,n,s,true);const o=[];if(!r||r.next===r.prev)return o;let a,h,c;if(i)r=he(t,e,r,s);if(t.length>80*s){a=Infinity;h=Infinity;let e=-Infinity;let i=-Infinity;for(let r=s;r<n;r+=s){const s=t[r];const n=t[r+1];if(s<a)a=s;if(n<h)h=n;if(s>e)e=s;if(n>i)i=n}c=Math.max(e-a,i-h);c=c!==0?32767/c:0}a6(r,o,s,a,h,c,0);return o}function a5(t,e,s,i,n){let r;if(n===hA(t,e,s,i)>0){for(let n=e;n<s;n+=i)r=hv(n/i|0,t[n],t[n+1],r)}else{for(let n=s-i;n>=e;n-=i)r=hv(n/i|0,t[n],t[n+1],r)}if(r&&hf(r,r.next)){hS(r);r=r.next}return r}function a4(t,e){if(!t)return t;if(!e)e=t;let s=t,i;do{i=false;if(!s.steiner&&(hf(s,s.next)||hp(s.prev,s,s.next)===0)){hS(s);s=e=s.prev;if(s===s.next)break;i=true}else{s=s.next}}while(i||s!==e);return e}function a6(t,e,s,i,n,r,o){if(!t)return;if(!o&&r)ho(t,i,n,r);let a=t;while(t.prev!==t.next){const h=t.prev;const c=t.next;if(r?a9(t,i,n,r):a8(t)){e.push(h.i,t.i,c.i);hS(t);t=c.next;a=c.next;continue}t=c;if(t===a){if(!o){a6(a4(t),e,s,i,n,r,1)}else if(o===1){t=a7(a4(t),e);a6(t,e,s,i,n,r,2)}else if(o===2){ht(t,e,s,i,n,r)}break}}}function a8(t){const e=t.prev,s=t,i=t.next;if(hp(e,s,i)>=0)return false;const n=e.x,r=s.x,o=i.x,a=e.y,h=s.y,c=i.y;const l=Math.min(n,r,o),u=Math.min(a,h,c),d=Math.max(n,r,o),p=Math.max(a,h,c);let f=i.next;while(f!==e){if(f.x>=l&&f.x<=d&&f.y>=u&&f.y<=p&&hu(n,a,r,h,o,c,f.x,f.y)&&hp(f.prev,f,f.next)>=0)return false;f=f.next}return true}function a9(t,e,s,i){const n=t.prev,r=t,o=t.next;if(hp(n,r,o)>=0)return false;const a=n.x,h=r.x,c=o.x,l=n.y,u=r.y,d=o.y;const p=Math.min(a,h,c),f=Math.min(l,u,d),m=Math.max(a,h,c),y=Math.max(l,u,d);const g=hh(p,f,e,s,i),x=hh(m,y,e,s,i);let b=t.prevZ,w=t.nextZ;while(b&&b.z>=g&&w&&w.z<=x){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=y&&b!==n&&b!==o&&hu(a,l,h,u,c,d,b.x,b.y)&&hp(b.prev,b,b.next)>=0)return false;b=b.prevZ;if(w.x>=p&&w.x<=m&&w.y>=f&&w.y<=y&&w!==n&&w!==o&&hu(a,l,h,u,c,d,w.x,w.y)&&hp(w.prev,w,w.next)>=0)return false;w=w.nextZ}while(b&&b.z>=g){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=y&&b!==n&&b!==o&&hu(a,l,h,u,c,d,b.x,b.y)&&hp(b.prev,b,b.next)>=0)return false;b=b.prevZ}while(w&&w.z<=x){if(w.x>=p&&w.x<=m&&w.y>=f&&w.y<=y&&w!==n&&w!==o&&hu(a,l,h,u,c,d,w.x,w.y)&&hp(w.prev,w,w.next)>=0)return false;w=w.nextZ}return true}function a7(t,e){let s=t;do{const i=s.prev,n=s.next.next;if(!hf(i,n)&&hm(i,s,s.next,n)&&hb(i,n)&&hb(n,i)){e.push(i.i,s.i,n.i);hS(s);hS(s.next);s=t=n}s=s.next}while(s!==t);return a4(s)}function ht(t,e,s,i,n,r){let o=t;do{let t=o.next.next;while(t!==o.prev){if(o.i!==t.i&&hd(o,t)){let a=hM(o,t);o=a4(o,o.next);a=a4(a,a.next);a6(o,e,s,i,n,r,0);a6(a,e,s,i,n,r,0);return}t=t.next}o=o.next}while(o!==t)}function he(t,e,s,i){const n=[];for(let s=0,r=e.length;s<r;s++){const o=e[s]*i;const a=s<r-1?e[s+1]*i:t.length;const h=a5(t,o,a,i,false);if(h===h.next)h.steiner=true;n.push(hc(h))}n.sort(hs);for(let t=0;t<n.length;t++){s=hi(n[t],s)}return s}function hs(t,e){let s=t.x-e.x;if(s===0){s=t.y-e.y;if(s===0){const i=(t.next.y-t.y)/(t.next.x-t.x);const n=(e.next.y-e.y)/(e.next.x-e.x);s=i-n}}return s}function hi(t,e){const s=hn(t,e);if(!s){return e}const i=hM(s,t);a4(i,i.next);return a4(s,s.next)}function hn(t,e){let s=e;const i=t.x;const n=t.y;let r=-Infinity;let o;if(hf(t,s))return s;do{if(hf(t,s.next))return s.next;else if(n<=s.y&&n>=s.next.y&&s.next.y!==s.y){const t=s.x+(n-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(t<=i&&t>r){r=t;o=s.x<s.next.x?s:s.next;if(t===i)return o}}s=s.next}while(s!==e);if(!o)return null;const a=o;const h=o.x;const c=o.y;let l=Infinity;s=o;do{if(i>=s.x&&s.x>=h&&i!==s.x&&hl(n<c?i:r,n,h,c,n<c?r:i,n,s.x,s.y)){const e=Math.abs(n-s.y)/(i-s.x);if(hb(s,t)&&(e<l||e===l&&(s.x>o.x||s.x===o.x&&hr(o,s)))){o=s;l=e}}s=s.next}while(s!==a);return o}function hr(t,e){return hp(t.prev,t,e.prev)<0&&hp(e.next,t,t.next)<0}function ho(t,e,s,i){let n=t;do{if(n.z===0)n.z=hh(n.x,n.y,e,s,i);n.prevZ=n.prev;n.nextZ=n.next;n=n.next}while(n!==t);n.prevZ.nextZ=null;n.prevZ=null;ha(n)}function ha(t){let e;let s=1;do{let i=t;let n;t=null;let r=null;e=0;while(i){e++;let o=i;let a=0;for(let t=0;t<s;t++){a++;o=o.nextZ;if(!o)break}let h=s;while(a>0||h>0&&o){if(a!==0&&(h===0||!o||i.z<=o.z)){n=i;i=i.nextZ;a--}else{n=o;o=o.nextZ;h--}if(r)r.nextZ=n;else t=n;n.prevZ=r;r=n}i=o}r.nextZ=null;s*=2}while(e>1);return t}function hh(t,e,s,i,n){t=(t-s)*n|0;e=(e-i)*n|0;t=(t|t<<8)&0xff00ff;t=(t|t<<4)&0xf0f0f0f;t=(t|t<<2)&0x33333333;t=(t|t<<1)&0x55555555;e=(e|e<<8)&0xff00ff;e=(e|e<<4)&0xf0f0f0f;e=(e|e<<2)&0x33333333;e=(e|e<<1)&0x55555555;return t|e<<1}function hc(t){let e=t,s=t;do{if(e.x<s.x||e.x===s.x&&e.y<s.y)s=e;e=e.next}while(e!==t);return s}function hl(t,e,s,i,n,r,o,a){return(n-o)*(e-a)>=(t-o)*(r-a)&&(t-o)*(i-a)>=(s-o)*(e-a)&&(s-o)*(r-a)>=(n-o)*(i-a)}function hu(t,e,s,i,n,r,o,a){return!(t===o&&e===a)&&hl(t,e,s,i,n,r,o,a)}function hd(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!hx(t,e)&&(hb(t,e)&&hb(e,t)&&hw(t,e)&&(hp(t.prev,t,e.prev)||hp(t,e.prev,e))||hf(t,e)&&hp(t.prev,t,t.next)>0&&hp(e.prev,e,e.next)>0)}function hp(t,e,s){return(e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y)}function hf(t,e){return t.x===e.x&&t.y===e.y}function hm(t,e,s,i){const n=hg(hp(t,e,s));const r=hg(hp(t,e,i));const o=hg(hp(s,i,t));const a=hg(hp(s,i,e));if(n!==r&&o!==a)return true;if(n===0&&hy(t,s,e))return true;if(r===0&&hy(t,i,e))return true;if(o===0&&hy(s,t,i))return true;if(a===0&&hy(s,e,i))return true;return false}function hy(t,e,s){return e.x<=Math.max(t.x,s.x)&&e.x>=Math.min(t.x,s.x)&&e.y<=Math.max(t.y,s.y)&&e.y>=Math.min(t.y,s.y)}function hg(t){return t>0?1:t<0?-1:0}function hx(t,e){let s=t;do{if(s.i!==t.i&&s.next.i!==t.i&&s.i!==e.i&&s.next.i!==e.i&&hm(s,s.next,t,e))return true;s=s.next}while(s!==t);return false}function hb(t,e){return hp(t.prev,t,t.next)<0?hp(t,e,t.next)>=0&&hp(t,t.prev,e)>=0:hp(t,e,t.prev)<0||hp(t,t.next,e)<0}function hw(t,e){let s=t;let i=false;const n=(t.x+e.x)/2;const r=(t.y+e.y)/2;do{if(s.y>r!==s.next.y>r&&s.next.y!==s.y&&n<(s.next.x-s.x)*(r-s.y)/(s.next.y-s.y)+s.x)i=!i;s=s.next}while(s!==t);return i}function hM(t,e){const s=h_(t.i,t.x,t.y),i=h_(e.i,e.x,e.y),n=t.next,r=e.prev;t.next=e;e.prev=t;s.next=n;n.prev=s;i.next=s;s.prev=i;r.next=i;i.prev=r;return i}function hv(t,e,s,i){const n=h_(t,e,s);if(!i){n.prev=n;n.next=n}else{n.next=i.next;n.prev=i;i.next.prev=n;i.next=n}return n}function hS(t){t.next.prev=t.prev;t.prev.next=t.next;if(t.prevZ)t.prevZ.nextZ=t.nextZ;if(t.nextZ)t.nextZ.prevZ=t.prevZ}function h_(t,e,s){return{i:t,x:e,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:false}}function hA(t,e,s,i){let n=0;for(let r=e,o=s-i;r<s;r+=i){n+=(t[o]-t[r])*(t[r+1]+t[o+1]);o=r}return n}class hT{static triangulate(t,e,s=2){return a3(t,e,s)}}class hz{static area(t){const e=t.length;let s=0;for(let i=e-1,n=0;n<e;i=n++){s+=t[i].x*t[n].y-t[n].x*t[i].y}return s*.5}static isClockWise(t){return hz.area(t)<0}static triangulateShape(t,e){const s=[];const i=[];const n=[];hI(t);hC(s,t);let r=t.length;e.forEach(hI);for(let t=0;t<e.length;t++){i.push(r);r+=e[t].length;hC(s,e[t])}const o=hT.triangulate(s,i);for(let t=0;t<o.length;t+=3){n.push(o.slice(t,t+3))}return n}}function hI(t){const e=t.length;if(e>2&&t[e-1].equals(t[0])){t.pop()}}function hC(t,e){for(let s=0;s<e.length;s++){t.push(e[s].x);t.push(e[s].y)}}class hB extends n7{constructor(t=new a2([new sZ(.5,.5),new sZ(-.5,.5),new sZ(-.5,-.5),new sZ(.5,-.5)]),e={}){super();this.type="ExtrudeGeometry";this.parameters={shapes:t,options:e};t=Array.isArray(t)?t:[t];const s=this;const i=[];const n=[];for(let e=0,s=t.length;e<s;e++){const s=t[e];r(s)}this.setAttribute("position",new n1(i,3));this.setAttribute("uv",new n1(n,2));this.computeVertexNormals();function r(t){const r=[];const o=e.curveSegments!==undefined?e.curveSegments:12;const a=e.steps!==undefined?e.steps:1;const h=e.depth!==undefined?e.depth:1;let c=e.bevelEnabled!==undefined?e.bevelEnabled:true;let l=e.bevelThickness!==undefined?e.bevelThickness:.2;let u=e.bevelSize!==undefined?e.bevelSize:l-.1;let d=e.bevelOffset!==undefined?e.bevelOffset:0;let p=e.bevelSegments!==undefined?e.bevelSegments:3;const f=e.extrudePath;const m=e.UVGenerator!==undefined?e.UVGenerator:hk;let y,g=false;let x,b,w,M;if(f){y=f.getSpacedPoints(a);g=true;c=false;x=f.computeFrenetFrames(a,false);b=new iM;w=new iM;M=new iM}if(!c){p=0;l=0;u=0;d=0}const v=t.extractPoints(o);let S=v.shape;const _=v.holes;const A=!hz.isClockWise(S);if(A){S=S.reverse();for(let t=0,e=_.length;t<e;t++){const e=_[t];if(hz.isClockWise(e)){_[t]=e.reverse()}}}function T(t){const e=1e-10;const s=e*e;let i=t[0];for(let e=1;e<=t.length;e++){const n=e%t.length;const r=t[n];const o=r.x-i.x;const a=r.y-i.y;const h=o*o+a*a;const c=Math.max(Math.abs(r.x),Math.abs(r.y),Math.abs(i.x),Math.abs(i.y));const l=s*c*c;if(h<=l){t.splice(n,1);e--;continue}i=r}}T(S);_.forEach(T);const z=_.length;const I=S;for(let t=0;t<z;t++){const e=_[t];S=S.concat(e)}function C(t,e,s){if(!e)console.error("THREE.ExtrudeGeometry: vec does not exist");return t.clone().addScaledVector(e,s)}const B=S.length;function k(t,e,s){let i,n,r;const o=t.x-e.x,a=t.y-e.y;const h=s.x-t.x,c=s.y-t.y;const l=o*o+a*a;const u=o*c-a*h;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(l);const d=Math.sqrt(h*h+c*c);const p=e.x-a/u;const f=e.y+o/u;const m=s.x-c/d;const y=s.y+h/d;const g=((m-p)*c-(y-f)*h)/(o*c-a*h);i=p+o*g-t.x;n=f+a*g-t.y;const x=i*i+n*n;if(x<=2){return new sZ(i,n)}else{r=Math.sqrt(x/2)}}else{let t=false;if(o>Number.EPSILON){if(h>Number.EPSILON){t=true}}else{if(o<-Number.EPSILON){if(h<-Number.EPSILON){t=true}}else{if(Math.sign(a)===Math.sign(c)){t=true}}}if(t){i=-a;n=o;r=Math.sqrt(l)}else{i=o;n=a;r=Math.sqrt(l/2)}}return new sZ(i/r,n/r)}const R=[];for(let t=0,e=I.length,s=e-1,i=t+1;t<e;t++,s++,i++){if(s===e)s=0;if(i===e)i=0;R[t]=k(I[t],I[s],I[i])}const E=[];let P,O=R.concat();for(let t=0,e=z;t<e;t++){const e=_[t];P=[];for(let t=0,s=e.length,i=s-1,n=t+1;t<s;t++,i++,n++){if(i===s)i=0;if(n===s)n=0;P[t]=k(e[t],e[i],e[n])}E.push(P);O=O.concat(P)}let F;if(p===0){F=hz.triangulateShape(I,_)}else{const t=[];const e=[];for(let s=0;s<p;s++){const i=s/p;const n=l*Math.cos(i*Math.PI/2);const r=u*Math.sin(i*Math.PI/2)+d;for(let e=0,s=I.length;e<s;e++){const s=C(I[e],R[e],r);U(s.x,s.y,-n);if(i===0)t.push(s)}for(let t=0,s=z;t<s;t++){const s=_[t];P=E[t];const o=[];for(let t=0,e=s.length;t<e;t++){const e=C(s[t],P[t],r);U(e.x,e.y,-n);if(i===0)o.push(e)}if(i===0)e.push(o)}}F=hz.triangulateShape(t,e)}const N=F.length;const V=u+d;for(let t=0;t<B;t++){const e=c?C(S[t],O[t],V):S[t];if(!g){U(e.x,e.y,0)}else{w.copy(x.normals[0]).multiplyScalar(e.x);b.copy(x.binormals[0]).multiplyScalar(e.y);M.copy(y[0]).add(w).add(b);U(M.x,M.y,M.z)}}for(let t=1;t<=a;t++){for(let e=0;e<B;e++){const s=c?C(S[e],O[e],V):S[e];if(!g){U(s.x,s.y,h/a*t)}else{w.copy(x.normals[t]).multiplyScalar(s.x);b.copy(x.binormals[t]).multiplyScalar(s.y);M.copy(y[t]).add(w).add(b);U(M.x,M.y,M.z)}}}for(let t=p-1;t>=0;t--){const e=t/p;const s=l*Math.cos(e*Math.PI/2);const i=u*Math.sin(e*Math.PI/2)+d;for(let t=0,e=I.length;t<e;t++){const e=C(I[t],R[t],i);U(e.x,e.y,h+s)}for(let t=0,e=_.length;t<e;t++){const e=_[t];P=E[t];for(let t=0,n=e.length;t<n;t++){const n=C(e[t],P[t],i);if(!g){U(n.x,n.y,h+s)}else{U(n.x,n.y+y[a-1].y,y[a-1].x+s)}}}}L();j();function L(){const t=i.length/3;if(c){let t=0;let e=B*t;for(let t=0;t<N;t++){const s=F[t];D(s[2]+e,s[1]+e,s[0]+e)}t=a+p*2;e=B*t;for(let t=0;t<N;t++){const s=F[t];D(s[0]+e,s[1]+e,s[2]+e)}}else{for(let t=0;t<N;t++){const e=F[t];D(e[2],e[1],e[0])}for(let t=0;t<N;t++){const e=F[t];D(e[0]+B*a,e[1]+B*a,e[2]+B*a)}}s.addGroup(t,i.length/3-t,0)}function j(){const t=i.length/3;let e=0;W(I,e);e+=I.length;for(let t=0,s=_.length;t<s;t++){const s=_[t];W(s,e);e+=s.length}s.addGroup(t,i.length/3-t,1)}function W(t,e){let s=t.length;while(--s>=0){const i=s;let n=s-1;if(n<0)n=t.length-1;for(let t=0,s=a+p*2;t<s;t++){const s=B*t;const r=B*(t+1);const o=e+i+s,a=e+n+s,h=e+n+r,c=e+i+r;H(o,a,h,c)}}}function U(t,e,s){r.push(t);r.push(e);r.push(s)}function D(t,e,n){q(t);q(e);q(n);const r=i.length/3;const o=m.generateTopUV(s,i,r-3,r-2,r-1);J(o[0]);J(o[1]);J(o[2])}function H(t,e,n,r){q(t);q(e);q(r);q(e);q(n);q(r);const o=i.length/3;const a=m.generateSideWallUV(s,i,o-6,o-3,o-2,o-1);J(a[0]);J(a[1]);J(a[3]);J(a[1]);J(a[2]);J(a[3])}function q(t){i.push(r[t*3+0]);i.push(r[t*3+1]);i.push(r[t*3+2])}function J(t){n.push(t.x);n.push(t.y)}}}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}toJSON(){const t=super.toJSON();const e=this.parameters.shapes;const s=this.parameters.options;return hR(e,s,t)}static fromJSON(t,e){const s=[];for(let i=0,n=t.shapes.length;i<n;i++){const n=e[t.shapes[i]];s.push(n)}const i=t.options.extrudePath;if(i!==undefined){t.options.extrudePath=new aK[i.type]().fromJSON(i)}return new hB(s,t.options)}}const hk={generateTopUV:function(t,e,s,i,n){const r=e[s*3];const o=e[s*3+1];const a=e[i*3];const h=e[i*3+1];const c=e[n*3];const l=e[n*3+1];return[new sZ(r,o),new sZ(a,h),new sZ(c,l)]},generateSideWallUV:function(t,e,s,i,n,r){const o=e[s*3];const a=e[s*3+1];const h=e[s*3+2];const c=e[i*3];const l=e[i*3+1];const u=e[i*3+2];const d=e[n*3];const p=e[n*3+1];const f=e[n*3+2];const m=e[r*3];const y=e[r*3+1];const g=e[r*3+2];if(Math.abs(a-l)<Math.abs(o-c)){return[new sZ(o,1-h),new sZ(c,1-u),new sZ(d,1-f),new sZ(m,1-g)]}else{return[new sZ(a,1-h),new sZ(l,1-u),new sZ(p,1-f),new sZ(y,1-g)]}}};function hR(t,e,s){s.shapes=[];if(Array.isArray(t)){for(let e=0,i=t.length;e<i;e++){const i=t[e];s.shapes.push(i.uuid)}}else{s.shapes.push(t.uuid)}s.options=Object.assign({},e);if(e.extrudePath!==undefined)s.options.extrudePath=e.extrudePath.toJSON();return s}class hE extends aw{constructor(t=1,e=0){const s=(1+Math.sqrt(5))/2;const i=[-1,s,0,1,s,0,-1,-s,0,1,-s,0,0,-1,s,0,1,s,0,-1,-s,0,1,-s,s,0,-1,s,0,1,-s,0,-1,-s,0,1];const n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,n,t,e);this.type="IcosahedronGeometry";this.parameters={radius:t,detail:e}}static fromJSON(t){return new hE(t.radius,t.detail)}}class hP extends n7{constructor(t=[new sZ(0,-.5),new sZ(.5,0),new sZ(0,.5)],e=12,s=0,i=Math.PI*2){super();this.type="LatheGeometry";this.parameters={points:t,segments:e,phiStart:s,phiLength:i};e=Math.floor(e);i=sz(i,0,Math.PI*2);const n=[];const r=[];const o=[];const a=[];const h=[];const c=1/e;const l=new iM;const u=new sZ;const d=new iM;const p=new iM;const f=new iM;let m=0;let y=0;for(let e=0;e<=t.length-1;e++){switch(e){case 0:m=t[e+1].x-t[e].x;y=t[e+1].y-t[e].y;d.x=y*1;d.y=-m;d.z=y*0;f.copy(d);d.normalize();a.push(d.x,d.y,d.z);break;case t.length-1:a.push(f.x,f.y,f.z);break;default:m=t[e+1].x-t[e].x;y=t[e+1].y-t[e].y;d.x=y*1;d.y=-m;d.z=y*0;p.copy(d);d.x+=f.x;d.y+=f.y;d.z+=f.z;d.normalize();a.push(d.x,d.y,d.z);f.copy(p)}}for(let n=0;n<=e;n++){const d=s+n*c*i;const p=Math.sin(d);const f=Math.cos(d);for(let s=0;s<=t.length-1;s++){l.x=t[s].x*p;l.y=t[s].y;l.z=t[s].x*f;r.push(l.x,l.y,l.z);u.x=n/e;u.y=s/(t.length-1);o.push(u.x,u.y);const i=a[3*s+0]*p;const c=a[3*s+1];const d=a[3*s+0]*f;h.push(i,c,d)}}for(let s=0;s<e;s++){for(let e=0;e<t.length-1;e++){const i=e+s*t.length;const r=i;const o=i+t.length;const a=i+t.length+1;const h=i+1;n.push(r,o,h);n.push(a,h,o)}}this.setIndex(n);this.setAttribute("position",new n1(r,3));this.setAttribute("uv",new n1(o,2));this.setAttribute("normal",new n1(h,3))}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new hP(t.points,t.segments,t.phiStart,t.phiLength)}}class hO extends aw{constructor(t=1,e=0){const s=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1];const i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(s,i,t,e);this.type="OctahedronGeometry";this.parameters={radius:t,detail:e}}static fromJSON(t){return new hO(t.radius,t.detail)}}class hF extends n7{constructor(t=1,e=1,s=1,i=1){super();this.type="PlaneGeometry";this.parameters={width:t,height:e,widthSegments:s,heightSegments:i};const n=t/2;const r=e/2;const o=Math.floor(s);const a=Math.floor(i);const h=o+1;const c=a+1;const l=t/o;const u=e/a;const d=[];const p=[];const f=[];const m=[];for(let t=0;t<c;t++){const e=t*u-r;for(let s=0;s<h;s++){const i=s*l-n;p.push(i,-e,0);f.push(0,0,1);m.push(s/o);m.push(1-t/a)}}for(let t=0;t<a;t++){for(let e=0;e<o;e++){const s=e+h*t;const i=e+h*(t+1);const n=e+1+h*(t+1);const r=e+1+h*t;d.push(s,i,r);d.push(i,n,r)}}this.setIndex(d);this.setAttribute("position",new n1(p,3));this.setAttribute("normal",new n1(f,3));this.setAttribute("uv",new n1(m,2))}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new hF(t.width,t.height,t.widthSegments,t.heightSegments)}}class hN extends n7{constructor(t=.5,e=1,s=32,i=1,n=0,r=Math.PI*2){super();this.type="RingGeometry";this.parameters={innerRadius:t,outerRadius:e,thetaSegments:s,phiSegments:i,thetaStart:n,thetaLength:r};s=Math.max(3,s);i=Math.max(1,i);const o=[];const a=[];const h=[];const c=[];let l=t;const u=(e-t)/i;const d=new iM;const p=new sZ;for(let t=0;t<=i;t++){for(let t=0;t<=s;t++){const i=n+t/s*r;d.x=l*Math.cos(i);d.y=l*Math.sin(i);a.push(d.x,d.y,d.z);h.push(0,0,1);p.x=(d.x/e+1)/2;p.y=(d.y/e+1)/2;c.push(p.x,p.y)}l+=u}for(let t=0;t<i;t++){const e=t*(s+1);for(let t=0;t<s;t++){const i=t+e;const n=i;const r=i+s+1;const a=i+s+2;const h=i+1;o.push(n,r,h);o.push(r,a,h)}}this.setIndex(o);this.setAttribute("position",new n1(a,3));this.setAttribute("normal",new n1(h,3));this.setAttribute("uv",new n1(c,2))}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new hN(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class hV extends n7{constructor(t=new a2([new sZ(0,.5),new sZ(-.5,-.5),new sZ(.5,-.5)]),e=12){super();this.type="ShapeGeometry";this.parameters={shapes:t,curveSegments:e};const s=[];const i=[];const n=[];const r=[];let o=0;let a=0;if(Array.isArray(t)===false){h(t)}else{for(let e=0;e<t.length;e++){h(t[e]);this.addGroup(o,a,e);o+=a;a=0}}this.setIndex(s);this.setAttribute("position",new n1(i,3));this.setAttribute("normal",new n1(n,3));this.setAttribute("uv",new n1(r,2));function h(t){const o=i.length/3;const h=t.extractPoints(e);let c=h.shape;const l=h.holes;if(hz.isClockWise(c)===false){c=c.reverse()}for(let t=0,e=l.length;t<e;t++){const e=l[t];if(hz.isClockWise(e)===true){l[t]=e.reverse()}}const u=hz.triangulateShape(c,l);for(let t=0,e=l.length;t<e;t++){const e=l[t];c=c.concat(e)}for(let t=0,e=c.length;t<e;t++){const e=c[t];i.push(e.x,e.y,0);n.push(0,0,1);r.push(e.x,e.y)}for(let t=0,e=u.length;t<e;t++){const e=u[t];const i=e[0]+o;const n=e[1]+o;const r=e[2]+o;s.push(i,n,r);a+=3}}}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}toJSON(){const t=super.toJSON();const e=this.parameters.shapes;return hL(e,t)}static fromJSON(t,e){const s=[];for(let i=0,n=t.shapes.length;i<n;i++){const n=e[t.shapes[i]];s.push(n)}return new hV(s,t.curveSegments)}}function hL(t,e){e.shapes=[];if(Array.isArray(t)){for(let s=0,i=t.length;s<i;s++){const i=t[s];e.shapes.push(i.uuid)}}else{e.shapes.push(t.uuid)}return e}class hj extends n7{constructor(t=1,e=32,s=16,i=0,n=Math.PI*2,r=0,o=Math.PI){super();this.type="SphereGeometry";this.parameters={radius:t,widthSegments:e,heightSegments:s,phiStart:i,phiLength:n,thetaStart:r,thetaLength:o};e=Math.max(3,Math.floor(e));s=Math.max(2,Math.floor(s));const a=Math.min(r+o,Math.PI);let h=0;const c=[];const l=new iM;const u=new iM;const d=[];const p=[];const f=[];const m=[];for(let d=0;d<=s;d++){const y=[];const g=d/s;let x=0;if(d===0&&r===0){x=.5/e}else if(d===s&&a===Math.PI){x=-.5/e}for(let s=0;s<=e;s++){const a=s/e;l.x=-t*Math.cos(i+a*n)*Math.sin(r+g*o);l.y=t*Math.cos(r+g*o);l.z=t*Math.sin(i+a*n)*Math.sin(r+g*o);p.push(l.x,l.y,l.z);u.copy(l).normalize();f.push(u.x,u.y,u.z);m.push(a+x,1-g);y.push(h++)}c.push(y)}for(let t=0;t<s;t++){for(let i=0;i<e;i++){const e=c[t][i+1];const n=c[t][i];const o=c[t+1][i];const h=c[t+1][i+1];if(t!==0||r>0)d.push(e,n,h);if(t!==s-1||a<Math.PI)d.push(n,o,h)}}this.setIndex(d);this.setAttribute("position",new n1(p,3));this.setAttribute("normal",new n1(f,3));this.setAttribute("uv",new n1(m,2))}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new hj(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class hW extends aw{constructor(t=1,e=0){const s=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1];const i=[2,1,0,0,3,2,1,3,0,2,3,1];super(s,i,t,e);this.type="TetrahedronGeometry";this.parameters={radius:t,detail:e}}static fromJSON(t){return new hW(t.radius,t.detail)}}class hU extends n7{constructor(t=1,e=.4,s=12,i=48,n=Math.PI*2){super();this.type="TorusGeometry";this.parameters={radius:t,tube:e,radialSegments:s,tubularSegments:i,arc:n};s=Math.floor(s);i=Math.floor(i);const r=[];const o=[];const a=[];const h=[];const c=new iM;const l=new iM;const u=new iM;for(let r=0;r<=s;r++){for(let d=0;d<=i;d++){const p=d/i*n;const f=r/s*Math.PI*2;l.x=(t+e*Math.cos(f))*Math.cos(p);l.y=(t+e*Math.cos(f))*Math.sin(p);l.z=e*Math.sin(f);o.push(l.x,l.y,l.z);c.x=t*Math.cos(p);c.y=t*Math.sin(p);u.subVectors(l,c).normalize();a.push(u.x,u.y,u.z);h.push(d/i);h.push(r/s)}}for(let t=1;t<=s;t++){for(let e=1;e<=i;e++){const s=(i+1)*t+e-1;const n=(i+1)*(t-1)+e-1;const o=(i+1)*(t-1)+e;const a=(i+1)*t+e;r.push(s,n,a);r.push(n,o,a)}}this.setIndex(r);this.setAttribute("position",new n1(o,3));this.setAttribute("normal",new n1(a,3));this.setAttribute("uv",new n1(h,2))}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new hU(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class hD extends n7{constructor(t=1,e=.4,s=64,i=8,n=2,r=3){super();this.type="TorusKnotGeometry";this.parameters={radius:t,tube:e,tubularSegments:s,radialSegments:i,p:n,q:r};s=Math.floor(s);i=Math.floor(i);const o=[];const a=[];const h=[];const c=[];const l=new iM;const u=new iM;const d=new iM;const p=new iM;const f=new iM;const m=new iM;const y=new iM;for(let o=0;o<=s;++o){const x=o/s*n*Math.PI*2;g(x,n,r,t,d);g(x+.01,n,r,t,p);m.subVectors(p,d);y.addVectors(p,d);f.crossVectors(m,y);y.crossVectors(f,m);f.normalize();y.normalize();for(let t=0;t<=i;++t){const n=t/i*Math.PI*2;const r=-e*Math.cos(n);const p=e*Math.sin(n);l.x=d.x+(r*y.x+p*f.x);l.y=d.y+(r*y.y+p*f.y);l.z=d.z+(r*y.z+p*f.z);a.push(l.x,l.y,l.z);u.subVectors(l,d).normalize();h.push(u.x,u.y,u.z);c.push(o/s);c.push(t/i)}}for(let t=1;t<=s;t++){for(let e=1;e<=i;e++){const s=(i+1)*(t-1)+(e-1);const n=(i+1)*t+(e-1);const r=(i+1)*t+e;const a=(i+1)*(t-1)+e;o.push(s,n,a);o.push(n,r,a)}}this.setIndex(o);this.setAttribute("position",new n1(a,3));this.setAttribute("normal",new n1(h,3));this.setAttribute("uv",new n1(c,2));function g(t,e,s,i,n){const r=Math.cos(t);const o=Math.sin(t);const a=s/e*t;const h=Math.cos(a);n.x=i*(2+h)*.5*r;n.y=i*(2+h)*o*.5;n.z=i*Math.sin(a)*.5}}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}static fromJSON(t){return new hD(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class hH extends n7{constructor(t=new a$(new iM(-1,-1,0),new iM(-1,1,0),new iM(1,1,0)),e=64,s=1,i=8,n=false){super();this.type="TubeGeometry";this.parameters={path:t,tubularSegments:e,radius:s,radialSegments:i,closed:n};const r=t.computeFrenetFrames(e,n);this.tangents=r.tangents;this.normals=r.normals;this.binormals=r.binormals;const o=new iM;const a=new iM;const h=new sZ;let c=new iM;const l=[];const u=[];const d=[];const p=[];f();this.setIndex(p);this.setAttribute("position",new n1(l,3));this.setAttribute("normal",new n1(u,3));this.setAttribute("uv",new n1(d,2));function f(){for(let t=0;t<e;t++){m(t)}m(n===false?e:0);g();y()}function m(n){c=t.getPointAt(n/e,c);const h=r.normals[n];const d=r.binormals[n];for(let t=0;t<=i;t++){const e=t/i*Math.PI*2;const n=Math.sin(e);const r=-Math.cos(e);a.x=r*h.x+n*d.x;a.y=r*h.y+n*d.y;a.z=r*h.z+n*d.z;a.normalize();u.push(a.x,a.y,a.z);o.x=c.x+s*a.x;o.y=c.y+s*a.y;o.z=c.z+s*a.z;l.push(o.x,o.y,o.z)}}function y(){for(let t=1;t<=e;t++){for(let e=1;e<=i;e++){const s=(i+1)*(t-1)+(e-1);const n=(i+1)*t+(e-1);const r=(i+1)*t+e;const o=(i+1)*(t-1)+e;p.push(s,n,o);p.push(n,r,o)}}}function g(){for(let t=0;t<=e;t++){for(let s=0;s<=i;s++){h.x=t/e;h.y=s/i;d.push(h.x,h.y)}}}}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}toJSON(){const t=super.toJSON();t.path=this.parameters.path.toJSON();return t}static fromJSON(t){return new hH(new aK[t.path.type]().fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class hq extends n7{constructor(t=null){super();this.type="WireframeGeometry";this.parameters={geometry:t};if(t!==null){const e=[];const s=new Set;const i=new iM;const n=new iM;if(t.index!==null){const r=t.attributes.position;const o=t.index;let a=t.groups;if(a.length===0){a=[{start:0,count:o.count,materialIndex:0}]}for(let t=0,h=a.length;t<h;++t){const h=a[t];const c=h.start;const l=h.count;for(let t=c,a=c+l;t<a;t+=3){for(let a=0;a<3;a++){const h=o.getX(t+a);const c=o.getX(t+(a+1)%3);i.fromBufferAttribute(r,h);n.fromBufferAttribute(r,c);if(hJ(i,n,s)===true){e.push(i.x,i.y,i.z);e.push(n.x,n.y,n.z)}}}}}else{const r=t.attributes.position;for(let t=0,o=r.count/3;t<o;t++){for(let o=0;o<3;o++){const a=3*t+o;const h=3*t+(o+1)%3;i.fromBufferAttribute(r,a);n.fromBufferAttribute(r,h);if(hJ(i,n,s)===true){e.push(i.x,i.y,i.z);e.push(n.x,n.y,n.z)}}}}this.setAttribute("position",new n1(e,3))}}copy(t){super.copy(t);this.parameters=Object.assign({},t.parameters);return this}}function hJ(t,e,s){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;const n=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;if(s.has(i)===true||s.has(n)===true){return false}else{s.add(i);s.add(n);return true}}var hX=Object.freeze({__proto__:null,BoxGeometry:rf,CapsuleGeometry:ay,CircleGeometry:ag,ConeGeometry:ab,CylinderGeometry:ax,DodecahedronGeometry:aM,EdgesGeometry:aT,ExtrudeGeometry:hB,IcosahedronGeometry:hE,LatheGeometry:hP,OctahedronGeometry:hO,PlaneGeometry:hF,PolyhedronGeometry:aw,RingGeometry:hN,ShapeGeometry:hV,SphereGeometry:hj,TetrahedronGeometry:hW,TorusGeometry:hU,TorusKnotGeometry:hD,TubeGeometry:hH,WireframeGeometry:hq});class hY extends nF{constructor(t){super();this.isShadowMaterial=true;this.type="ShadowMaterial";this.color=new nE(0);this.transparent=true;this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.color.copy(t.color);this.fog=t.fog;return this}}class hZ extends rv{constructor(t){super(t);this.isRawShaderMaterial=true;this.type="RawShaderMaterial"}}class hG extends nF{constructor(t){super();this.isMeshStandardMaterial=true;this.type="MeshStandardMaterial";this.defines={"STANDARD":""};this.color=new nE(0xffffff);this.roughness=1;this.metalness=0;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new nE(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=eV;this.normalScale=new sZ(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.roughnessMap=null;this.metalnessMap=null;this.alphaMap=null;this.envMap=null;this.envMapRotation=new i8;this.envMapIntensity=1;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.flatShading=false;this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.defines={"STANDARD":""};this.color.copy(t.color);this.roughness=t.roughness;this.metalness=t.metalness;this.map=t.map;this.lightMap=t.lightMap;this.lightMapIntensity=t.lightMapIntensity;this.aoMap=t.aoMap;this.aoMapIntensity=t.aoMapIntensity;this.emissive.copy(t.emissive);this.emissiveMap=t.emissiveMap;this.emissiveIntensity=t.emissiveIntensity;this.bumpMap=t.bumpMap;this.bumpScale=t.bumpScale;this.normalMap=t.normalMap;this.normalMapType=t.normalMapType;this.normalScale.copy(t.normalScale);this.displacementMap=t.displacementMap;this.displacementScale=t.displacementScale;this.displacementBias=t.displacementBias;this.roughnessMap=t.roughnessMap;this.metalnessMap=t.metalnessMap;this.alphaMap=t.alphaMap;this.envMap=t.envMap;this.envMapRotation.copy(t.envMapRotation);this.envMapIntensity=t.envMapIntensity;this.wireframe=t.wireframe;this.wireframeLinewidth=t.wireframeLinewidth;this.wireframeLinecap=t.wireframeLinecap;this.wireframeLinejoin=t.wireframeLinejoin;this.flatShading=t.flatShading;this.fog=t.fog;return this}}class h$ extends hG{constructor(t){super();this.isMeshPhysicalMaterial=true;this.defines={"STANDARD":"","PHYSICAL":""};this.type="MeshPhysicalMaterial";this.anisotropyRotation=0;this.anisotropyMap=null;this.clearcoatMap=null;this.clearcoatRoughness=0;this.clearcoatRoughnessMap=null;this.clearcoatNormalScale=new sZ(1,1);this.clearcoatNormalMap=null;this.ior=1.5;Object.defineProperty(this,"reflectivity",{get:function(){return sz(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}});this.iridescenceMap=null;this.iridescenceIOR=1.3;this.iridescenceThicknessRange=[100,400];this.iridescenceThicknessMap=null;this.sheenColor=new nE(0);this.sheenColorMap=null;this.sheenRoughness=1;this.sheenRoughnessMap=null;this.transmissionMap=null;this.thickness=0;this.thicknessMap=null;this.attenuationDistance=Infinity;this.attenuationColor=new nE(1,1,1);this.specularIntensity=1;this.specularIntensityMap=null;this.specularColor=new nE(1,1,1);this.specularColorMap=null;this._anisotropy=0;this._clearcoat=0;this._dispersion=0;this._iridescence=0;this._sheen=0;this._transmission=0;this.setValues(t)}get anisotropy(){return this._anisotropy}set anisotropy(t){if(this._anisotropy>0!==t>0){this.version++}this._anisotropy=t}get clearcoat(){return this._clearcoat}set clearcoat(t){if(this._clearcoat>0!==t>0){this.version++}this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){if(this._iridescence>0!==t>0){this.version++}this._iridescence=t}get dispersion(){return this._dispersion}set dispersion(t){if(this._dispersion>0!==t>0){this.version++}this._dispersion=t}get sheen(){return this._sheen}set sheen(t){if(this._sheen>0!==t>0){this.version++}this._sheen=t}get transmission(){return this._transmission}set transmission(t){if(this._transmission>0!==t>0){this.version++}this._transmission=t}copy(t){super.copy(t);this.defines={"STANDARD":"","PHYSICAL":""};this.anisotropy=t.anisotropy;this.anisotropyRotation=t.anisotropyRotation;this.anisotropyMap=t.anisotropyMap;this.clearcoat=t.clearcoat;this.clearcoatMap=t.clearcoatMap;this.clearcoatRoughness=t.clearcoatRoughness;this.clearcoatRoughnessMap=t.clearcoatRoughnessMap;this.clearcoatNormalMap=t.clearcoatNormalMap;this.clearcoatNormalScale.copy(t.clearcoatNormalScale);this.dispersion=t.dispersion;this.ior=t.ior;this.iridescence=t.iridescence;this.iridescenceMap=t.iridescenceMap;this.iridescenceIOR=t.iridescenceIOR;this.iridescenceThicknessRange=[...t.iridescenceThicknessRange];this.iridescenceThicknessMap=t.iridescenceThicknessMap;this.sheen=t.sheen;this.sheenColor.copy(t.sheenColor);this.sheenColorMap=t.sheenColorMap;this.sheenRoughness=t.sheenRoughness;this.sheenRoughnessMap=t.sheenRoughnessMap;this.transmission=t.transmission;this.transmissionMap=t.transmissionMap;this.thickness=t.thickness;this.thicknessMap=t.thicknessMap;this.attenuationDistance=t.attenuationDistance;this.attenuationColor.copy(t.attenuationColor);this.specularIntensity=t.specularIntensity;this.specularIntensityMap=t.specularIntensityMap;this.specularColor.copy(t.specularColor);this.specularColorMap=t.specularColorMap;return this}}class hQ extends nF{constructor(t){super();this.isMeshPhongMaterial=true;this.type="MeshPhongMaterial";this.color=new nE(0xffffff);this.specular=new nE(1118481);this.shininess=30;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new nE(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=eV;this.normalScale=new sZ(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.envMapRotation=new i8;this.combine=$;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.flatShading=false;this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.color.copy(t.color);this.specular.copy(t.specular);this.shininess=t.shininess;this.map=t.map;this.lightMap=t.lightMap;this.lightMapIntensity=t.lightMapIntensity;this.aoMap=t.aoMap;this.aoMapIntensity=t.aoMapIntensity;this.emissive.copy(t.emissive);this.emissiveMap=t.emissiveMap;this.emissiveIntensity=t.emissiveIntensity;this.bumpMap=t.bumpMap;this.bumpScale=t.bumpScale;this.normalMap=t.normalMap;this.normalMapType=t.normalMapType;this.normalScale.copy(t.normalScale);this.displacementMap=t.displacementMap;this.displacementScale=t.displacementScale;this.displacementBias=t.displacementBias;this.specularMap=t.specularMap;this.alphaMap=t.alphaMap;this.envMap=t.envMap;this.envMapRotation.copy(t.envMapRotation);this.combine=t.combine;this.reflectivity=t.reflectivity;this.refractionRatio=t.refractionRatio;this.wireframe=t.wireframe;this.wireframeLinewidth=t.wireframeLinewidth;this.wireframeLinecap=t.wireframeLinecap;this.wireframeLinejoin=t.wireframeLinejoin;this.flatShading=t.flatShading;this.fog=t.fog;return this}}class hK extends nF{constructor(t){super();this.isMeshToonMaterial=true;this.defines={"TOON":""};this.type="MeshToonMaterial";this.color=new nE(0xffffff);this.map=null;this.gradientMap=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new nE(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=eV;this.normalScale=new sZ(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.color.copy(t.color);this.map=t.map;this.gradientMap=t.gradientMap;this.lightMap=t.lightMap;this.lightMapIntensity=t.lightMapIntensity;this.aoMap=t.aoMap;this.aoMapIntensity=t.aoMapIntensity;this.emissive.copy(t.emissive);this.emissiveMap=t.emissiveMap;this.emissiveIntensity=t.emissiveIntensity;this.bumpMap=t.bumpMap;this.bumpScale=t.bumpScale;this.normalMap=t.normalMap;this.normalMapType=t.normalMapType;this.normalScale.copy(t.normalScale);this.displacementMap=t.displacementMap;this.displacementScale=t.displacementScale;this.displacementBias=t.displacementBias;this.alphaMap=t.alphaMap;this.wireframe=t.wireframe;this.wireframeLinewidth=t.wireframeLinewidth;this.wireframeLinecap=t.wireframeLinecap;this.wireframeLinejoin=t.wireframeLinejoin;this.fog=t.fog;return this}}class h0 extends nF{constructor(t){super();this.isMeshNormalMaterial=true;this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=eV;this.normalScale=new sZ(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=false;this.wireframeLinewidth=1;this.flatShading=false;this.setValues(t)}copy(t){super.copy(t);this.bumpMap=t.bumpMap;this.bumpScale=t.bumpScale;this.normalMap=t.normalMap;this.normalMapType=t.normalMapType;this.normalScale.copy(t.normalScale);this.displacementMap=t.displacementMap;this.displacementScale=t.displacementScale;this.displacementBias=t.displacementBias;this.wireframe=t.wireframe;this.wireframeLinewidth=t.wireframeLinewidth;this.flatShading=t.flatShading;return this}}class h1 extends nF{constructor(t){super();this.isMeshLambertMaterial=true;this.type="MeshLambertMaterial";this.color=new nE(0xffffff);this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new nE(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=eV;this.normalScale=new sZ(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.envMapRotation=new i8;this.combine=$;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.flatShading=false;this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.color.copy(t.color);this.map=t.map;this.lightMap=t.lightMap;this.lightMapIntensity=t.lightMapIntensity;this.aoMap=t.aoMap;this.aoMapIntensity=t.aoMapIntensity;this.emissive.copy(t.emissive);this.emissiveMap=t.emissiveMap;this.emissiveIntensity=t.emissiveIntensity;this.bumpMap=t.bumpMap;this.bumpScale=t.bumpScale;this.normalMap=t.normalMap;this.normalMapType=t.normalMapType;this.normalScale.copy(t.normalScale);this.displacementMap=t.displacementMap;this.displacementScale=t.displacementScale;this.displacementBias=t.displacementBias;this.specularMap=t.specularMap;this.alphaMap=t.alphaMap;this.envMap=t.envMap;this.envMapRotation.copy(t.envMapRotation);this.combine=t.combine;this.reflectivity=t.reflectivity;this.refractionRatio=t.refractionRatio;this.wireframe=t.wireframe;this.wireframeLinewidth=t.wireframeLinewidth;this.wireframeLinecap=t.wireframeLinecap;this.wireframeLinejoin=t.wireframeLinejoin;this.flatShading=t.flatShading;this.fog=t.fog;return this}}class h2 extends nF{constructor(t){super();this.isMeshDepthMaterial=true;this.type="MeshDepthMaterial";this.depthPacking=eP;this.map=null;this.alphaMap=null;this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=false;this.wireframeLinewidth=1;this.setValues(t)}copy(t){super.copy(t);this.depthPacking=t.depthPacking;this.map=t.map;this.alphaMap=t.alphaMap;this.displacementMap=t.displacementMap;this.displacementScale=t.displacementScale;this.displacementBias=t.displacementBias;this.wireframe=t.wireframe;this.wireframeLinewidth=t.wireframeLinewidth;return this}}class h3 extends nF{constructor(t){super();this.isMeshDistanceMaterial=true;this.type="MeshDistanceMaterial";this.map=null;this.alphaMap=null;this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.setValues(t)}copy(t){super.copy(t);this.map=t.map;this.alphaMap=t.alphaMap;this.displacementMap=t.displacementMap;this.displacementScale=t.displacementScale;this.displacementBias=t.displacementBias;return this}}class h5 extends nF{constructor(t){super();this.isMeshMatcapMaterial=true;this.defines={"MATCAP":""};this.type="MeshMatcapMaterial";this.color=new nE(0xffffff);this.matcap=null;this.map=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=eV;this.normalScale=new sZ(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.flatShading=false;this.fog=true;this.setValues(t)}copy(t){super.copy(t);this.defines={"MATCAP":""};this.color.copy(t.color);this.matcap=t.matcap;this.map=t.map;this.bumpMap=t.bumpMap;this.bumpScale=t.bumpScale;this.normalMap=t.normalMap;this.normalMapType=t.normalMapType;this.normalScale.copy(t.normalScale);this.displacementMap=t.displacementMap;this.displacementScale=t.displacementScale;this.displacementBias=t.displacementBias;this.alphaMap=t.alphaMap;this.flatShading=t.flatShading;this.fog=t.fog;return this}}class h4 extends oG{constructor(t){super();this.isLineDashedMaterial=true;this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(t)}copy(t){super.copy(t);this.scale=t.scale;this.dashSize=t.dashSize;this.gapSize=t.gapSize;return this}}function h6(t,e){if(!t||t.constructor===e)return t;if(typeof e.BYTES_PER_ELEMENT==="number"){return new e(t)}return Array.prototype.slice.call(t)}function h8(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function h9(t){function e(e,s){return t[e]-t[s]}const s=t.length;const i=new Array(s);for(let t=0;t!==s;++t)i[t]=t;i.sort(e);return i}function h7(t,e,s){const i=t.length;const n=new t.constructor(i);for(let r=0,o=0;o!==i;++r){const i=s[r]*e;for(let s=0;s!==e;++s){n[o++]=t[i+s]}}return n}function ct(t,e,s,i){let n=1,r=t[0];while(r!==undefined&&r[i]===undefined){r=t[n++]}if(r===undefined)return;let o=r[i];if(o===undefined)return;if(Array.isArray(o)){do{o=r[i];if(o!==undefined){e.push(r.time);s.push(...o)}r=t[n++]}while(r!==undefined)}else if(o.toArray!==undefined){do{o=r[i];if(o!==undefined){e.push(r.time);o.toArray(s,s.length)}r=t[n++]}while(r!==undefined)}else{do{o=r[i];if(o!==undefined){e.push(r.time);s.push(o)}r=t[n++]}while(r!==undefined)}}function ce(t,e,s,i,n=30){const r=t.clone();r.name=e;const o=[];for(let t=0;t<r.tracks.length;++t){const e=r.tracks[t];const a=e.getValueSize();const h=[];const c=[];for(let t=0;t<e.times.length;++t){const r=e.times[t]*n;if(r<s||r>=i)continue;h.push(e.times[t]);for(let s=0;s<a;++s){c.push(e.values[t*a+s])}}if(h.length===0)continue;e.times=h6(h,e.times.constructor);e.values=h6(c,e.values.constructor);o.push(e)}r.tracks=o;let a=Infinity;for(let t=0;t<r.tracks.length;++t){if(a>r.tracks[t].times[0]){a=r.tracks[t].times[0]}}for(let t=0;t<r.tracks.length;++t){r.tracks[t].shift(-1*a)}r.resetDuration();return r}function cs(t,e=0,s=t,i=30){if(i<=0)i=30;const n=s.tracks.length;const r=e/i;for(let e=0;e<n;++e){const i=s.tracks[e];const n=i.ValueTypeName;if(n==="bool"||n==="string")continue;const o=t.tracks.find(function(t){return t.name===i.name&&t.ValueTypeName===n});if(o===undefined)continue;let a=0;const h=i.getValueSize();if(i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline){a=h/3}let c=0;const l=o.getValueSize();if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline){c=l/3}const u=i.times.length-1;let d;if(r<=i.times[0]){const t=a;const e=h-a;d=i.values.slice(t,e)}else if(r>=i.times[u]){const t=u*h+a;const e=t+h-a;d=i.values.slice(t,e)}else{const t=i.createInterpolant();const e=a;const s=h-a;t.evaluate(r);d=t.resultBuffer.slice(e,s)}if(n==="quaternion"){const t=new iw().fromArray(d).normalize().conjugate();t.toArray(d)}const p=o.times.length;for(let t=0;t<p;++t){const e=t*l+c;if(n==="quaternion"){iw.multiplyQuaternionsFlat(o.values,e,d,0,o.values,e)}else{const t=l-c*2;for(let s=0;s<t;++s){o.values[e+s]-=d[s]}}}}t.blendMode=eB;return t}class ci{static convertArray(t,e){return h6(t,e)}static isTypedArray(t){return h8(t)}static getKeyframeOrder(t){return h9(t)}static sortedArray(t,e,s){return h7(t,e,s)}static flattenJSON(t,e,s,i){ct(t,e,s,i)}static subclip(t,e,s,i,n=30){return ce(t,e,s,i,n)}static makeClipAdditive(t,e=0,s=t,i=30){return cs(t,e,s,i)}}class cn{constructor(t,e,s,i){this.parameterPositions=t;this._cachedIndex=0;this.resultBuffer=i!==undefined?i:new e.constructor(s);this.sampleValues=e;this.valueSize=s;this.settings=null;this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let s=this._cachedIndex,i=e[s],n=e[s-1];t:{e:{let r;s:{i:if(!(t<i)){for(let r=s+2;;){if(i===undefined){if(t<n)break i;s=e.length;this._cachedIndex=s;return this.copySampleValue_(s-1)}if(s===r)break;n=i;i=e[++s];if(t<i){break e}}r=e.length;break s}if(!(t>=n)){const o=e[1];if(t<o){s=2;n=o}for(let r=s-2;;){if(n===undefined){this._cachedIndex=0;return this.copySampleValue_(0)}if(s===r)break;i=n;n=e[--s-1];if(t>=n){break e}}r=s;s=0;break s}break t}while(s<r){const i=s+r>>>1;if(t<e[i]){r=i}else{s=i+1}}i=e[s];n=e[s-1];if(n===undefined){this._cachedIndex=0;return this.copySampleValue_(0)}if(i===undefined){s=e.length;this._cachedIndex=s;return this.copySampleValue_(s-1)}}this._cachedIndex=s;this.intervalChanged_(s,n,i)}return this.interpolate_(s,n,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,s=this.sampleValues,i=this.valueSize,n=t*i;for(let t=0;t!==i;++t){e[t]=s[n+t]}return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class cr extends cn{constructor(t,e,s,i){super(t,e,s,i);this._weightPrev=-0;this._offsetPrev=-0;this._weightNext=-0;this._offsetNext=-0;this.DefaultSettings_={endingStart:eT,endingEnd:eT}}intervalChanged_(t,e,s){const i=this.parameterPositions;let n=t-2,r=t+1,o=i[n],a=i[r];if(o===undefined){switch(this.getSettings_().endingStart){case ez:n=t;o=2*e-s;break;case eI:n=i.length-2;o=e+i[n]-i[n+1];break;default:n=t;o=s}}if(a===undefined){switch(this.getSettings_().endingEnd){case ez:r=t;a=2*s-e;break;case eI:r=1;a=s+i[1]-i[0];break;default:r=t-1;a=e}}const h=(s-e)*.5,c=this.valueSize;this._weightPrev=h/(e-o);this._weightNext=h/(a-s);this._offsetPrev=n*c;this._offsetNext=r*c}interpolate_(t,e,s,i){const n=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=t*o,h=a-o,c=this._offsetPrev,l=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(s-e)/(i-e),f=p*p,m=f*p;const y=-u*m+2*u*f-u*p;const g=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1;const x=(-1-d)*m+(1.5+d)*f+.5*p;const b=d*m-d*f;for(let t=0;t!==o;++t){n[t]=y*r[c+t]+g*r[h+t]+x*r[a+t]+b*r[l+t]}return n}}class co extends cn{constructor(t,e,s,i){super(t,e,s,i)}interpolate_(t,e,s,i){const n=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=t*o,h=a-o,c=(s-e)/(i-e),l=1-c;for(let t=0;t!==o;++t){n[t]=r[h+t]*l+r[a+t]*c}return n}}class ca extends cn{constructor(t,e,s,i){super(t,e,s,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class ch{constructor(t,e,s,i){if(t===undefined)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===undefined||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t;this.times=h6(e,this.TimeBufferType);this.values=h6(s,this.ValueBufferType);this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let s;if(e.toJSON!==this.toJSON){s=e.toJSON(t)}else{s={"name":t.name,"times":h6(t.times,Array),"values":h6(t.values,Array)};const e=t.getInterpolation();if(e!==t.DefaultInterpolation){s.interpolation=e}}s.type=t.ValueTypeName;return s}InterpolantFactoryMethodDiscrete(t){return new ca(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new co(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new cr(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case eS:e=this.InterpolantFactoryMethodDiscrete;break;case e_:e=this.InterpolantFactoryMethodLinear;break;case eA:e=this.InterpolantFactoryMethodSmooth;break}if(e===undefined){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===undefined){if(t!==this.DefaultInterpolation){this.setInterpolation(this.DefaultInterpolation)}else{throw new Error(e)}}console.warn("THREE.KeyframeTrack:",e);return this}this.createInterpolant=e;return this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return eS;case this.InterpolantFactoryMethodLinear:return e_;case this.InterpolantFactoryMethodSmooth:return eA}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const e=this.times;for(let s=0,i=e.length;s!==i;++s){e[s]+=t}}return this}scale(t){if(t!==1){const e=this.times;for(let s=0,i=e.length;s!==i;++s){e[s]*=t}}return this}trim(t,e){const s=this.times,i=s.length;let n=0,r=i-1;while(n!==i&&s[n]<t){++n}while(r!==-1&&s[r]>e){--r}++r;if(n!==0||r!==i){if(n>=r){r=Math.max(r,1);n=r-1}const t=this.getValueSize();this.times=s.slice(n,r);this.values=this.values.slice(n*t,r*t)}return this}validate(){let t=true;const e=this.getValueSize();if(e-Math.floor(e)!==0){console.error("THREE.KeyframeTrack: Invalid value size in track.",this);t=false}const s=this.times,i=this.values,n=s.length;if(n===0){console.error("THREE.KeyframeTrack: Track is empty.",this);t=false}let r=null;for(let e=0;e!==n;e++){const i=s[e];if(typeof i==="number"&&isNaN(i)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,i);t=false;break}if(r!==null&&r>i){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,i,r);t=false;break}r=i}if(i!==undefined){if(h8(i)){for(let e=0,s=i.length;e!==s;++e){const s=i[e];if(isNaN(s)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,s);t=false;break}}}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),s=this.getValueSize(),i=this.getInterpolation()===eA,n=t.length-1;let r=1;for(let o=1;o<n;++o){let n=false;const a=t[o];const h=t[o+1];if(a!==h&&(o!==1||a!==t[0])){if(!i){const t=o*s,i=t-s,r=t+s;for(let o=0;o!==s;++o){const s=e[t+o];if(s!==e[i+o]||s!==e[r+o]){n=true;break}}}else{n=true}}if(n){if(o!==r){t[r]=t[o];const i=o*s,n=r*s;for(let t=0;t!==s;++t){e[n+t]=e[i+t]}}++r}}if(n>0){t[r]=t[n];for(let t=n*s,i=r*s,o=0;o!==s;++o){e[i+o]=e[t+o]}++r}if(r!==t.length){this.times=t.slice(0,r);this.values=e.slice(0,r*s)}else{this.times=t;this.values=e}return this}clone(){const t=this.times.slice();const e=this.values.slice();const s=this.constructor;const i=new s(this.name,t,e);i.createInterpolant=this.createInterpolant;return i}}ch.prototype.ValueTypeName="";ch.prototype.TimeBufferType=Float32Array;ch.prototype.ValueBufferType=Float32Array;ch.prototype.DefaultInterpolation=e_;class cc extends ch{constructor(t,e,s){super(t,e,s)}}cc.prototype.ValueTypeName="bool";cc.prototype.ValueBufferType=Array;cc.prototype.DefaultInterpolation=eS;cc.prototype.InterpolantFactoryMethodLinear=undefined;cc.prototype.InterpolantFactoryMethodSmooth=undefined;class cl extends ch{constructor(t,e,s,i){super(t,e,s,i)}}cl.prototype.ValueTypeName="color";class cu extends ch{constructor(t,e,s,i){super(t,e,s,i)}}cu.prototype.ValueTypeName="number";class cd extends cn{constructor(t,e,s,i){super(t,e,s,i)}interpolate_(t,e,s,i){const n=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=(s-e)/(i-e);let h=t*o;for(let t=h+o;h!==t;h+=4){iw.slerpFlat(n,0,r,h-o,r,h,a)}return n}}class cp extends ch{constructor(t,e,s,i){super(t,e,s,i)}InterpolantFactoryMethodLinear(t){return new cd(this.times,this.values,this.getValueSize(),t)}}cp.prototype.ValueTypeName="quaternion";cp.prototype.InterpolantFactoryMethodSmooth=undefined;class cf extends ch{constructor(t,e,s){super(t,e,s)}}cf.prototype.ValueTypeName="string";cf.prototype.ValueBufferType=Array;cf.prototype.DefaultInterpolation=eS;cf.prototype.InterpolantFactoryMethodLinear=undefined;cf.prototype.InterpolantFactoryMethodSmooth=undefined;class cm extends ch{constructor(t,e,s,i){super(t,e,s,i)}}cm.prototype.ValueTypeName="vector";class cy{constructor(t="",e=-1,s=[],i=eC){this.name=t;this.tracks=s;this.duration=e;this.blendMode=i;this.uuid=sT();if(this.duration<0){this.resetDuration()}}static parse(t){const e=[],s=t.tracks,i=1/(t.fps||1);for(let t=0,n=s.length;t!==n;++t){e.push(cx(s[t]).scale(i))}const n=new this(t.name,t.duration,e,t.blendMode);n.uuid=t.uuid;return n}static toJSON(t){const e=[],s=t.tracks;const i={"name":t.name,"duration":t.duration,"tracks":e,"uuid":t.uuid,"blendMode":t.blendMode};for(let t=0,i=s.length;t!==i;++t){e.push(ch.toJSON(s[t]))}return i}static CreateFromMorphTargetSequence(t,e,s,i){const n=e.length;const r=[];for(let t=0;t<n;t++){let o=[];let a=[];o.push((t+n-1)%n,t,(t+1)%n);a.push(0,1,0);const h=h9(o);o=h7(o,1,h);a=h7(a,1,h);if(!i&&o[0]===0){o.push(n);a.push(a[0])}r.push(new cu(".morphTargetInfluences["+e[t].name+"]",o,a).scale(1/s))}return new this(t,-1,r)}static findByName(t,e){let s=t;if(!Array.isArray(t)){const e=t;s=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<s.length;t++){if(s[t].name===e){return s[t]}}return null}static CreateClipsFromMorphTargetSequences(t,e,s){const i={};const n=/^([\w-]*?)([\d]+)$/;for(let e=0,s=t.length;e<s;e++){const s=t[e];const r=s.name.match(n);if(r&&r.length>1){const t=r[1];let e=i[t];if(!e){i[t]=e=[]}e.push(s)}}const r=[];for(const t in i){r.push(this.CreateFromMorphTargetSequence(t,i[t],e,s))}return r}static parseAnimation(t,e){console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185");if(!t){console.error("THREE.AnimationClip: No animation in JSONLoader data.");return null}const s=function(t,e,s,i,n){if(s.length!==0){const r=[];const o=[];ct(s,r,o,i);if(r.length!==0){n.push(new t(e,r,o))}}};const i=[];const n=t.name||"default";const r=t.fps||30;const o=t.blendMode;let a=t.length||-1;const h=t.hierarchy||[];for(let t=0;t<h.length;t++){const n=h[t].keys;if(!n||n.length===0)continue;if(n[0].morphTargets){const t={};let e;for(e=0;e<n.length;e++){if(n[e].morphTargets){for(let s=0;s<n[e].morphTargets.length;s++){t[n[e].morphTargets[s]]=-1}}}for(const s in t){const t=[];const r=[];for(let i=0;i!==n[e].morphTargets.length;++i){const i=n[e];t.push(i.time);r.push(i.morphTarget===s?1:0)}i.push(new cu(".morphTargetInfluence["+s+"]",t,r))}a=t.length*r}else{const r=".bones["+e[t].name+"]";s(cm,r+".position",n,"pos",i);s(cp,r+".quaternion",n,"rot",i);s(cm,r+".scale",n,"scl",i)}}if(i.length===0){return null}const c=new this(n,a,i,o);return c}resetDuration(){const t=this.tracks;let e=0;for(let s=0,i=t.length;s!==i;++s){const t=this.tracks[s];e=Math.max(e,t.times[t.times.length-1])}this.duration=e;return this}trim(){for(let t=0;t<this.tracks.length;t++){this.tracks[t].trim(0,this.duration)}return this}validate(){let t=true;for(let e=0;e<this.tracks.length;e++){t=t&&this.tracks[e].validate()}return t}optimize(){for(let t=0;t<this.tracks.length;t++){this.tracks[t].optimize()}return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++){t.push(this.tracks[e].clone())}return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function cg(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return cu;case"vector":case"vector2":case"vector3":case"vector4":return cm;case"color":return cl;case"quaternion":return cp;case"bool":case"boolean":return cc;case"string":return cf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function cx(t){if(t.type===undefined){throw new Error("THREE.KeyframeTrack: track type undefined, can not parse")}const e=cg(t.type);if(t.times===undefined){const e=[],s=[];ct(t.keys,e,s,"value");t.times=e;t.values=s}if(e.parse!==undefined){return e.parse(t)}else{return new e(t.name,t.times,t.values,t.interpolation)}}const cb={enabled:false,files:{},add:function(t,e){if(this.enabled===false)return;this.files[t]=e},get:function(t){if(this.enabled===false)return;return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class cw{constructor(t,e,s){const i=this;let n=false;let r=0;let o=0;let a=undefined;const h=[];this.onStart=undefined;this.onLoad=t;this.onProgress=e;this.onError=s;this.itemStart=function(t){o++;if(n===false){if(i.onStart!==undefined){i.onStart(t,r,o)}}n=true};this.itemEnd=function(t){r++;if(i.onProgress!==undefined){i.onProgress(t,r,o)}if(r===o){n=false;if(i.onLoad!==undefined){i.onLoad()}}};this.itemError=function(t){if(i.onError!==undefined){i.onError(t)}};this.resolveURL=function(t){if(a){return a(t)}return t};this.setURLModifier=function(t){a=t;return this};this.addHandler=function(t,e){h.push(t,e);return this};this.removeHandler=function(t){const e=h.indexOf(t);if(e!==-1){h.splice(e,2)}return this};this.getHandler=function(t){for(let e=0,s=h.length;e<s;e+=2){const s=h[e];const i=h[e+1];if(s.global)s.lastIndex=0;if(s.test(t)){return i}}return null}}}const cM=new cw;class cv{constructor(t){this.manager=t!==undefined?t:cM;this.crossOrigin="anonymous";this.withCredentials=false;this.path="";this.resourcePath="";this.requestHeader={}}load(){}loadAsync(t,e){const s=this;return new Promise(function(i,n){s.load(t,i,e,n)})}parse(){}setCrossOrigin(t){this.crossOrigin=t;return this}setWithCredentials(t){this.withCredentials=t;return this}setPath(t){this.path=t;return this}setResourcePath(t){this.resourcePath=t;return this}setRequestHeader(t){this.requestHeader=t;return this}}cv.DEFAULT_MATERIAL_NAME="__DEFAULT";const cS={};class c_ extends Error{constructor(t,e){super(t);this.response=e}}class cA extends cv{constructor(t){super(t);this.mimeType="";this.responseType=""}load(t,e,s,i){if(t===undefined)t="";if(this.path!==undefined)t=this.path+t;t=this.manager.resolveURL(t);const n=cb.get(t);if(n!==undefined){this.manager.itemStart(t);setTimeout(()=>{if(e)e(n);this.manager.itemEnd(t)},0);return n}if(cS[t]!==undefined){cS[t].push({onLoad:e,onProgress:s,onError:i});return}cS[t]=[];cS[t].push({onLoad:e,onProgress:s,onError:i});const r=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});const o=this.mimeType;const a=this.responseType;fetch(r).then(e=>{if(e.status===200||e.status===0){if(e.status===0){console.warn("THREE.FileLoader: HTTP Status 0 received.")}if(typeof ReadableStream==="undefined"||e.body===undefined||e.body.getReader===undefined){return e}const s=cS[t];const i=e.body.getReader();const n=e.headers.get("X-File-Size")||e.headers.get("Content-Length");const r=n?parseInt(n):0;const o=r!==0;let a=0;const h=new ReadableStream({start(t){e();function e(){i.read().then(({done:i,value:n})=>{if(i){t.close()}else{a+=n.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:r});for(let t=0,e=s.length;t<e;t++){const e=s[t];if(e.onProgress)e.onProgress(i)}t.enqueue(n);e()}},e=>{t.error(e)})}}});return new Response(h)}else{throw new c_(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`,e)}}).then(t=>{switch(a){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then(t=>{const e=new DOMParser;return e.parseFromString(t,o)});case"json":return t.json();default:if(o===""){return t.text()}else{const e=/charset="?([^;"\s]*)"?/i;const s=e.exec(o);const i=s&&s[1]?s[1].toLowerCase():undefined;const n=new TextDecoder(i);return t.arrayBuffer().then(t=>n.decode(t))}}}).then(e=>{cb.add(t,e);const s=cS[t];delete cS[t];for(let t=0,i=s.length;t<i;t++){const i=s[t];if(i.onLoad)i.onLoad(e)}}).catch(e=>{const s=cS[t];if(s===undefined){this.manager.itemError(t);throw e}delete cS[t];for(let t=0,i=s.length;t<i;t++){const i=s[t];if(i.onError)i.onError(e)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)});this.manager.itemStart(t)}setResponseType(t){this.responseType=t;return this}setMimeType(t){this.mimeType=t;return this}}class cT extends cv{constructor(t){super(t)}load(t,e,s,i){const n=this;const r=new cA(this.manager);r.setPath(this.path);r.setRequestHeader(this.requestHeader);r.setWithCredentials(this.withCredentials);r.load(t,function(s){try{e(n.parse(JSON.parse(s)))}catch(e){if(i){i(e)}else{console.error(e)}n.manager.itemError(t)}},s,i)}parse(t){const e=[];for(let s=0;s<t.length;s++){const i=cy.parse(t[s]);e.push(i)}return e}}class cz extends cv{constructor(t){super(t)}load(t,e,s,i){const n=this;const r=[];const o=new al;const a=new cA(this.manager);a.setPath(this.path);a.setResponseType("arraybuffer");a.setRequestHeader(this.requestHeader);a.setWithCredentials(n.withCredentials);let h=0;function c(c){a.load(t[c],function(t){const s=n.parse(t,true);r[c]={width:s.width,height:s.height,format:s.format,mipmaps:s.mipmaps};h+=1;if(h===6){if(s.mipmapCount===1)o.minFilter=t_;o.image=r;o.format=s.format;o.needsUpdate=true;if(e)e(o)}},s,i)}if(Array.isArray(t)){for(let e=0,s=t.length;e<s;++e){c(e)}}else{a.load(t,function(t){const s=n.parse(t,true);if(s.isCubemap){const t=s.mipmaps.length/s.mipmapCount;for(let e=0;e<t;e++){r[e]={mipmaps:[]};for(let t=0;t<s.mipmapCount;t++){r[e].mipmaps.push(s.mipmaps[e*s.mipmapCount+t]);r[e].format=s.format;r[e].width=s.width;r[e].height=s.height}}o.image=r}else{o.image.width=s.width;o.image.height=s.height;o.mipmaps=s.mipmaps}if(s.mipmapCount===1){o.minFilter=t_}o.format=s.format;o.needsUpdate=true;if(e)e(o)},s,i)}return o}}class cI extends cv{constructor(t){super(t)}load(t,e,s,i){if(this.path!==undefined)t=this.path+t;t=this.manager.resolveURL(t);const n=this;const r=cb.get(t);if(r!==undefined){n.manager.itemStart(t);setTimeout(function(){if(e)e(r);n.manager.itemEnd(t)},0);return r}const o=s1("img");function a(){c();cb.add(t,this);if(e)e(this);n.manager.itemEnd(t)}function h(e){c();if(i)i(e);n.manager.itemError(t);n.manager.itemEnd(t)}function c(){o.removeEventListener("load",a,false);o.removeEventListener("error",h,false)}o.addEventListener("load",a,false);o.addEventListener("error",h,false);if(t.slice(0,5)!=="data:"){if(this.crossOrigin!==undefined)o.crossOrigin=this.crossOrigin}n.manager.itemStart(t);o.src=t;return o}}class cC extends cv{constructor(t){super(t)}load(t,e,s,i){const n=new rk;n.colorSpace=eW;const r=new cI(this.manager);r.setCrossOrigin(this.crossOrigin);r.setPath(this.path);let o=0;function a(s){r.load(t[s],function(t){n.images[s]=t;o++;if(o===6){n.needsUpdate=true;if(e)e(n)}},undefined,i)}for(let e=0;e<t.length;++e){a(e)}return n}}class cB extends cv{constructor(t){super(t)}load(t,e,s,i){const n=this;const r=new oh;const o=new cA(this.manager);o.setResponseType("arraybuffer");o.setRequestHeader(this.requestHeader);o.setPath(this.path);o.setWithCredentials(n.withCredentials);o.load(t,function(t){let s;try{s=n.parse(t)}catch(t){if(i!==undefined){i(t)}else{console.error(t);return}}if(s.image!==undefined){r.image=s.image}else if(s.data!==undefined){r.image.width=s.width;r.image.height=s.height;r.image.data=s.data}r.wrapS=s.wrapS!==undefined?s.wrapS:tg;r.wrapT=s.wrapT!==undefined?s.wrapT:tg;r.magFilter=s.magFilter!==undefined?s.magFilter:t_;r.minFilter=s.minFilter!==undefined?s.minFilter:t_;r.anisotropy=s.anisotropy!==undefined?s.anisotropy:1;if(s.colorSpace!==undefined){r.colorSpace=s.colorSpace}if(s.flipY!==undefined){r.flipY=s.flipY}if(s.format!==undefined){r.format=s.format}if(s.type!==undefined){r.type=s.type}if(s.mipmaps!==undefined){r.mipmaps=s.mipmaps;r.minFilter=tz}if(s.mipmapCount===1){r.minFilter=t_}if(s.generateMipmaps!==undefined){r.generateMipmaps=s.generateMipmaps}r.needsUpdate=true;if(e)e(r,s)},s,i);return r}}class ck extends cv{constructor(t){super(t)}load(t,e,s,i){const n=new iu;const r=new cI(this.manager);r.setCrossOrigin(this.crossOrigin);r.setPath(this.path);r.load(t,function(t){n.image=t;n.needsUpdate=true;if(e!==undefined){e(n)}},s,i);return n}}class cR extends nf{constructor(t,e=1){super();this.isLight=true;this.type="Light";this.color=new nE(t);this.intensity=e}dispose(){}copy(t,e){super.copy(t,e);this.color.copy(t.color);this.intensity=t.intensity;return this}toJSON(t){const e=super.toJSON(t);e.object.color=this.color.getHex();e.object.intensity=this.intensity;if(this.groundColor!==undefined)e.object.groundColor=this.groundColor.getHex();if(this.distance!==undefined)e.object.distance=this.distance;if(this.angle!==undefined)e.object.angle=this.angle;if(this.decay!==undefined)e.object.decay=this.decay;if(this.penumbra!==undefined)e.object.penumbra=this.penumbra;if(this.shadow!==undefined)e.object.shadow=this.shadow.toJSON();if(this.target!==undefined)e.object.target=this.target.uuid;return e}}class cE extends cR{constructor(t,e,s){super(t,s);this.isHemisphereLight=true;this.type="HemisphereLight";this.position.copy(nf.DEFAULT_UP);this.updateMatrix();this.groundColor=new nE(e)}copy(t,e){super.copy(t,e);this.groundColor.copy(t.groundColor);return this}}const cP=new i$;const cO=new iM;const cF=new iM;class cN{constructor(t){this.camera=t;this.intensity=1;this.bias=0;this.normalBias=0;this.radius=1;this.blurSamples=8;this.mapSize=new sZ(512,512);this.mapType=tC;this.map=null;this.mapPass=null;this.matrix=new i$;this.autoUpdate=true;this.needsUpdate=false;this._frustum=new oz;this._frameExtents=new sZ(1,1);this._viewportCount=1;this._viewports=[new id(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera;const s=this.matrix;cO.setFromMatrixPosition(t.matrixWorld);e.position.copy(cO);cF.setFromMatrixPosition(t.target.matrixWorld);e.lookAt(cF);e.updateMatrixWorld();cP.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse);this._frustum.setFromProjectionMatrix(cP);s.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);s.multiply(cP)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){if(this.map){this.map.dispose()}if(this.mapPass){this.mapPass.dispose()}}copy(t){this.camera=t.camera.clone();this.intensity=t.intensity;this.bias=t.bias;this.radius=t.radius;this.autoUpdate=t.autoUpdate;this.needsUpdate=t.needsUpdate;this.normalBias=t.normalBias;this.blurSamples=t.blurSamples;this.mapSize.copy(t.mapSize);return this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};if(this.intensity!==1)t.intensity=this.intensity;if(this.bias!==0)t.bias=this.bias;if(this.normalBias!==0)t.normalBias=this.normalBias;if(this.radius!==1)t.radius=this.radius;if(this.mapSize.x!==512||this.mapSize.y!==512)t.mapSize=this.mapSize.toArray();t.camera=this.camera.toJSON(false).object;delete t.camera.matrix;return t}}class cV extends cN{constructor(){super(new rz(50,1,.5,500));this.isSpotLightShadow=true;this.focus=1}updateMatrices(t){const e=this.camera;const s=sA*2*t.angle*this.focus;const i=this.mapSize.width/this.mapSize.height;const n=t.distance||e.far;if(s!==e.fov||i!==e.aspect||n!==e.far){e.fov=s;e.aspect=i;e.far=n;e.updateProjectionMatrix()}super.updateMatrices(t)}copy(t){super.copy(t);this.focus=t.focus;return this}}class cL extends cR{constructor(t,e,s=0,i=Math.PI/3,n=0,r=2){super(t,e);this.isSpotLight=true;this.type="SpotLight";this.position.copy(nf.DEFAULT_UP);this.updateMatrix();this.target=new nf;this.distance=s;this.angle=i;this.penumbra=n;this.decay=r;this.map=null;this.shadow=new cV}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){super.copy(t,e);this.distance=t.distance;this.angle=t.angle;this.penumbra=t.penumbra;this.decay=t.decay;this.target=t.target.clone();this.shadow=t.shadow.clone();return this}}const cj=new i$;const cW=new iM;const cU=new iM;class cD extends cN{constructor(){super(new rz(90,1,.5,500));this.isPointLightShadow=true;this._frameExtents=new sZ(4,2);this._viewportCount=6;this._viewports=[new id(2,1,1,1),new id(0,1,1,1),new id(3,1,1,1),new id(1,1,1,1),new id(3,0,1,1),new id(1,0,1,1)];this._cubeDirections=[new iM(1,0,0),new iM(-1,0,0),new iM(0,0,1),new iM(0,0,-1),new iM(0,1,0),new iM(0,-1,0)];this._cubeUps=[new iM(0,1,0),new iM(0,1,0),new iM(0,1,0),new iM(0,1,0),new iM(0,0,1),new iM(0,0,-1)]}updateMatrices(t,e=0){const s=this.camera;const i=this.matrix;const n=t.distance||s.far;if(n!==s.far){s.far=n;s.updateProjectionMatrix()}cW.setFromMatrixPosition(t.matrixWorld);s.position.copy(cW);cU.copy(s.position);cU.add(this._cubeDirections[e]);s.up.copy(this._cubeUps[e]);s.lookAt(cU);s.updateMatrixWorld();i.makeTranslation(-cW.x,-cW.y,-cW.z);cj.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse);this._frustum.setFromProjectionMatrix(cj)}}class cH extends cR{constructor(t,e,s=0,i=2){super(t,e);this.isPointLight=true;this.type="PointLight";this.distance=s;this.decay=i;this.shadow=new cD}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){super.copy(t,e);this.distance=t.distance;this.decay=t.decay;this.shadow=t.shadow.clone();return this}}class cq extends rS{constructor(t=-1,e=1,s=1,i=-1,n=.1,r=2e3){super();this.isOrthographicCamera=true;this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=t;this.right=e;this.top=s;this.bottom=i;this.near=n;this.far=r;this.updateProjectionMatrix()}copy(t,e){super.copy(t,e);this.left=t.left;this.right=t.right;this.top=t.top;this.bottom=t.bottom;this.near=t.near;this.far=t.far;this.zoom=t.zoom;this.view=t.view===null?null:Object.assign({},t.view);return this}setViewOffset(t,e,s,i,n,r){if(this.view===null){this.view={enabled:true,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}}this.view.enabled=true;this.view.fullWidth=t;this.view.fullHeight=e;this.view.offsetX=s;this.view.offsetY=i;this.view.width=n;this.view.height=r;this.updateProjectionMatrix()}clearViewOffset(){if(this.view!==null){this.view.enabled=false}this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom);const e=(this.top-this.bottom)/(2*this.zoom);const s=(this.right+this.left)/2;const i=(this.top+this.bottom)/2;let n=s-t;let r=s+t;let o=i+e;let a=i-e;if(this.view!==null&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom;const e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=t*this.view.offsetX;r=n+t*this.view.width;o-=e*this.view.offsetY;a=o-e*this.view.height}this.projectionMatrix.makeOrthographic(n,r,o,a,this.near,this.far,this.coordinateSystem);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);e.object.zoom=this.zoom;e.object.left=this.left;e.object.right=this.right;e.object.top=this.top;e.object.bottom=this.bottom;e.object.near=this.near;e.object.far=this.far;if(this.view!==null)e.object.view=Object.assign({},this.view);return e}}class cJ extends cN{constructor(){super(new cq(-5,5,5,-5,.5,500));this.isDirectionalLightShadow=true}}class cX extends cR{constructor(t,e){super(t,e);this.isDirectionalLight=true;this.type="DirectionalLight";this.position.copy(nf.DEFAULT_UP);this.updateMatrix();this.target=new nf;this.shadow=new cJ}dispose(){this.shadow.dispose()}copy(t){super.copy(t);this.target=t.target.clone();this.shadow=t.shadow.clone();return this}}class cY extends cR{constructor(t,e){super(t,e);this.isAmbientLight=true;this.type="AmbientLight"}}class cZ extends cR{constructor(t,e,s=10,i=10){super(t,e);this.isRectAreaLight=true;this.type="RectAreaLight";this.width=s;this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){super.copy(t);this.width=t.width;this.height=t.height;return this}toJSON(t){const e=super.toJSON(t);e.object.width=this.width;e.object.height=this.height;return e}}class cG{constructor(){this.isSphericalHarmonics3=true;this.coefficients=[];for(let t=0;t<9;t++){this.coefficients.push(new iM)}}set(t){for(let e=0;e<9;e++){this.coefficients[e].copy(t[e])}return this}zero(){for(let t=0;t<9;t++){this.coefficients[t].set(0,0,0)}return this}getAt(t,e){const s=t.x,i=t.y,n=t.z;const r=this.coefficients;e.copy(r[0]).multiplyScalar(.282095);e.addScaledVector(r[1],.488603*i);e.addScaledVector(r[2],.488603*n);e.addScaledVector(r[3],.488603*s);e.addScaledVector(r[4],1.092548*(s*i));e.addScaledVector(r[5],1.092548*(i*n));e.addScaledVector(r[6],.315392*(3*n*n-1));e.addScaledVector(r[7],1.092548*(s*n));e.addScaledVector(r[8],.546274*(s*s-i*i));return e}getIrradianceAt(t,e){const s=t.x,i=t.y,n=t.z;const r=this.coefficients;e.copy(r[0]).multiplyScalar(.886227);e.addScaledVector(r[1],2*.511664*i);e.addScaledVector(r[2],2*.511664*n);e.addScaledVector(r[3],2*.511664*s);e.addScaledVector(r[4],2*.429043*s*i);e.addScaledVector(r[5],2*.429043*i*n);e.addScaledVector(r[6],.743125*n*n-.247708);e.addScaledVector(r[7],2*.429043*s*n);e.addScaledVector(r[8],.429043*(s*s-i*i));return e}add(t){for(let e=0;e<9;e++){this.coefficients[e].add(t.coefficients[e])}return this}addScaledSH(t,e){for(let s=0;s<9;s++){this.coefficients[s].addScaledVector(t.coefficients[s],e)}return this}scale(t){for(let e=0;e<9;e++){this.coefficients[e].multiplyScalar(t)}return this}lerp(t,e){for(let s=0;s<9;s++){this.coefficients[s].lerp(t.coefficients[s],e)}return this}equals(t){for(let e=0;e<9;e++){if(!this.coefficients[e].equals(t.coefficients[e])){return false}}return true}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,e=0){const s=this.coefficients;for(let i=0;i<9;i++){s[i].fromArray(t,e+i*3)}return this}toArray(t=[],e=0){const s=this.coefficients;for(let i=0;i<9;i++){s[i].toArray(t,e+i*3)}return t}static getBasisAt(t,e){const s=t.x,i=t.y,n=t.z;e[0]=.282095;e[1]=.488603*i;e[2]=.488603*n;e[3]=.488603*s;e[4]=1.092548*s*i;e[5]=1.092548*i*n;e[6]=.315392*(3*n*n-1);e[7]=1.092548*s*n;e[8]=.546274*(s*s-i*i)}}class c$ extends cR{constructor(t=new cG,e=1){super(undefined,e);this.isLightProbe=true;this.sh=t}copy(t){super.copy(t);this.sh.copy(t.sh);return this}fromJSON(t){this.intensity=t.intensity;this.sh.fromArray(t.sh);return this}toJSON(t){const e=super.toJSON(t);e.object.sh=this.sh.toArray();return e}}class cQ extends cv{constructor(t){super(t);this.textures={}}load(t,e,s,i){const n=this;const r=new cA(n.manager);r.setPath(n.path);r.setRequestHeader(n.requestHeader);r.setWithCredentials(n.withCredentials);r.load(t,function(s){try{e(n.parse(JSON.parse(s)))}catch(e){if(i){i(e)}else{console.error(e)}n.manager.itemError(t)}},s,i)}parse(t){const e=this.textures;function s(t){if(e[t]===undefined){console.warn("THREE.MaterialLoader: Undefined texture",t)}return e[t]}const i=this.createMaterialFromType(t.type);if(t.uuid!==undefined)i.uuid=t.uuid;if(t.name!==undefined)i.name=t.name;if(t.color!==undefined&&i.color!==undefined)i.color.setHex(t.color);if(t.roughness!==undefined)i.roughness=t.roughness;if(t.metalness!==undefined)i.metalness=t.metalness;if(t.sheen!==undefined)i.sheen=t.sheen;if(t.sheenColor!==undefined)i.sheenColor=new nE().setHex(t.sheenColor);if(t.sheenRoughness!==undefined)i.sheenRoughness=t.sheenRoughness;if(t.emissive!==undefined&&i.emissive!==undefined)i.emissive.setHex(t.emissive);if(t.specular!==undefined&&i.specular!==undefined)i.specular.setHex(t.specular);if(t.specularIntensity!==undefined)i.specularIntensity=t.specularIntensity;if(t.specularColor!==undefined&&i.specularColor!==undefined)i.specularColor.setHex(t.specularColor);if(t.shininess!==undefined)i.shininess=t.shininess;if(t.clearcoat!==undefined)i.clearcoat=t.clearcoat;if(t.clearcoatRoughness!==undefined)i.clearcoatRoughness=t.clearcoatRoughness;if(t.dispersion!==undefined)i.dispersion=t.dispersion;if(t.iridescence!==undefined)i.iridescence=t.iridescence;if(t.iridescenceIOR!==undefined)i.iridescenceIOR=t.iridescenceIOR;if(t.iridescenceThicknessRange!==undefined)i.iridescenceThicknessRange=t.iridescenceThicknessRange;if(t.transmission!==undefined)i.transmission=t.transmission;if(t.thickness!==undefined)i.thickness=t.thickness;if(t.attenuationDistance!==undefined)i.attenuationDistance=t.attenuationDistance;if(t.attenuationColor!==undefined&&i.attenuationColor!==undefined)i.attenuationColor.setHex(t.attenuationColor);if(t.anisotropy!==undefined)i.anisotropy=t.anisotropy;if(t.anisotropyRotation!==undefined)i.anisotropyRotation=t.anisotropyRotation;if(t.fog!==undefined)i.fog=t.fog;if(t.flatShading!==undefined)i.flatShading=t.flatShading;if(t.blending!==undefined)i.blending=t.blending;if(t.combine!==undefined)i.combine=t.combine;if(t.side!==undefined)i.side=t.side;if(t.shadowSide!==undefined)i.shadowSide=t.shadowSide;if(t.opacity!==undefined)i.opacity=t.opacity;if(t.transparent!==undefined)i.transparent=t.transparent;if(t.alphaTest!==undefined)i.alphaTest=t.alphaTest;if(t.alphaHash!==undefined)i.alphaHash=t.alphaHash;if(t.depthFunc!==undefined)i.depthFunc=t.depthFunc;if(t.depthTest!==undefined)i.depthTest=t.depthTest;if(t.depthWrite!==undefined)i.depthWrite=t.depthWrite;if(t.colorWrite!==undefined)i.colorWrite=t.colorWrite;if(t.blendSrc!==undefined)i.blendSrc=t.blendSrc;if(t.blendDst!==undefined)i.blendDst=t.blendDst;if(t.blendEquation!==undefined)i.blendEquation=t.blendEquation;if(t.blendSrcAlpha!==undefined)i.blendSrcAlpha=t.blendSrcAlpha;if(t.blendDstAlpha!==undefined)i.blendDstAlpha=t.blendDstAlpha;if(t.blendEquationAlpha!==undefined)i.blendEquationAlpha=t.blendEquationAlpha;if(t.blendColor!==undefined&&i.blendColor!==undefined)i.blendColor.setHex(t.blendColor);if(t.blendAlpha!==undefined)i.blendAlpha=t.blendAlpha;if(t.stencilWriteMask!==undefined)i.stencilWriteMask=t.stencilWriteMask;if(t.stencilFunc!==undefined)i.stencilFunc=t.stencilFunc;if(t.stencilRef!==undefined)i.stencilRef=t.stencilRef;if(t.stencilFuncMask!==undefined)i.stencilFuncMask=t.stencilFuncMask;if(t.stencilFail!==undefined)i.stencilFail=t.stencilFail;if(t.stencilZFail!==undefined)i.stencilZFail=t.stencilZFail;if(t.stencilZPass!==undefined)i.stencilZPass=t.stencilZPass;if(t.stencilWrite!==undefined)i.stencilWrite=t.stencilWrite;if(t.wireframe!==undefined)i.wireframe=t.wireframe;if(t.wireframeLinewidth!==undefined)i.wireframeLinewidth=t.wireframeLinewidth;if(t.wireframeLinecap!==undefined)i.wireframeLinecap=t.wireframeLinecap;if(t.wireframeLinejoin!==undefined)i.wireframeLinejoin=t.wireframeLinejoin;if(t.rotation!==undefined)i.rotation=t.rotation;if(t.linewidth!==undefined)i.linewidth=t.linewidth;if(t.dashSize!==undefined)i.dashSize=t.dashSize;if(t.gapSize!==undefined)i.gapSize=t.gapSize;if(t.scale!==undefined)i.scale=t.scale;if(t.polygonOffset!==undefined)i.polygonOffset=t.polygonOffset;if(t.polygonOffsetFactor!==undefined)i.polygonOffsetFactor=t.polygonOffsetFactor;if(t.polygonOffsetUnits!==undefined)i.polygonOffsetUnits=t.polygonOffsetUnits;if(t.dithering!==undefined)i.dithering=t.dithering;if(t.alphaToCoverage!==undefined)i.alphaToCoverage=t.alphaToCoverage;if(t.premultipliedAlpha!==undefined)i.premultipliedAlpha=t.premultipliedAlpha;if(t.forceSinglePass!==undefined)i.forceSinglePass=t.forceSinglePass;if(t.visible!==undefined)i.visible=t.visible;if(t.toneMapped!==undefined)i.toneMapped=t.toneMapped;if(t.userData!==undefined)i.userData=t.userData;if(t.vertexColors!==undefined){if(typeof t.vertexColors==="number"){i.vertexColors=t.vertexColors>0?true:false}else{i.vertexColors=t.vertexColors}}if(t.uniforms!==undefined){for(const e in t.uniforms){const n=t.uniforms[e];i.uniforms[e]={};switch(n.type){case"t":i.uniforms[e].value=s(n.value);break;case"c":i.uniforms[e].value=new nE().setHex(n.value);break;case"v2":i.uniforms[e].value=new sZ().fromArray(n.value);break;case"v3":i.uniforms[e].value=new iM().fromArray(n.value);break;case"v4":i.uniforms[e].value=new id().fromArray(n.value);break;case"m3":i.uniforms[e].value=new sG().fromArray(n.value);break;case"m4":i.uniforms[e].value=new i$().fromArray(n.value);break;default:i.uniforms[e].value=n.value}}}if(t.defines!==undefined)i.defines=t.defines;if(t.vertexShader!==undefined)i.vertexShader=t.vertexShader;if(t.fragmentShader!==undefined)i.fragmentShader=t.fragmentShader;if(t.glslVersion!==undefined)i.glslVersion=t.glslVersion;if(t.extensions!==undefined){for(const e in t.extensions){i.extensions[e]=t.extensions[e]}}if(t.lights!==undefined)i.lights=t.lights;if(t.clipping!==undefined)i.clipping=t.clipping;if(t.size!==undefined)i.size=t.size;if(t.sizeAttenuation!==undefined)i.sizeAttenuation=t.sizeAttenuation;if(t.map!==undefined)i.map=s(t.map);if(t.matcap!==undefined)i.matcap=s(t.matcap);if(t.alphaMap!==undefined)i.alphaMap=s(t.alphaMap);if(t.bumpMap!==undefined)i.bumpMap=s(t.bumpMap);if(t.bumpScale!==undefined)i.bumpScale=t.bumpScale;if(t.normalMap!==undefined)i.normalMap=s(t.normalMap);if(t.normalMapType!==undefined)i.normalMapType=t.normalMapType;if(t.normalScale!==undefined){let e=t.normalScale;if(Array.isArray(e)===false){e=[e,e]}i.normalScale=new sZ().fromArray(e)}if(t.displacementMap!==undefined)i.displacementMap=s(t.displacementMap);if(t.displacementScale!==undefined)i.displacementScale=t.displacementScale;if(t.displacementBias!==undefined)i.displacementBias=t.displacementBias;if(t.roughnessMap!==undefined)i.roughnessMap=s(t.roughnessMap);if(t.metalnessMap!==undefined)i.metalnessMap=s(t.metalnessMap);if(t.emissiveMap!==undefined)i.emissiveMap=s(t.emissiveMap);if(t.emissiveIntensity!==undefined)i.emissiveIntensity=t.emissiveIntensity;if(t.specularMap!==undefined)i.specularMap=s(t.specularMap);if(t.specularIntensityMap!==undefined)i.specularIntensityMap=s(t.specularIntensityMap);if(t.specularColorMap!==undefined)i.specularColorMap=s(t.specularColorMap);if(t.envMap!==undefined)i.envMap=s(t.envMap);if(t.envMapRotation!==undefined)i.envMapRotation.fromArray(t.envMapRotation);if(t.envMapIntensity!==undefined)i.envMapIntensity=t.envMapIntensity;if(t.reflectivity!==undefined)i.reflectivity=t.reflectivity;if(t.refractionRatio!==undefined)i.refractionRatio=t.refractionRatio;if(t.lightMap!==undefined)i.lightMap=s(t.lightMap);if(t.lightMapIntensity!==undefined)i.lightMapIntensity=t.lightMapIntensity;if(t.aoMap!==undefined)i.aoMap=s(t.aoMap);if(t.aoMapIntensity!==undefined)i.aoMapIntensity=t.aoMapIntensity;if(t.gradientMap!==undefined)i.gradientMap=s(t.gradientMap);if(t.clearcoatMap!==undefined)i.clearcoatMap=s(t.clearcoatMap);if(t.clearcoatRoughnessMap!==undefined)i.clearcoatRoughnessMap=s(t.clearcoatRoughnessMap);if(t.clearcoatNormalMap!==undefined)i.clearcoatNormalMap=s(t.clearcoatNormalMap);if(t.clearcoatNormalScale!==undefined)i.clearcoatNormalScale=new sZ().fromArray(t.clearcoatNormalScale);if(t.iridescenceMap!==undefined)i.iridescenceMap=s(t.iridescenceMap);if(t.iridescenceThicknessMap!==undefined)i.iridescenceThicknessMap=s(t.iridescenceThicknessMap);if(t.transmissionMap!==undefined)i.transmissionMap=s(t.transmissionMap);if(t.thicknessMap!==undefined)i.thicknessMap=s(t.thicknessMap);if(t.anisotropyMap!==undefined)i.anisotropyMap=s(t.anisotropyMap);if(t.sheenColorMap!==undefined)i.sheenColorMap=s(t.sheenColorMap);if(t.sheenRoughnessMap!==undefined)i.sheenRoughnessMap=s(t.sheenRoughnessMap);return i}setTextures(t){this.textures=t;return this}createMaterialFromType(t){return cQ.createMaterialFromType(t)}static createMaterialFromType(t){const e={ShadowMaterial:hY,SpriteMaterial:rU,RawShaderMaterial:hZ,ShaderMaterial:rv,PointsMaterial:at,MeshPhysicalMaterial:h$,MeshStandardMaterial:hG,MeshPhongMaterial:hQ,MeshToonMaterial:hK,MeshNormalMaterial:h0,MeshLambertMaterial:h1,MeshDepthMaterial:h2,MeshDistanceMaterial:h3,MeshBasicMaterial:nN,MeshMatcapMaterial:h5,LineDashedMaterial:h4,LineBasicMaterial:oG,Material:nF};return new e[t]}}class cK{static extractUrlBase(t){const e=t.lastIndexOf("/");if(e===-1)return"./";return t.slice(0,e+1)}static resolveURL(t,e){if(typeof t!=="string"||t==="")return"";if(/^https?:\/\//i.test(e)&&/^\//.test(t)){e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")}if(/^(https?:)?\/\//i.test(t))return t;if(/^data:.*,.*$/i.test(t))return t;if(/^blob:.*$/i.test(t))return t;return e+t}}class c0 extends n7{constructor(){super();this.isInstancedBufferGeometry=true;this.type="InstancedBufferGeometry";this.instanceCount=Infinity}copy(t){super.copy(t);this.instanceCount=t.instanceCount;return this}toJSON(){const t=super.toJSON();t.instanceCount=this.instanceCount;t.isInstancedBufferGeometry=true;return t}}class c1 extends cv{constructor(t){super(t)}load(t,e,s,i){const n=this;const r=new cA(n.manager);r.setPath(n.path);r.setRequestHeader(n.requestHeader);r.setWithCredentials(n.withCredentials);r.load(t,function(s){try{e(n.parse(JSON.parse(s)))}catch(e){if(i){i(e)}else{console.error(e)}n.manager.itemError(t)}},s,i)}parse(t){const e={};const s={};function i(t,s){if(e[s]!==undefined)return e[s];const i=t.interleavedBuffers;const r=i[s];const o=n(t,r.buffer);const a=s0(r.type,o);const h=new rL(a,r.stride);h.uuid=r.uuid;e[s]=h;return h}function n(t,e){if(s[e]!==undefined)return s[e];const i=t.arrayBuffers;const n=i[e];const r=new Uint32Array(n).buffer;s[e]=r;return r}const r=t.isInstancedBufferGeometry?new c0:new n7;const o=t.data.index;if(o!==undefined){const t=s0(o.type,o.array);r.setIndex(new nJ(t,1))}const a=t.data.attributes;for(const e in a){const s=a[e];let n;if(s.isInterleavedBufferAttribute){const e=i(t.data,s.data);n=new rW(e,s.itemSize,s.offset,s.normalized)}else{const t=s0(s.type,s.array);const e=s.isInstancedBufferAttribute?od:nJ;n=new e(t,s.itemSize,s.normalized)}if(s.name!==undefined)n.name=s.name;if(s.usage!==undefined)n.setUsage(s.usage);r.setAttribute(e,n)}const h=t.data.morphAttributes;if(h){for(const e in h){const s=h[e];const n=[];for(let e=0,r=s.length;e<r;e++){const r=s[e];let o;if(r.isInterleavedBufferAttribute){const e=i(t.data,r.data);o=new rW(e,r.itemSize,r.offset,r.normalized)}else{const t=s0(r.type,r.array);o=new nJ(t,r.itemSize,r.normalized)}if(r.name!==undefined)o.name=r.name;n.push(o)}r.morphAttributes[e]=n}}const c=t.data.morphTargetsRelative;if(c){r.morphTargetsRelative=true}const l=t.data.groups||t.data.drawcalls||t.data.offsets;if(l!==undefined){for(let t=0,e=l.length;t!==e;++t){const e=l[t];r.addGroup(e.start,e.count,e.materialIndex)}}const u=t.data.boundingSphere;if(u!==undefined){const t=new iM;if(u.center!==undefined){t.fromArray(u.center)}r.boundingSphere=new iU(t,u.radius)}if(t.name)r.name=t.name;if(t.userData)r.userData=t.userData;return r}}class c2 extends cv{constructor(t){super(t)}load(t,e,s,i){const n=this;const r=this.path===""?cK.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||r;const o=new cA(this.manager);o.setPath(this.path);o.setRequestHeader(this.requestHeader);o.setWithCredentials(this.withCredentials);o.load(t,function(s){let r=null;try{r=JSON.parse(s)}catch(e){if(i!==undefined)i(e);console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message);return}const o=r.metadata;if(o===undefined||o.type===undefined||o.type.toLowerCase()==="geometry"){if(i!==undefined)i(new Error("THREE.ObjectLoader: Can't load "+t));console.error("THREE.ObjectLoader: Can't load "+t);return}n.parse(r,e)},s,i)}async loadAsync(t,e){const s=this;const i=this.path===""?cK.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||i;const n=new cA(this.manager);n.setPath(this.path);n.setRequestHeader(this.requestHeader);n.setWithCredentials(this.withCredentials);const r=await n.loadAsync(t,e);const o=JSON.parse(r);const a=o.metadata;if(a===undefined||a.type===undefined||a.type.toLowerCase()==="geometry"){throw new Error("THREE.ObjectLoader: Can't load "+t)}return await s.parseAsync(o)}parse(t,e){const s=this.parseAnimations(t.animations);const i=this.parseShapes(t.shapes);const n=this.parseGeometries(t.geometries,i);const r=this.parseImages(t.images,function(){if(e!==undefined)e(h)});const o=this.parseTextures(t.textures,r);const a=this.parseMaterials(t.materials,o);const h=this.parseObject(t.object,n,a,o,s);const c=this.parseSkeletons(t.skeletons,h);this.bindSkeletons(h,c);this.bindLightTargets(h);if(e!==undefined){let t=false;for(const e in r){if(r[e].data instanceof HTMLImageElement){t=true;break}}if(t===false)e(h)}return h}async parseAsync(t){const e=this.parseAnimations(t.animations);const s=this.parseShapes(t.shapes);const i=this.parseGeometries(t.geometries,s);const n=await this.parseImagesAsync(t.images);const r=this.parseTextures(t.textures,n);const o=this.parseMaterials(t.materials,r);const a=this.parseObject(t.object,i,o,r,e);const h=this.parseSkeletons(t.skeletons,a);this.bindSkeletons(a,h);this.bindLightTargets(a);return a}parseShapes(t){const e={};if(t!==undefined){for(let s=0,i=t.length;s<i;s++){const i=new a2().fromJSON(t[s]);e[i.uuid]=i}}return e}parseSkeletons(t,e){const s={};const i={};e.traverse(function(t){if(t.isBone)i[t.uuid]=t});if(t!==undefined){for(let e=0,n=t.length;e<n;e++){const n=new ou().fromJSON(t[e],i);s[n.uuid]=n}}return s}parseGeometries(t,e){const s={};if(t!==undefined){const i=new c1;for(let n=0,r=t.length;n<r;n++){let r;const o=t[n];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":r=i.parse(o);break;default:if(o.type in hX){r=hX[o.type].fromJSON(o,e)}else{console.warn(`THREE.ObjectLoader: Unsupported geometry type "${o.type}"`)}}r.uuid=o.uuid;if(o.name!==undefined)r.name=o.name;if(o.userData!==undefined)r.userData=o.userData;s[o.uuid]=r}}return s}parseMaterials(t,e){const s={};const i={};if(t!==undefined){const n=new cQ;n.setTextures(e);for(let e=0,r=t.length;e<r;e++){const r=t[e];if(s[r.uuid]===undefined){s[r.uuid]=n.parse(r)}i[r.uuid]=s[r.uuid]}}return i}parseAnimations(t){const e={};if(t!==undefined){for(let s=0;s<t.length;s++){const i=t[s];const n=cy.parse(i);e[n.uuid]=n}}return e}parseImages(t,e){const s=this;const i={};let n;function r(t){s.manager.itemStart(t);return n.load(t,function(){s.manager.itemEnd(t)},undefined,function(){s.manager.itemError(t);s.manager.itemEnd(t)})}function o(t){if(typeof t==="string"){const e=t;const i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:s.resourcePath+e;return r(i)}else{if(t.data){return{data:s0(t.type,t.data),width:t.width,height:t.height}}else{return null}}}if(t!==undefined&&t.length>0){const s=new cw(e);n=new cI(s);n.setCrossOrigin(this.crossOrigin);for(let e=0,s=t.length;e<s;e++){const s=t[e];const n=s.url;if(Array.isArray(n)){const t=[];for(let e=0,s=n.length;e<s;e++){const s=n[e];const i=o(s);if(i!==null){if(i instanceof HTMLImageElement){t.push(i)}else{t.push(new oh(i.data,i.width,i.height))}}}i[s.uuid]=new ih(t)}else{const t=o(s.url);i[s.uuid]=new ih(t)}}}return i}async parseImagesAsync(t){const e=this;const s={};let i;async function n(t){if(typeof t==="string"){const s=t;const n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s)?s:e.resourcePath+s;return await i.loadAsync(n)}else{if(t.data){return{data:s0(t.type,t.data),width:t.width,height:t.height}}else{return null}}}if(t!==undefined&&t.length>0){i=new cI(this.manager);i.setCrossOrigin(this.crossOrigin);for(let e=0,i=t.length;e<i;e++){const i=t[e];const r=i.url;if(Array.isArray(r)){const t=[];for(let e=0,s=r.length;e<s;e++){const s=r[e];const i=await n(s);if(i!==null){if(i instanceof HTMLImageElement){t.push(i)}else{t.push(new oh(i.data,i.width,i.height))}}}s[i.uuid]=new ih(t)}else{const t=await n(i.url);s[i.uuid]=new ih(t)}}}return s}parseTextures(t,e){function s(t,e){if(typeof t==="number")return t;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t);return e[t]}const i={};if(t!==undefined){for(let n=0,r=t.length;n<r;n++){const r=t[n];if(r.image===undefined){console.warn('THREE.ObjectLoader: No "image" specified for',r.uuid)}if(e[r.image]===undefined){console.warn("THREE.ObjectLoader: Undefined image",r.image)}const o=e[r.image];const a=o.data;let h;if(Array.isArray(a)){h=new rk;if(a.length===6)h.needsUpdate=true}else{if(a&&a.data){h=new oh}else{h=new iu}if(a)h.needsUpdate=true}h.source=o;h.uuid=r.uuid;if(r.name!==undefined)h.name=r.name;if(r.mapping!==undefined)h.mapping=s(r.mapping,c3);if(r.channel!==undefined)h.channel=r.channel;if(r.offset!==undefined)h.offset.fromArray(r.offset);if(r.repeat!==undefined)h.repeat.fromArray(r.repeat);if(r.center!==undefined)h.center.fromArray(r.center);if(r.rotation!==undefined)h.rotation=r.rotation;if(r.wrap!==undefined){h.wrapS=s(r.wrap[0],c5);h.wrapT=s(r.wrap[1],c5)}if(r.format!==undefined)h.format=r.format;if(r.internalFormat!==undefined)h.internalFormat=r.internalFormat;if(r.type!==undefined)h.type=r.type;if(r.colorSpace!==undefined)h.colorSpace=r.colorSpace;if(r.minFilter!==undefined)h.minFilter=s(r.minFilter,c4);if(r.magFilter!==undefined)h.magFilter=s(r.magFilter,c4);if(r.anisotropy!==undefined)h.anisotropy=r.anisotropy;if(r.flipY!==undefined)h.flipY=r.flipY;if(r.generateMipmaps!==undefined)h.generateMipmaps=r.generateMipmaps;if(r.premultiplyAlpha!==undefined)h.premultiplyAlpha=r.premultiplyAlpha;if(r.unpackAlignment!==undefined)h.unpackAlignment=r.unpackAlignment;if(r.compareFunction!==undefined)h.compareFunction=r.compareFunction;if(r.userData!==undefined)h.userData=r.userData;i[r.uuid]=h}}return i}parseObject(t,e,s,i,n){let r;function o(t){if(e[t]===undefined){console.warn("THREE.ObjectLoader: Undefined geometry",t)}return e[t]}function a(t){if(t===undefined)return undefined;if(Array.isArray(t)){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];if(s[n]===undefined){console.warn("THREE.ObjectLoader: Undefined material",n)}e.push(s[n])}return e}if(s[t]===undefined){console.warn("THREE.ObjectLoader: Undefined material",t)}return s[t]}function h(t){if(i[t]===undefined){console.warn("THREE.ObjectLoader: Undefined texture",t)}return i[t]}let c,l;switch(t.type){case"Scene":r=new rV;if(t.background!==undefined){if(Number.isInteger(t.background)){r.background=new nE(t.background)}else{r.background=h(t.background)}}if(t.environment!==undefined){r.environment=h(t.environment)}if(t.fog!==undefined){if(t.fog.type==="Fog"){r.fog=new rN(t.fog.color,t.fog.near,t.fog.far)}else if(t.fog.type==="FogExp2"){r.fog=new rF(t.fog.color,t.fog.density)}if(t.fog.name!==""){r.fog.name=t.fog.name}}if(t.backgroundBlurriness!==undefined)r.backgroundBlurriness=t.backgroundBlurriness;if(t.backgroundIntensity!==undefined)r.backgroundIntensity=t.backgroundIntensity;if(t.backgroundRotation!==undefined)r.backgroundRotation.fromArray(t.backgroundRotation);if(t.environmentIntensity!==undefined)r.environmentIntensity=t.environmentIntensity;if(t.environmentRotation!==undefined)r.environmentRotation.fromArray(t.environmentRotation);break;case"PerspectiveCamera":r=new rz(t.fov,t.aspect,t.near,t.far);if(t.focus!==undefined)r.focus=t.focus;if(t.zoom!==undefined)r.zoom=t.zoom;if(t.filmGauge!==undefined)r.filmGauge=t.filmGauge;if(t.filmOffset!==undefined)r.filmOffset=t.filmOffset;if(t.view!==undefined)r.view=Object.assign({},t.view);break;case"OrthographicCamera":r=new cq(t.left,t.right,t.top,t.bottom,t.near,t.far);if(t.zoom!==undefined)r.zoom=t.zoom;if(t.view!==undefined)r.view=Object.assign({},t.view);break;case"AmbientLight":r=new cY(t.color,t.intensity);break;case"DirectionalLight":r=new cX(t.color,t.intensity);r.target=t.target||"";break;case"PointLight":r=new cH(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new cZ(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new cL(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);r.target=t.target||"";break;case"HemisphereLight":r=new cE(t.color,t.groundColor,t.intensity);break;case"LightProbe":r=new c$().fromJSON(t);break;case"SkinnedMesh":c=o(t.geometry);l=a(t.material);r=new oo(c,l);if(t.bindMode!==undefined)r.bindMode=t.bindMode;if(t.bindMatrix!==undefined)r.bindMatrix.fromArray(t.bindMatrix);if(t.skeleton!==undefined)r.skeleton=t.skeleton;break;case"Mesh":c=o(t.geometry);l=a(t.material);r=new ru(c,l);break;case"InstancedMesh":c=o(t.geometry);l=a(t.material);const u=t.count;const d=t.instanceMatrix;const p=t.instanceColor;r=new ow(c,l,u);r.instanceMatrix=new od(new Float32Array(d.array),16);if(p!==undefined)r.instanceColor=new od(new Float32Array(p.array),p.itemSize);break;case"BatchedMesh":c=o(t.geometry);l=a(t.material);r=new oZ(t.maxInstanceCount,t.maxVertexCount,t.maxIndexCount,l);r.geometry=c;r.perObjectFrustumCulled=t.perObjectFrustumCulled;r.sortObjects=t.sortObjects;r._drawRanges=t.drawRanges;r._reservedRanges=t.reservedRanges;r._geometryInfo=t.geometryInfo.map(t=>{let e=null;let s=null;if(t.boundingBox!==undefined){e=new i_;e.min.fromArray(t.boundingBox.min);e.max.fromArray(t.boundingBox.max)}if(t.boundingSphere!==undefined){s=new iU;s.radius=t.boundingSphere.radius;s.center.fromArray(t.boundingSphere.center)}return{...t,boundingBox:e,boundingSphere:s}});r._instanceInfo=t.instanceInfo;r._availableInstanceIds=t._availableInstanceIds;r._availableGeometryIds=t._availableGeometryIds;r._nextIndexStart=t.nextIndexStart;r._nextVertexStart=t.nextVertexStart;r._geometryCount=t.geometryCount;r._maxInstanceCount=t.maxInstanceCount;r._maxVertexCount=t.maxVertexCount;r._maxIndexCount=t.maxIndexCount;r._geometryInitialized=t.geometryInitialized;r._matricesTexture=h(t.matricesTexture.uuid);r._indirectTexture=h(t.indirectTexture.uuid);if(t.colorsTexture!==undefined){r._colorsTexture=h(t.colorsTexture.uuid)}if(t.boundingSphere!==undefined){r.boundingSphere=new iU;r.boundingSphere.center.fromArray(t.boundingSphere.center);r.boundingSphere.radius=t.boundingSphere.radius}if(t.boundingBox!==undefined){r.boundingBox=new i_;r.boundingBox.min.fromArray(t.boundingBox.min);r.boundingBox.max.fromArray(t.boundingBox.max)}break;case"LOD":r=new r6;break;case"Line":r=new o5(o(t.geometry),a(t.material));break;case"LineLoop":r=new o7(o(t.geometry),a(t.material));break;case"LineSegments":r=new o9(o(t.geometry),a(t.material));break;case"PointCloud":case"Points":r=new ar(o(t.geometry),a(t.material));break;case"Sprite":r=new r2(a(t.material));break;case"Group":r=new rE;break;case"Bone":r=new oa;break;default:r=new nf}r.uuid=t.uuid;if(t.name!==undefined)r.name=t.name;if(t.matrix!==undefined){r.matrix.fromArray(t.matrix);if(t.matrixAutoUpdate!==undefined)r.matrixAutoUpdate=t.matrixAutoUpdate;if(r.matrixAutoUpdate)r.matrix.decompose(r.position,r.quaternion,r.scale)}else{if(t.position!==undefined)r.position.fromArray(t.position);if(t.rotation!==undefined)r.rotation.fromArray(t.rotation);if(t.quaternion!==undefined)r.quaternion.fromArray(t.quaternion);if(t.scale!==undefined)r.scale.fromArray(t.scale)}if(t.up!==undefined)r.up.fromArray(t.up);if(t.castShadow!==undefined)r.castShadow=t.castShadow;if(t.receiveShadow!==undefined)r.receiveShadow=t.receiveShadow;if(t.shadow){if(t.shadow.intensity!==undefined)r.shadow.intensity=t.shadow.intensity;if(t.shadow.bias!==undefined)r.shadow.bias=t.shadow.bias;if(t.shadow.normalBias!==undefined)r.shadow.normalBias=t.shadow.normalBias;if(t.shadow.radius!==undefined)r.shadow.radius=t.shadow.radius;if(t.shadow.mapSize!==undefined)r.shadow.mapSize.fromArray(t.shadow.mapSize);if(t.shadow.camera!==undefined)r.shadow.camera=this.parseObject(t.shadow.camera)}if(t.visible!==undefined)r.visible=t.visible;if(t.frustumCulled!==undefined)r.frustumCulled=t.frustumCulled;if(t.renderOrder!==undefined)r.renderOrder=t.renderOrder;if(t.userData!==undefined)r.userData=t.userData;if(t.layers!==undefined)r.layers.mask=t.layers;if(t.children!==undefined){const o=t.children;for(let t=0;t<o.length;t++){r.add(this.parseObject(o[t],e,s,i,n))}}if(t.animations!==undefined){const e=t.animations;for(let t=0;t<e.length;t++){const s=e[t];r.animations.push(n[s])}}if(t.type==="LOD"){if(t.autoUpdate!==undefined)r.autoUpdate=t.autoUpdate;const e=t.levels;for(let t=0;t<e.length;t++){const s=e[t];const i=r.getObjectByProperty("uuid",s.object);if(i!==undefined){r.addLevel(i,s.distance,s.hysteresis)}}}return r}bindSkeletons(t,e){if(Object.keys(e).length===0)return;t.traverse(function(t){if(t.isSkinnedMesh===true&&t.skeleton!==undefined){const s=e[t.skeleton];if(s===undefined){console.warn("THREE.ObjectLoader: No skeleton found with UUID:",t.skeleton)}else{t.bind(s,t.bindMatrix)}}})}bindLightTargets(t){t.traverse(function(e){if(e.isDirectionalLight||e.isSpotLight){const s=e.target;const i=t.getObjectByProperty("uuid",s);if(i!==undefined){e.target=i}else{e.target=new nf}}})}}const c3={UVMapping:tl,CubeReflectionMapping:tu,CubeRefractionMapping:td,EquirectangularReflectionMapping:tp,EquirectangularRefractionMapping:tf,CubeUVReflectionMapping:tm};const c5={RepeatWrapping:ty,ClampToEdgeWrapping:tg,MirroredRepeatWrapping:tx};const c4={NearestFilter:tb,NearestMipmapNearestFilter:tw,NearestMipmapLinearFilter:tv,LinearFilter:t_,LinearMipmapNearestFilter:tA,LinearMipmapLinearFilter:tz};class c6 extends cv{constructor(t){super(t);this.isImageBitmapLoader=true;if(typeof createImageBitmap==="undefined"){console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.")}if(typeof fetch==="undefined"){console.warn("THREE.ImageBitmapLoader: fetch() not supported.")}this.options={premultiplyAlpha:"none"}}setOptions(t){this.options=t;return this}load(t,e,s,i){if(t===undefined)t="";if(this.path!==undefined)t=this.path+t;t=this.manager.resolveURL(t);const n=this;const r=cb.get(t);if(r!==undefined){n.manager.itemStart(t);if(r.then){r.then(s=>{if(e)e(s);n.manager.itemEnd(t)}).catch(t=>{if(i)i(t)});return}setTimeout(function(){if(e)e(r);n.manager.itemEnd(t)},0);return r}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include";o.headers=this.requestHeader;const a=fetch(t,o).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,Object.assign(n.options,{colorSpaceConversion:"none"}))}).then(function(s){cb.add(t,s);if(e)e(s);n.manager.itemEnd(t);return s}).catch(function(e){if(i)i(e);cb.remove(t);n.manager.itemError(t);n.manager.itemEnd(t)});cb.add(t,a);n.manager.itemStart(t)}}let c8;class c9{static getContext(){if(c8===undefined){c8=new(window.AudioContext||window.webkitAudioContext)}return c8}static setContext(t){c8=t}}class c7 extends cv{constructor(t){super(t)}load(t,e,s,i){const n=this;const r=new cA(this.manager);r.setResponseType("arraybuffer");r.setPath(this.path);r.setRequestHeader(this.requestHeader);r.setWithCredentials(this.withCredentials);r.load(t,function(t){try{const s=t.slice(0);const i=c9.getContext();i.decodeAudioData(s,function(t){e(t)}).catch(o)}catch(t){o(t)}},s,i);function o(e){if(i){i(e)}else{console.error(e)}n.manager.itemError(t)}}}const lt=new i$;const le=new i$;const ls=new i$;class li{constructor(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new rz;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=false;this.cameraR=new rz;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=false;this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache;const s=e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep;if(s){e.focus=t.focus;e.fov=t.fov;e.aspect=t.aspect*this.aspect;e.near=t.near;e.far=t.far;e.zoom=t.zoom;e.eyeSep=this.eyeSep;ls.copy(t.projectionMatrix);const s=e.eyeSep/2;const i=s*e.near/e.focus;const n=e.near*Math.tan(s_*e.fov*.5)/e.zoom;let r,o;le.elements[12]=-s;lt.elements[12]=s;r=-n*e.aspect+i;o=n*e.aspect+i;ls.elements[0]=2*e.near/(o-r);ls.elements[8]=(o+r)/(o-r);this.cameraL.projectionMatrix.copy(ls);r=-n*e.aspect-i;o=n*e.aspect-i;ls.elements[0]=2*e.near/(o-r);ls.elements[8]=(o+r)/(o-r);this.cameraR.projectionMatrix.copy(ls)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(le);this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(lt)}}class ln extends rz{constructor(t=[]){super();this.isArrayCamera=true;this.isMultiViewCamera=false;this.cameras=t}}class lr{constructor(t=true){this.autoStart=t;this.startTime=0;this.oldTime=0;this.elapsedTime=0;this.running=false}start(){this.startTime=lo();this.oldTime=this.startTime;this.elapsedTime=0;this.running=true}stop(){this.getElapsedTime();this.running=false;this.autoStart=false}getElapsedTime(){this.getDelta();return this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running){this.start();return 0}if(this.running){const e=lo();t=(e-this.oldTime)/1e3;this.oldTime=e;this.elapsedTime+=t}return t}}function lo(){return performance.now()}const la=new iM;const lh=new iw;const lc=new iM;const ll=new iM;class lu extends nf{constructor(){super();this.type="AudioListener";this.context=c9.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null;this.timeDelta=0;this._clock=new lr}getInput(){return this.gain}removeFilter(){if(this.filter!==null){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination);this.gain.connect(this.context.destination);this.filter=null}return this}getFilter(){return this.filter}setFilter(t){if(this.filter!==null){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination)}else{this.gain.disconnect(this.context.destination)}this.filter=t;this.gain.connect(this.filter);this.filter.connect(this.context.destination);return this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01);return this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener;const s=this.up;this.timeDelta=this._clock.getDelta();this.matrixWorld.decompose(la,lh,lc);ll.set(0,0,-1).applyQuaternion(lh);if(e.positionX){const t=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(la.x,t);e.positionY.linearRampToValueAtTime(la.y,t);e.positionZ.linearRampToValueAtTime(la.z,t);e.forwardX.linearRampToValueAtTime(ll.x,t);e.forwardY.linearRampToValueAtTime(ll.y,t);e.forwardZ.linearRampToValueAtTime(ll.z,t);e.upX.linearRampToValueAtTime(s.x,t);e.upY.linearRampToValueAtTime(s.y,t);e.upZ.linearRampToValueAtTime(s.z,t)}else{e.setPosition(la.x,la.y,la.z);e.setOrientation(ll.x,ll.y,ll.z,s.x,s.y,s.z)}}}class ld extends nf{constructor(t){super();this.type="Audio";this.listener=t;this.context=t.context;this.gain=this.context.createGain();this.gain.connect(t.getInput());this.autoplay=false;this.buffer=null;this.detune=0;this.loop=false;this.loopStart=0;this.loopEnd=0;this.offset=0;this.duration=undefined;this.playbackRate=1;this.isPlaying=false;this.hasPlaybackControl=true;this.source=null;this.sourceType="empty";this._startedAt=0;this._progress=0;this._connected=false;this.filters=[]}getOutput(){return this.gain}setNodeSource(t){this.hasPlaybackControl=false;this.sourceType="audioNode";this.source=t;this.connect();return this}setMediaElementSource(t){this.hasPlaybackControl=false;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(t);this.connect();return this}setMediaStreamSource(t){this.hasPlaybackControl=false;this.sourceType="mediaStreamNode";this.source=this.context.createMediaStreamSource(t);this.connect();return this}setBuffer(t){this.buffer=t;this.sourceType="buffer";if(this.autoplay)this.play();return this}play(t=0){if(this.isPlaying===true){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();e.buffer=this.buffer;e.loop=this.loop;e.loopStart=this.loopStart;e.loopEnd=this.loopEnd;e.onended=this.onEnded.bind(this);e.start(this._startedAt,this._progress+this.offset,this.duration);this.isPlaying=true;this.source=e;this.setDetune(this.detune);this.setPlaybackRate(this.playbackRate);return this.connect()}pause(){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}if(this.isPlaying===true){this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate;if(this.loop===true){this._progress=this._progress%(this.duration||this.buffer.duration)}this.source.stop();this.source.onended=null;this.isPlaying=false}return this}stop(t=0){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this._progress=0;if(this.source!==null){this.source.stop(this.context.currentTime+t);this.source.onended=null}this.isPlaying=false;return this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++){this.filters[t-1].connect(this.filters[t])}this.filters[this.filters.length-1].connect(this.getOutput())}else{this.source.connect(this.getOutput())}this._connected=true;return this}disconnect(){if(this._connected===false){return}if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++){this.filters[t-1].disconnect(this.filters[t])}this.filters[this.filters.length-1].disconnect(this.getOutput())}else{this.source.disconnect(this.getOutput())}this._connected=false;return this}getFilters(){return this.filters}setFilters(t){if(!t)t=[];if(this._connected===true){this.disconnect();this.filters=t.slice();this.connect()}else{this.filters=t.slice()}return this}setDetune(t){this.detune=t;if(this.isPlaying===true&&this.source.detune!==undefined){this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01)}return this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this.playbackRate=t;if(this.isPlaying===true){this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01)}return this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=false;this._progress=0}getLoop(){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return false}return this.loop}setLoop(t){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this.loop=t;if(this.isPlaying===true){this.source.loop=this.loop}return this}setLoopStart(t){this.loopStart=t;return this}setLoopEnd(t){this.loopEnd=t;return this}getVolume(){return this.gain.gain.value}setVolume(t){this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01);return this}copy(t,e){super.copy(t,e);if(t.sourceType!=="buffer"){console.warn("THREE.Audio: Audio source type cannot be copied.");return this}this.autoplay=t.autoplay;this.buffer=t.buffer;this.detune=t.detune;this.loop=t.loop;this.loopStart=t.loopStart;this.loopEnd=t.loopEnd;this.offset=t.offset;this.duration=t.duration;this.playbackRate=t.playbackRate;this.hasPlaybackControl=t.hasPlaybackControl;this.sourceType=t.sourceType;this.filters=t.filters.slice();return this}clone(t){return new this.constructor(this.listener).copy(this,t)}}const lp=new iM;const lf=new iw;const lm=new iM;const ly=new iM;class lg extends ld{constructor(t){super(t);this.panner=this.context.createPanner();this.panner.panningModel="HRTF";this.panner.connect(this.gain)}connect(){super.connect();this.panner.connect(this.gain);return this}disconnect(){super.disconnect();this.panner.disconnect(this.gain);return this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){this.panner.refDistance=t;return this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){this.panner.rolloffFactor=t;return this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){this.panner.distanceModel=t;return this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){this.panner.maxDistance=t;return this}setDirectionalCone(t,e,s){this.panner.coneInnerAngle=t;this.panner.coneOuterAngle=e;this.panner.coneOuterGain=s;return this}updateMatrixWorld(t){super.updateMatrixWorld(t);if(this.hasPlaybackControl===true&&this.isPlaying===false)return;this.matrixWorld.decompose(lp,lf,lm);ly.set(0,0,1).applyQuaternion(lf);const e=this.panner;if(e.positionX){const t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(lp.x,t);e.positionY.linearRampToValueAtTime(lp.y,t);e.positionZ.linearRampToValueAtTime(lp.z,t);e.orientationX.linearRampToValueAtTime(ly.x,t);e.orientationY.linearRampToValueAtTime(ly.y,t);e.orientationZ.linearRampToValueAtTime(ly.z,t)}else{e.setPosition(lp.x,lp.y,lp.z);e.setOrientation(ly.x,ly.y,ly.z)}}}class lx{constructor(t,e=2048){this.analyser=t.context.createAnalyser();this.analyser.fftSize=e;this.data=new Uint8Array(this.analyser.frequencyBinCount);t.getOutput().connect(this.analyser)}getFrequencyData(){this.analyser.getByteFrequencyData(this.data);return this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let s=0;s<e.length;s++){t+=e[s]}return t/e.length}}class lb{constructor(t,e,s){this.binding=t;this.valueSize=s;let i,n,r;switch(e){case"quaternion":i=this._slerp;n=this._slerpAdditive;r=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(s*6);this._workIndex=5;break;case"string":case"bool":i=this._select;n=this._select;r=this._setAdditiveIdentityOther;this.buffer=new Array(s*5);break;default:i=this._lerp;n=this._lerpAdditive;r=this._setAdditiveIdentityNumeric;this.buffer=new Float64Array(s*5)}this._mixBufferRegion=i;this._mixBufferRegionAdditive=n;this._setIdentity=r;this._origIndex=3;this._addIndex=4;this.cumulativeWeight=0;this.cumulativeWeightAdditive=0;this.useCount=0;this.referenceCount=0}accumulate(t,e){const s=this.buffer,i=this.valueSize,n=t*i+i;let r=this.cumulativeWeight;if(r===0){for(let t=0;t!==i;++t){s[n+t]=s[t]}r=e}else{r+=e;const t=e/r;this._mixBufferRegion(s,n,0,t,i)}this.cumulativeWeight=r}accumulateAdditive(t){const e=this.buffer,s=this.valueSize,i=s*this._addIndex;if(this.cumulativeWeightAdditive===0){this._setIdentity()}this._mixBufferRegionAdditive(e,i,0,t,s);this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,s=this.buffer,i=t*e+e,n=this.cumulativeWeight,r=this.cumulativeWeightAdditive,o=this.binding;this.cumulativeWeight=0;this.cumulativeWeightAdditive=0;if(n<1){const t=e*this._origIndex;this._mixBufferRegion(s,i,t,1-n,e)}if(r>0){this._mixBufferRegionAdditive(s,i,this._addIndex*e,1,e)}for(let t=e,n=e+e;t!==n;++t){if(s[t]!==s[t+e]){o.setValue(s,i);break}}}saveOriginalState(){const t=this.binding;const e=this.buffer,s=this.valueSize,i=s*this._origIndex;t.getValue(e,i);for(let t=s,n=i;t!==n;++t){e[t]=e[i+t%s]}this._setIdentity();this.cumulativeWeight=0;this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize;const e=t+this.valueSize;for(let s=t;s<e;s++){this.buffer[s]=0}}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric();this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize;const e=this._addIndex*this.valueSize;for(let s=0;s<this.valueSize;s++){this.buffer[e+s]=this.buffer[t+s]}}_select(t,e,s,i,n){if(i>=.5){for(let i=0;i!==n;++i){t[e+i]=t[s+i]}}}_slerp(t,e,s,i){iw.slerpFlat(t,e,t,e,t,s,i)}_slerpAdditive(t,e,s,i,n){const r=this._workIndex*n;iw.multiplyQuaternionsFlat(t,r,t,e,t,s);iw.slerpFlat(t,e,t,e,t,r,i)}_lerp(t,e,s,i,n){const r=1-i;for(let o=0;o!==n;++o){const n=e+o;t[n]=t[n]*r+t[s+o]*i}}_lerpAdditive(t,e,s,i,n){for(let r=0;r!==n;++r){const n=e+r;t[n]=t[n]+t[s+r]*i}}}const lw="\\[\\]\\.:\\/";const lM=new RegExp("["+lw+"]","g");const lv="[^"+lw+"]";const lS="[^"+lw.replace("\\.","")+"]";const l_=/((?:WC+[\/:])*)/.source.replace("WC",lv);const lA=/(WCOD+)?/.source.replace("WCOD",lS);const lT=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",lv);const lz=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",lv);const lI=new RegExp(""+"^"+l_+lA+lT+lz+"$");const lC=["material","materials","bones","map"];class lB{constructor(t,e,s){const i=s||lk.parseTrackName(e);this._targetGroup=t;this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const s=this._targetGroup.nCachedObjects_,i=this._bindings[s];if(i!==undefined)i.getValue(t,e)}setValue(t,e){const s=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=s.length;i!==n;++i){s[i].setValue(t,e)}}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,s=t.length;e!==s;++e){t[e].bind()}}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,s=t.length;e!==s;++e){t[e].unbind()}}}class lk{constructor(t,e,s){this.path=e;this.parsedPath=s||lk.parseTrackName(e);this.node=lk.findNode(t,this.parsedPath.nodeName);this.rootNode=t;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}static create(t,e,s){if(!(t&&t.isAnimationObjectGroup)){return new lk(t,e,s)}else{return new lk.Composite(t,e,s)}}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(lM,"")}static parseTrackName(t){const e=lI.exec(t);if(e===null){throw new Error("PropertyBinding: Cannot parse trackName: "+t)}const s={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]};const i=s.nodeName&&s.nodeName.lastIndexOf(".");if(i!==undefined&&i!==-1){const t=s.nodeName.substring(i+1);if(lC.indexOf(t)!==-1){s.nodeName=s.nodeName.substring(0,i);s.objectName=t}}if(s.propertyName===null||s.propertyName.length===0){throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t)}return s}static findNode(t,e){if(e===undefined||e===""||e==="."||e===-1||e===t.name||e===t.uuid){return t}if(t.skeleton){const s=t.skeleton.getBoneByName(e);if(s!==undefined){return s}}if(t.children){const s=function(t){for(let i=0;i<t.length;i++){const n=t[i];if(n.name===e||n.uuid===e){return n}const r=s(n.children);if(r)return r}return null};const i=s(t.children);if(i){return i}}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const s=this.resolvedProperty;for(let i=0,n=s.length;i!==n;++i){t[e++]=s[i]}}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e];this.targetObject.needsUpdate=true}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e];this.targetObject.matrixWorldNeedsUpdate=true}_setValue_array(t,e){const s=this.resolvedProperty;for(let i=0,n=s.length;i!==n;++i){s[i]=t[e++]}}_setValue_array_setNeedsUpdate(t,e){const s=this.resolvedProperty;for(let i=0,n=s.length;i!==n;++i){s[i]=t[e++]}this.targetObject.needsUpdate=true}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const s=this.resolvedProperty;for(let i=0,n=s.length;i!==n;++i){s[i]=t[e++]}this.targetObject.matrixWorldNeedsUpdate=true}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e];this.targetObject.needsUpdate=true}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e];this.targetObject.matrixWorldNeedsUpdate=true}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e);this.targetObject.needsUpdate=true}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e);this.targetObject.matrixWorldNeedsUpdate=true}_getValue_unbound(t,e){this.bind();this.getValue(t,e)}_setValue_unbound(t,e){this.bind();this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath;const s=e.objectName;const i=e.propertyName;let n=e.propertyIndex;if(!t){t=lk.findNode(this.rootNode,e.nodeName);this.node=t}this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(s){let i=e.objectIndex;switch(s){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let e=0;e<t.length;e++){if(t[e].name===i){i=e;break}}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[s]===undefined){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[s]}if(i!==undefined){if(t[i]===undefined){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[i]}}const r=t[i];if(r===undefined){const s=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+s+"."+i+" but it wasn't found.",t);return}let o=this.Versioning.None;this.targetObject=t;if(t.isMaterial===true){o=this.Versioning.NeedsUpdate}else if(t.isObject3D===true){o=this.Versioning.MatrixWorldNeedsUpdate}let a=this.BindingType.Direct;if(n!==undefined){if(i==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}if(t.morphTargetDictionary[n]!==undefined){n=t.morphTargetDictionary[n]}}a=this.BindingType.ArrayElement;this.resolvedProperty=r;this.propertyIndex=n}else if(r.fromArray!==undefined&&r.toArray!==undefined){a=this.BindingType.HasFromToArray;this.resolvedProperty=r}else if(Array.isArray(r)){a=this.BindingType.EntireArray;this.resolvedProperty=r}else{this.propertyName=i}this.getValue=this.GetterByBindingType[a];this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}}lk.Composite=lB;lk.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};lk.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};lk.prototype.GetterByBindingType=[lk.prototype._getValue_direct,lk.prototype._getValue_array,lk.prototype._getValue_arrayElement,lk.prototype._getValue_toArray];lk.prototype.SetterByBindingTypeAndVersioning=[[lk.prototype._setValue_direct,lk.prototype._setValue_direct_setNeedsUpdate,lk.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[lk.prototype._setValue_array,lk.prototype._setValue_array_setNeedsUpdate,lk.prototype._setValue_array_setMatrixWorldNeedsUpdate],[lk.prototype._setValue_arrayElement,lk.prototype._setValue_arrayElement_setNeedsUpdate,lk.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[lk.prototype._setValue_fromArray,lk.prototype._setValue_fromArray_setNeedsUpdate,lk.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class lR{constructor(){this.isAnimationObjectGroup=true;this.uuid=sT();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,s=arguments.length;e!==s;++e){t[arguments[e].uuid]=e}this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,s=this._paths,i=this._parsedPaths,n=this._bindings,r=n.length;let o=undefined,a=t.length,h=this.nCachedObjects_;for(let c=0,l=arguments.length;c!==l;++c){const l=arguments[c],u=l.uuid;let d=e[u];if(d===undefined){d=a++;e[u]=d;t.push(l);for(let t=0,e=r;t!==e;++t){n[t].push(new lk(l,s[t],i[t]))}}else if(d<h){o=t[d];const a=--h,c=t[a];e[c.uuid]=d;t[d]=c;e[u]=a;t[a]=l;for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[a];let o=e[d];e[d]=r;if(o===undefined){o=new lk(l,s[t],i[t])}e[a]=o}}else if(t[d]!==o){console.error("THREE.AnimationObjectGroup: Different objects with the same UUID "+"detected. Clean the caches or recreate your infrastructure when reloading scenes.")}}this.nCachedObjects_=h}remove(){const t=this._objects,e=this._indicesByUUID,s=this._bindings,i=s.length;let n=this.nCachedObjects_;for(let r=0,o=arguments.length;r!==o;++r){const o=arguments[r],a=o.uuid,h=e[a];if(h!==undefined&&h>=n){const r=n++,c=t[r];e[c.uuid]=h;t[h]=c;e[a]=r;t[r]=o;for(let t=0,e=i;t!==e;++t){const e=s[t],i=e[r],n=e[h];e[h]=i;e[r]=n}}}this.nCachedObjects_=n}uncache(){const t=this._objects,e=this._indicesByUUID,s=this._bindings,i=s.length;let n=this.nCachedObjects_,r=t.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o],h=a.uuid,c=e[h];if(c!==undefined){delete e[h];if(c<n){const o=--n,a=t[o],h=--r,l=t[h];e[a.uuid]=c;t[c]=a;e[l.uuid]=o;t[o]=l;t.pop();for(let t=0,e=i;t!==e;++t){const e=s[t],i=e[o],n=e[h];e[c]=i;e[o]=n;e.pop()}}else{const n=--r,o=t[n];if(n>0){e[o.uuid]=c}t[c]=o;t.pop();for(let t=0,e=i;t!==e;++t){const e=s[t];e[c]=e[n];e.pop()}}}}this.nCachedObjects_=n}subscribe_(t,e){const s=this._bindingsIndicesByPath;let i=s[t];const n=this._bindings;if(i!==undefined)return n[i];const r=this._paths,o=this._parsedPaths,a=this._objects,h=a.length,c=this.nCachedObjects_,l=new Array(h);i=n.length;s[t]=i;r.push(t);o.push(e);n.push(l);for(let s=c,i=a.length;s!==i;++s){const i=a[s];l[s]=new lk(i,t,e)}return l}unsubscribe_(t){const e=this._bindingsIndicesByPath,s=e[t];if(s!==undefined){const i=this._paths,n=this._parsedPaths,r=this._bindings,o=r.length-1,a=r[o],h=t[o];e[h]=s;r[s]=a;r.pop();n[s]=n[o];n.pop();i[s]=i[o];i.pop()}}}class lE{constructor(t,e,s=null,i=e.blendMode){this._mixer=t;this._clip=e;this._localRoot=s;this.blendMode=i;const n=e.tracks,r=n.length,o=new Array(r);const a={endingStart:eT,endingEnd:eT};for(let t=0;t!==r;++t){const e=n[t].createInterpolant(null);o[t]=e;e.settings=a}this._interpolantSettings=a;this._interpolants=o;this._propertyBindings=new Array(r);this._cacheIndex=null;this._byClipCacheIndex=null;this._timeScaleInterpolant=null;this._weightInterpolant=null;this.loop=eM;this._loopCount=-1;this._startTime=null;this.time=0;this.timeScale=1;this._effectiveTimeScale=1;this.weight=1;this._effectiveWeight=1;this.repetitions=Infinity;this.paused=false;this.enabled=true;this.clampWhenFinished=false;this.zeroSlopeAtStart=true;this.zeroSlopeAtEnd=true}play(){this._mixer._activateAction(this);return this}stop(){this._mixer._deactivateAction(this);return this.reset()}reset(){this.paused=false;this.enabled=true;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){this._startTime=t;return this}setLoop(t,e){this.loop=t;this.repetitions=e;return this}setEffectiveWeight(t){this.weight=t;this._effectiveWeight=this.enabled?t:0;return this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,s=false){t.fadeOut(e);this.fadeIn(e);if(s===true){const s=this._clip.duration,i=t._clip.duration,n=i/s,r=s/i;t.warp(1,n,e);this.warp(r,1,e)}return this}crossFadeTo(t,e,s=false){return t.crossFadeFrom(this,e,s)}stopFading(){const t=this._weightInterpolant;if(t!==null){this._weightInterpolant=null;this._mixer._takeBackControlInterpolant(t)}return this}setEffectiveTimeScale(t){this.timeScale=t;this._effectiveTimeScale=this.paused?0:t;return this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){this.timeScale=this._clip.duration/t;return this.stopWarping()}syncWith(t){this.time=t.time;this.timeScale=t.timeScale;return this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,s){const i=this._mixer,n=i.time,r=this.timeScale;let o=this._timeScaleInterpolant;if(o===null){o=i._lendControlInterpolant();this._timeScaleInterpolant=o}const a=o.parameterPositions,h=o.sampleValues;a[0]=n;a[1]=n+s;h[0]=t/r;h[1]=e/r;return this}stopWarping(){const t=this._timeScaleInterpolant;if(t!==null){this._timeScaleInterpolant=null;this._mixer._takeBackControlInterpolant(t)}return this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,s,i){if(!this.enabled){this._updateWeight(t);return}const n=this._startTime;if(n!==null){const i=(t-n)*s;if(i<0||s===0){e=0}else{this._startTime=null;e=s*i}}e*=this._updateTimeScale(t);const r=this._updateTime(e);const o=this._updateWeight(t);if(o>0){const t=this._interpolants;const e=this._propertyBindings;switch(this.blendMode){case eB:for(let s=0,i=t.length;s!==i;++s){t[s].evaluate(r);e[s].accumulateAdditive(o)}break;case eC:default:for(let s=0,n=t.length;s!==n;++s){t[s].evaluate(r);e[s].accumulate(i,o)}}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const s=this._weightInterpolant;if(s!==null){const i=s.evaluate(t)[0];e*=i;if(t>s.parameterPositions[1]){this.stopFading();if(i===0){this.enabled=false}}}}this._effectiveWeight=e;return e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const s=this._timeScaleInterpolant;if(s!==null){const i=s.evaluate(t)[0];e*=i;if(t>s.parameterPositions[1]){this.stopWarping();if(e===0){this.paused=true}else{this.timeScale=e}}}}this._effectiveTimeScale=e;return e}_updateTime(t){const e=this._clip.duration;const s=this.loop;let i=this.time+t;let n=this._loopCount;const r=s===ev;if(t===0){if(n===-1)return i;return r&&(n&1)===1?e-i:i}if(s===ew){if(n===-1){this._loopCount=0;this._setEndings(true,true,false)}n:{if(i>=e){i=e}else if(i<0){i=0}else{this.time=i;break n}if(this.clampWhenFinished)this.paused=true;else this.enabled=false;this.time=i;this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(n===-1){if(t>=0){n=0;this._setEndings(true,this.repetitions===0,r)}else{this._setEndings(this.repetitions===0,true,r)}}if(i>=e||i<0){const s=Math.floor(i/e);i-=e*s;n+=Math.abs(s);const o=this.repetitions-n;if(o<=0){if(this.clampWhenFinished)this.paused=true;else this.enabled=false;i=t>0?e:0;this.time=i;this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1})}else{if(o===1){const e=t<0;this._setEndings(e,!e,r)}else{this._setEndings(false,false,r)}this._loopCount=n;this.time=i;this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}else{this.time=i}if(r&&(n&1)===1){return e-i}}return i}_setEndings(t,e,s){const i=this._interpolantSettings;if(s){i.endingStart=ez;i.endingEnd=ez}else{if(t){i.endingStart=this.zeroSlopeAtStart?ez:eT}else{i.endingStart=eI}if(e){i.endingEnd=this.zeroSlopeAtEnd?ez:eT}else{i.endingEnd=eI}}}_scheduleFading(t,e,s){const i=this._mixer,n=i.time;let r=this._weightInterpolant;if(r===null){r=i._lendControlInterpolant();this._weightInterpolant=r}const o=r.parameterPositions,a=r.sampleValues;o[0]=n;a[0]=e;o[1]=n+t;a[1]=s;return this}}const lP=new Float32Array(1);class lO extends sM{constructor(t){super();this._root=t;this._initMemoryManager();this._accuIndex=0;this.time=0;this.timeScale=1}_bindAction(t,e){const s=t._localRoot||this._root,i=t._clip.tracks,n=i.length,r=t._propertyBindings,o=t._interpolants,a=s.uuid,h=this._bindingsByRootAndName;let c=h[a];if(c===undefined){c={};h[a]=c}for(let t=0;t!==n;++t){const n=i[t],h=n.name;let l=c[h];if(l!==undefined){++l.referenceCount;r[t]=l}else{l=r[t];if(l!==undefined){if(l._cacheIndex===null){++l.referenceCount;this._addInactiveBinding(l,a,h)}continue}const i=e&&e._propertyBindings[t].binding.parsedPath;l=new lb(lk.create(s,h,i),n.ValueTypeName,n.getValueSize());++l.referenceCount;this._addInactiveBinding(l,a,h);r[t]=l}o[t].resultBuffer=l.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){const e=(t._localRoot||this._root).uuid,s=t._clip.uuid,i=this._actionsByClip[s];this._bindAction(t,i&&i.knownActions[0]);this._addInactiveAction(t,s,e)}const e=t._propertyBindings;for(let t=0,s=e.length;t!==s;++t){const s=e[t];if(s.useCount++===0){this._lendBinding(s);s.saveOriginalState()}}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,s=e.length;t!==s;++t){const s=e[t];if(--s.useCount===0){s.restoreOriginalState();this._takeBackBinding(s)}}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(t,e,s){const i=this._actions,n=this._actionsByClip;let r=n[e];if(r===undefined){r={knownActions:[t],actionByRoot:{}};t._byClipCacheIndex=0;n[e]=r}else{const e=r.knownActions;t._byClipCacheIndex=e.length;e.push(t)}t._cacheIndex=i.length;i.push(t);r.actionByRoot[s]=t}_removeInactiveAction(t){const e=this._actions,s=e[e.length-1],i=t._cacheIndex;s._cacheIndex=i;e[i]=s;e.pop();t._cacheIndex=null;const n=t._clip.uuid,r=this._actionsByClip,o=r[n],a=o.knownActions,h=a[a.length-1],c=t._byClipCacheIndex;h._byClipCacheIndex=c;a[c]=h;a.pop();t._byClipCacheIndex=null;const l=o.actionByRoot,u=(t._localRoot||this._root).uuid;delete l[u];if(a.length===0){delete r[n]}this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let t=0,s=e.length;t!==s;++t){const s=e[t];if(--s.referenceCount===0){this._removeInactiveBinding(s)}}}_lendAction(t){const e=this._actions,s=t._cacheIndex,i=this._nActiveActions++,n=e[i];t._cacheIndex=i;e[i]=t;n._cacheIndex=s;e[s]=n}_takeBackAction(t){const e=this._actions,s=t._cacheIndex,i=--this._nActiveActions,n=e[i];t._cacheIndex=i;e[i]=t;n._cacheIndex=s;e[s]=n}_addInactiveBinding(t,e,s){const i=this._bindingsByRootAndName,n=this._bindings;let r=i[e];if(r===undefined){r={};i[e]=r}r[s]=t;t._cacheIndex=n.length;n.push(t)}_removeInactiveBinding(t){const e=this._bindings,s=t.binding,i=s.rootNode.uuid,n=s.path,r=this._bindingsByRootAndName,o=r[i],a=e[e.length-1],h=t._cacheIndex;a._cacheIndex=h;e[h]=a;e.pop();delete o[n];if(Object.keys(o).length===0){delete r[i]}}_lendBinding(t){const e=this._bindings,s=t._cacheIndex,i=this._nActiveBindings++,n=e[i];t._cacheIndex=i;e[i]=t;n._cacheIndex=s;e[s]=n}_takeBackBinding(t){const e=this._bindings,s=t._cacheIndex,i=--this._nActiveBindings,n=e[i];t._cacheIndex=i;e[i]=t;n._cacheIndex=s;e[s]=n}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let s=t[e];if(s===undefined){s=new co(new Float32Array(2),new Float32Array(2),1,lP);s.__cacheIndex=e;t[e]=s}return s}_takeBackControlInterpolant(t){const e=this._controlInterpolants,s=t.__cacheIndex,i=--this._nActiveControlInterpolants,n=e[i];t.__cacheIndex=i;e[i]=t;n.__cacheIndex=s;e[s]=n}clipAction(t,e,s){const i=e||this._root,n=i.uuid;let r=typeof t==="string"?cy.findByName(i,t):t;const o=r!==null?r.uuid:t;const a=this._actionsByClip[o];let h=null;if(s===undefined){if(r!==null){s=r.blendMode}else{s=eC}}if(a!==undefined){const t=a.actionByRoot[n];if(t!==undefined&&t.blendMode===s){return t}h=a.knownActions[0];if(r===null)r=h._clip}if(r===null)return null;const c=new lE(this,r,e,s);this._bindAction(c,h);this._addInactiveAction(c,o,n);return c}existingAction(t,e){const s=e||this._root,i=s.uuid,n=typeof t==="string"?cy.findByName(s,t):t,r=n?n.uuid:t,o=this._actionsByClip[r];if(o!==undefined){return o.actionByRoot[i]||null}return null}stopAllAction(){const t=this._actions,e=this._nActiveActions;for(let s=e-1;s>=0;--s){t[s].stop()}return this}update(t){t*=this.timeScale;const e=this._actions,s=this._nActiveActions,i=this.time+=t,n=Math.sign(t),r=this._accuIndex^=1;for(let o=0;o!==s;++o){const s=e[o];s._update(i,t,n,r)}const o=this._bindings,a=this._nActiveBindings;for(let t=0;t!==a;++t){o[t].apply(r)}return this}setTime(t){this.time=0;for(let t=0;t<this._actions.length;t++){this._actions[t].time=0}return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,s=t.uuid,i=this._actionsByClip,n=i[s];if(n!==undefined){const t=n.knownActions;for(let s=0,i=t.length;s!==i;++s){const i=t[s];this._deactivateAction(i);const n=i._cacheIndex,r=e[e.length-1];i._cacheIndex=null;i._byClipCacheIndex=null;r._cacheIndex=n;e[n]=r;e.pop();this._removeInactiveBindingsForAction(i)}delete i[s]}}uncacheRoot(t){const e=t.uuid,s=this._actionsByClip;for(const t in s){const i=s[t].actionByRoot,n=i[e];if(n!==undefined){this._deactivateAction(n);this._removeInactiveAction(n)}}const i=this._bindingsByRootAndName,n=i[e];if(n!==undefined){for(const t in n){const e=n[t];e.restoreOriginalState();this._removeInactiveBinding(e)}}}uncacheAction(t,e){const s=this.existingAction(t,e);if(s!==null){this._deactivateAction(s);this._removeInactiveAction(s)}}}class lF extends ip{constructor(t=1,e=1,s=1,i={}){super(t,e,i);this.isRenderTarget3D=true;this.depth=s;this.texture=new ix(null,t,e,s);this.texture.isRenderTargetTexture=true}}class lN extends ip{constructor(t=1,e=1,s=1,i={}){super(t,e,i);this.isRenderTargetArray=true;this.depth=s;this.texture=new iy(null,t,e,s);this.texture.isRenderTargetTexture=true}}class lV{constructor(t){this.value=t}clone(){return new lV(this.value.clone===undefined?this.value:this.value.clone())}}let lL=0;class lj extends sM{constructor(){super();this.isUniformsGroup=true;Object.defineProperty(this,"id",{value:lL++});this.name="";this.usage=sr;this.uniforms=[]}add(t){this.uniforms.push(t);return this}remove(t){const e=this.uniforms.indexOf(t);if(e!==-1)this.uniforms.splice(e,1);return this}setName(t){this.name=t;return this}setUsage(t){this.usage=t;return this}dispose(){this.dispatchEvent({type:"dispose"})}copy(t){this.name=t.name;this.usage=t.usage;const e=t.uniforms;this.uniforms.length=0;for(let t=0,s=e.length;t<s;t++){const s=Array.isArray(e[t])?e[t]:[e[t]];for(let t=0;t<s.length;t++){this.uniforms.push(s[t].clone())}}return this}clone(){return new this.constructor().copy(this)}}class lW extends rL{constructor(t,e,s=1){super(t,e);this.isInstancedInterleavedBuffer=true;this.meshPerAttribute=s}copy(t){super.copy(t);this.meshPerAttribute=t.meshPerAttribute;return this}clone(t){const e=super.clone(t);e.meshPerAttribute=this.meshPerAttribute;return e}toJSON(t){const e=super.toJSON(t);e.isInstancedInterleavedBuffer=true;e.meshPerAttribute=this.meshPerAttribute;return e}}class lU{constructor(t,e,s,i,n){this.isGLBufferAttribute=true;this.name="";this.buffer=t;this.type=e;this.itemSize=s;this.elementSize=i;this.count=n;this.version=0}set needsUpdate(t){if(t===true)this.version++}setBuffer(t){this.buffer=t;return this}setType(t,e){this.type=t;this.elementSize=e;return this}setItemSize(t){this.itemSize=t;return this}setCount(t){this.count=t;return this}}const lD=new i$;class lH{constructor(t,e,s=0,i=Infinity){this.ray=new iG(t,e);this.near=s;this.far=i;this.camera=null;this.layers=new i9;this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){if(e.isPerspectiveCamera){this.ray.origin.setFromMatrixPosition(e.matrixWorld);this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize();this.camera=e}else if(e.isOrthographicCamera){this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e);this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld);this.camera=e}else{console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}}setFromXRController(t){lD.identity().extractRotation(t.matrixWorld);this.ray.origin.setFromMatrixPosition(t.matrixWorld);this.ray.direction.set(0,0,-1).applyMatrix4(lD);return this}intersectObject(t,e=true,s=[]){lJ(t,this,s,e);s.sort(lq);return s}intersectObjects(t,e=true,s=[]){for(let i=0,n=t.length;i<n;i++){lJ(t[i],this,s,e)}s.sort(lq);return s}}function lq(t,e){return t.distance-e.distance}function lJ(t,e,s,i){let n=true;if(t.layers.test(e.layers)){const i=t.raycast(e,s);if(i===false)n=false}if(n===true&&i===true){const i=t.children;for(let t=0,n=i.length;t<n;t++){lJ(i[t],e,s,true)}}}class lX{constructor(t=1,e=0,s=0){this.radius=t;this.phi=e;this.theta=s}set(t,e,s){this.radius=t;this.phi=e;this.theta=s;return this}copy(t){this.radius=t.radius;this.phi=t.phi;this.theta=t.theta;return this}makeSafe(){const t=1e-6;this.phi=sz(this.phi,t,Math.PI-t);return this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,s){this.radius=Math.sqrt(t*t+e*e+s*s);if(this.radius===0){this.theta=0;this.phi=0}else{this.theta=Math.atan2(t,s);this.phi=Math.acos(sz(e/this.radius,-1,1))}return this}clone(){return new this.constructor().copy(this)}}class lY{constructor(t=1,e=0,s=0){this.radius=t;this.theta=e;this.y=s}set(t,e,s){this.radius=t;this.theta=e;this.y=s;return this}copy(t){this.radius=t.radius;this.theta=t.theta;this.y=t.y;return this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,s){this.radius=Math.sqrt(t*t+s*s);this.theta=Math.atan2(t,s);this.y=e;return this}clone(){return new this.constructor().copy(this)}}class lZ{constructor(t,e,s,i){lZ.prototype.isMatrix2=true;this.elements=[1,0,0,1];if(t!==undefined){this.set(t,e,s,i)}}identity(){this.set(1,0,0,1);return this}fromArray(t,e=0){for(let s=0;s<4;s++){this.elements[s]=t[s+e]}return this}set(t,e,s,i){const n=this.elements;n[0]=t;n[2]=e;n[1]=s;n[3]=i;return this}}const lG=new sZ;class l${constructor(t=new sZ(+Infinity,+Infinity),e=new sZ(-Infinity,-Infinity)){this.isBox2=true;this.min=t;this.max=e}set(t,e){this.min.copy(t);this.max.copy(e);return this}setFromPoints(t){this.makeEmpty();for(let e=0,s=t.length;e<s;e++){this.expandByPoint(t[e])}return this}setFromCenterAndSize(t,e){const s=lG.copy(e).multiplyScalar(.5);this.min.copy(t).sub(s);this.max.copy(t).add(s);return this}clone(){return new this.constructor().copy(this)}copy(t){this.min.copy(t.min);this.max.copy(t.max);return this}makeEmpty(){this.min.x=this.min.y=+Infinity;this.max.x=this.max.y=-Infinity;return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){this.min.min(t);this.max.max(t);return this}expandByVector(t){this.min.sub(t);this.max.add(t);return this}expandByScalar(t){this.min.addScalar(-t);this.max.addScalar(t);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,lG).distanceTo(t)}intersect(t){this.min.max(t.min);this.max.min(t.max);if(this.isEmpty())this.makeEmpty();return this}union(t){this.min.min(t.min);this.max.max(t.max);return this}translate(t){this.min.add(t);this.max.add(t);return this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const lQ=new iM;const lK=new iM;class l0{constructor(t=new iM,e=new iM){this.start=t;this.end=e}set(t,e){this.start.copy(t);this.end.copy(e);return this}copy(t){this.start.copy(t.start);this.end.copy(t.end);return this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){lQ.subVectors(t,this.start);lK.subVectors(this.end,this.start);const s=lK.dot(lK);const i=lK.dot(lQ);let n=i/s;if(e){n=sz(n,0,1)}return n}closestPointToPoint(t,e,s){const i=this.closestPointToPointParameter(t,e);return this.delta(s).multiplyScalar(i).add(this.start)}applyMatrix4(t){this.start.applyMatrix4(t);this.end.applyMatrix4(t);return this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const l1=new iM;class l2 extends nf{constructor(t,e){super();this.light=t;this.matrixAutoUpdate=false;this.color=e;this.type="SpotLightHelper";const s=new n7;const i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let t=0,e=1,s=32;t<s;t++,e++){const n=t/s*Math.PI*2;const r=e/s*Math.PI*2;i.push(Math.cos(n),Math.sin(n),1,Math.cos(r),Math.sin(r),1)}s.setAttribute("position",new n1(i,3));const n=new oG({fog:false,toneMapped:false});this.cone=new o9(s,n);this.add(this.cone);this.update()}dispose(){this.cone.geometry.dispose();this.cone.material.dispose()}update(){this.light.updateWorldMatrix(true,false);this.light.target.updateWorldMatrix(true,false);if(this.parent){this.parent.updateWorldMatrix(true);this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)}else{this.matrix.copy(this.light.matrixWorld)}this.matrixWorld.copy(this.light.matrixWorld);const t=this.light.distance?this.light.distance:1e3;const e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t);l1.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(l1);if(this.color!==undefined){this.cone.material.color.set(this.color)}else{this.cone.material.color.copy(this.light.color)}}}const l3=new iM;const l5=new i$;const l4=new i$;class l6 extends o9{constructor(t){const e=l8(t);const s=new n7;const i=[];const n=[];const r=new nE(0,0,1);const o=new nE(0,1,0);for(let t=0;t<e.length;t++){const s=e[t];if(s.parent&&s.parent.isBone){i.push(0,0,0);i.push(0,0,0);n.push(r.r,r.g,r.b);n.push(o.r,o.g,o.b)}}s.setAttribute("position",new n1(i,3));s.setAttribute("color",new n1(n,3));const a=new oG({vertexColors:true,depthTest:false,depthWrite:false,toneMapped:false,transparent:true});super(s,a);this.isSkeletonHelper=true;this.type="SkeletonHelper";this.root=t;this.bones=e;this.matrix=t.matrixWorld;this.matrixAutoUpdate=false}updateMatrixWorld(t){const e=this.bones;const s=this.geometry;const i=s.getAttribute("position");l4.copy(this.root.matrixWorld).invert();for(let t=0,s=0;t<e.length;t++){const n=e[t];if(n.parent&&n.parent.isBone){l5.multiplyMatrices(l4,n.matrixWorld);l3.setFromMatrixPosition(l5);i.setXYZ(s,l3.x,l3.y,l3.z);l5.multiplyMatrices(l4,n.parent.matrixWorld);l3.setFromMatrixPosition(l5);i.setXYZ(s+1,l3.x,l3.y,l3.z);s+=2}}s.getAttribute("position").needsUpdate=true;super.updateMatrixWorld(t)}dispose(){this.geometry.dispose();this.material.dispose()}}function l8(t){const e=[];if(t.isBone===true){e.push(t)}for(let s=0;s<t.children.length;s++){e.push(...l8(t.children[s]))}return e}class l9 extends ru{constructor(t,e,s){const i=new hj(e,4,2);const n=new nN({wireframe:true,fog:false,toneMapped:false});super(i,n);this.light=t;this.color=s;this.type="PointLightHelper";this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=false;this.update()}dispose(){this.geometry.dispose();this.material.dispose()}update(){this.light.updateWorldMatrix(true,false);if(this.color!==undefined){this.material.color.set(this.color)}else{this.material.color.copy(this.light.color)}}}const l7=new iM;const ut=new nE;const ue=new nE;class us extends nf{constructor(t,e,s){super();this.light=t;this.matrix=t.matrixWorld;this.matrixAutoUpdate=false;this.color=s;this.type="HemisphereLightHelper";const i=new hO(e);i.rotateY(Math.PI*.5);this.material=new nN({wireframe:true,fog:false,toneMapped:false});if(this.color===undefined)this.material.vertexColors=true;const n=i.getAttribute("position");const r=new Float32Array(n.count*3);i.setAttribute("color",new nJ(r,3));this.add(new ru(i,this.material));this.update()}dispose(){this.children[0].geometry.dispose();this.children[0].material.dispose()}update(){const t=this.children[0];if(this.color!==undefined){this.material.color.set(this.color)}else{const e=t.geometry.getAttribute("color");ut.copy(this.light.color);ue.copy(this.light.groundColor);for(let t=0,s=e.count;t<s;t++){const i=t<s/2?ut:ue;e.setXYZ(t,i.r,i.g,i.b)}e.needsUpdate=true}this.light.updateWorldMatrix(true,false);t.lookAt(l7.setFromMatrixPosition(this.light.matrixWorld).negate())}}class ui extends o9{constructor(t=10,e=10,s=4473924,i=8947848){s=new nE(s);i=new nE(i);const n=e/2;const r=t/e;const o=t/2;const a=[],h=[];for(let t=0,c=0,l=-o;t<=e;t++,l+=r){a.push(-o,0,l,o,0,l);a.push(l,0,-o,l,0,o);const e=t===n?s:i;e.toArray(h,c);c+=3;e.toArray(h,c);c+=3;e.toArray(h,c);c+=3;e.toArray(h,c);c+=3}const c=new n7;c.setAttribute("position",new n1(a,3));c.setAttribute("color",new n1(h,3));const l=new oG({vertexColors:true,toneMapped:false});super(c,l);this.type="GridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}class un extends o9{constructor(t=10,e=16,s=8,i=64,n=4473924,r=8947848){n=new nE(n);r=new nE(r);const o=[];const a=[];if(e>1){for(let s=0;s<e;s++){const i=s/e*(Math.PI*2);const h=Math.sin(i)*t;const c=Math.cos(i)*t;o.push(0,0,0);o.push(h,0,c);const l=s&1?n:r;a.push(l.r,l.g,l.b);a.push(l.r,l.g,l.b)}}for(let e=0;e<s;e++){const h=e&1?n:r;const c=t-t/s*e;for(let t=0;t<i;t++){let e=t/i*(Math.PI*2);let s=Math.sin(e)*c;let n=Math.cos(e)*c;o.push(s,0,n);a.push(h.r,h.g,h.b);e=(t+1)/i*(Math.PI*2);s=Math.sin(e)*c;n=Math.cos(e)*c;o.push(s,0,n);a.push(h.r,h.g,h.b)}}const h=new n7;h.setAttribute("position",new n1(o,3));h.setAttribute("color",new n1(a,3));const c=new oG({vertexColors:true,toneMapped:false});super(h,c);this.type="PolarGridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}const ur=new iM;const uo=new iM;const ua=new iM;class uh extends nf{constructor(t,e,s){super();this.light=t;this.matrix=t.matrixWorld;this.matrixAutoUpdate=false;this.color=s;this.type="DirectionalLightHelper";if(e===undefined)e=1;let i=new n7;i.setAttribute("position",new n1([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const n=new oG({fog:false,toneMapped:false});this.lightPlane=new o5(i,n);this.add(this.lightPlane);i=new n7;i.setAttribute("position",new n1([0,0,0,0,0,1],3));this.targetLine=new o5(i,n);this.add(this.targetLine);this.update()}dispose(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(true,false);this.light.target.updateWorldMatrix(true,false);ur.setFromMatrixPosition(this.light.matrixWorld);uo.setFromMatrixPosition(this.light.target.matrixWorld);ua.subVectors(uo,ur);this.lightPlane.lookAt(uo);if(this.color!==undefined){this.lightPlane.material.color.set(this.color);this.targetLine.material.color.set(this.color)}else{this.lightPlane.material.color.copy(this.light.color);this.targetLine.material.color.copy(this.light.color)}this.targetLine.lookAt(uo);this.targetLine.scale.z=ua.length()}}const uc=new iM;const ul=new rS;class uu extends o9{constructor(t){const e=new n7;const s=new oG({color:0xffffff,vertexColors:true,toneMapped:false});const i=[];const n=[];const r={};o("n1","n2");o("n2","n4");o("n4","n3");o("n3","n1");o("f1","f2");o("f2","f4");o("f4","f3");o("f3","f1");o("n1","f1");o("n2","f2");o("n3","f3");o("n4","f4");o("p","n1");o("p","n2");o("p","n3");o("p","n4");o("u1","u2");o("u2","u3");o("u3","u1");o("c","t");o("p","c");o("cn1","cn2");o("cn3","cn4");o("cf1","cf2");o("cf3","cf4");function o(t,e){a(t);a(e)}function a(t){i.push(0,0,0);n.push(0,0,0);if(r[t]===undefined){r[t]=[]}r[t].push(i.length/3-1)}e.setAttribute("position",new n1(i,3));e.setAttribute("color",new n1(n,3));super(e,s);this.type="CameraHelper";this.camera=t;if(this.camera.updateProjectionMatrix)this.camera.updateProjectionMatrix();this.matrix=t.matrixWorld;this.matrixAutoUpdate=false;this.pointMap=r;this.update();const h=new nE(0xffaa00);const c=new nE(0xff0000);const l=new nE(43775);const u=new nE(0xffffff);const d=new nE(3355443);this.setColors(h,c,l,u,d)}setColors(t,e,s,i,n){const r=this.geometry;const o=r.getAttribute("color");o.setXYZ(0,t.r,t.g,t.b);o.setXYZ(1,t.r,t.g,t.b);o.setXYZ(2,t.r,t.g,t.b);o.setXYZ(3,t.r,t.g,t.b);o.setXYZ(4,t.r,t.g,t.b);o.setXYZ(5,t.r,t.g,t.b);o.setXYZ(6,t.r,t.g,t.b);o.setXYZ(7,t.r,t.g,t.b);o.setXYZ(8,t.r,t.g,t.b);o.setXYZ(9,t.r,t.g,t.b);o.setXYZ(10,t.r,t.g,t.b);o.setXYZ(11,t.r,t.g,t.b);o.setXYZ(12,t.r,t.g,t.b);o.setXYZ(13,t.r,t.g,t.b);o.setXYZ(14,t.r,t.g,t.b);o.setXYZ(15,t.r,t.g,t.b);o.setXYZ(16,t.r,t.g,t.b);o.setXYZ(17,t.r,t.g,t.b);o.setXYZ(18,t.r,t.g,t.b);o.setXYZ(19,t.r,t.g,t.b);o.setXYZ(20,t.r,t.g,t.b);o.setXYZ(21,t.r,t.g,t.b);o.setXYZ(22,t.r,t.g,t.b);o.setXYZ(23,t.r,t.g,t.b);o.setXYZ(24,e.r,e.g,e.b);o.setXYZ(25,e.r,e.g,e.b);o.setXYZ(26,e.r,e.g,e.b);o.setXYZ(27,e.r,e.g,e.b);o.setXYZ(28,e.r,e.g,e.b);o.setXYZ(29,e.r,e.g,e.b);o.setXYZ(30,e.r,e.g,e.b);o.setXYZ(31,e.r,e.g,e.b);o.setXYZ(32,s.r,s.g,s.b);o.setXYZ(33,s.r,s.g,s.b);o.setXYZ(34,s.r,s.g,s.b);o.setXYZ(35,s.r,s.g,s.b);o.setXYZ(36,s.r,s.g,s.b);o.setXYZ(37,s.r,s.g,s.b);o.setXYZ(38,i.r,i.g,i.b);o.setXYZ(39,i.r,i.g,i.b);o.setXYZ(40,n.r,n.g,n.b);o.setXYZ(41,n.r,n.g,n.b);o.setXYZ(42,n.r,n.g,n.b);o.setXYZ(43,n.r,n.g,n.b);o.setXYZ(44,n.r,n.g,n.b);o.setXYZ(45,n.r,n.g,n.b);o.setXYZ(46,n.r,n.g,n.b);o.setXYZ(47,n.r,n.g,n.b);o.setXYZ(48,n.r,n.g,n.b);o.setXYZ(49,n.r,n.g,n.b);o.needsUpdate=true}update(){const t=this.geometry;const e=this.pointMap;const s=1,i=1;ul.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const n=this.camera.coordinateSystem===sy?-1:0;ud("c",e,t,ul,0,0,n);ud("t",e,t,ul,0,0,1);ud("n1",e,t,ul,-1,-1,n);ud("n2",e,t,ul,s,-1,n);ud("n3",e,t,ul,-1,i,n);ud("n4",e,t,ul,s,i,n);ud("f1",e,t,ul,-1,-1,1);ud("f2",e,t,ul,s,-1,1);ud("f3",e,t,ul,-1,i,1);ud("f4",e,t,ul,s,i,1);ud("u1",e,t,ul,s*.7,i*1.1,n);ud("u2",e,t,ul,-1*.7,i*1.1,n);ud("u3",e,t,ul,0,i*2,n);ud("cf1",e,t,ul,-1,0,1);ud("cf2",e,t,ul,s,0,1);ud("cf3",e,t,ul,0,-1,1);ud("cf4",e,t,ul,0,i,1);ud("cn1",e,t,ul,-1,0,n);ud("cn2",e,t,ul,s,0,n);ud("cn3",e,t,ul,0,-1,n);ud("cn4",e,t,ul,0,i,n);t.getAttribute("position").needsUpdate=true}dispose(){this.geometry.dispose();this.material.dispose()}}function ud(t,e,s,i,n,r,o){uc.set(n,r,o).unproject(i);const a=e[t];if(a!==undefined){const t=s.getAttribute("position");for(let e=0,s=a.length;e<s;e++){t.setXYZ(a[e],uc.x,uc.y,uc.z)}}}const up=new i_;class uf extends o9{constructor(t,e=0xffff00){const s=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);const i=new Float32Array(8*3);const n=new n7;n.setIndex(new nJ(s,1));n.setAttribute("position",new nJ(i,3));super(n,new oG({color:e,toneMapped:false}));this.object=t;this.type="BoxHelper";this.matrixAutoUpdate=false;this.update()}update(){if(this.object!==undefined){up.setFromObject(this.object)}if(up.isEmpty())return;const t=up.min;const e=up.max;const s=this.geometry.attributes.position;const i=s.array;i[0]=e.x;i[1]=e.y;i[2]=e.z;i[3]=t.x;i[4]=e.y;i[5]=e.z;i[6]=t.x;i[7]=t.y;i[8]=e.z;i[9]=e.x;i[10]=t.y;i[11]=e.z;i[12]=e.x;i[13]=e.y;i[14]=t.z;i[15]=t.x;i[16]=e.y;i[17]=t.z;i[18]=t.x;i[19]=t.y;i[20]=t.z;i[21]=e.x;i[22]=t.y;i[23]=t.z;s.needsUpdate=true;this.geometry.computeBoundingSphere()}setFromObject(t){this.object=t;this.update();return this}copy(t,e){super.copy(t,e);this.object=t.object;return this}dispose(){this.geometry.dispose();this.material.dispose()}}class um extends o9{constructor(t,e=0xffff00){const s=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);const i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1];const n=new n7;n.setIndex(new nJ(s,1));n.setAttribute("position",new n1(i,3));super(n,new oG({color:e,toneMapped:false}));this.box=t;this.type="Box3Helper";this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;if(e.isEmpty())return;e.getCenter(this.position);e.getSize(this.scale);this.scale.multiplyScalar(.5);super.updateMatrixWorld(t)}dispose(){this.geometry.dispose();this.material.dispose()}}class uy extends o5{constructor(t,e=1,s=0xffff00){const i=s;const n=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0];const r=new n7;r.setAttribute("position",new n1(n,3));r.computeBoundingSphere();super(r,new oG({color:i,toneMapped:false}));this.type="PlaneHelper";this.plane=t;this.size=e;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0];const a=new n7;a.setAttribute("position",new n1(o,3));a.computeBoundingSphere();this.add(new ru(a,new nN({color:i,opacity:.2,transparent:true,depthWrite:false,toneMapped:false})))}updateMatrixWorld(t){this.position.set(0,0,0);this.scale.set(.5*this.size,.5*this.size,1);this.lookAt(this.plane.normal);this.translateZ(-this.plane.constant);super.updateMatrixWorld(t)}dispose(){this.geometry.dispose();this.material.dispose();this.children[0].geometry.dispose();this.children[0].material.dispose()}}const ug=new iM;let ux,ub;class uw extends nf{constructor(t=new iM(0,0,1),e=new iM(0,0,0),s=1,i=0xffff00,n=s*.2,r=n*.2){super();this.type="ArrowHelper";if(ux===undefined){ux=new n7;ux.setAttribute("position",new n1([0,0,0,0,1,0],3));ub=new ab(.5,1,5,1);ub.translate(0,-.5,0)}this.position.copy(e);this.line=new o5(ux,new oG({color:i,toneMapped:false}));this.line.matrixAutoUpdate=false;this.add(this.line);this.cone=new ru(ub,new nN({color:i,toneMapped:false}));this.cone.matrixAutoUpdate=false;this.add(this.cone);this.setDirection(t);this.setLength(s,n,r)}setDirection(t){if(t.y>.99999){this.quaternion.set(0,0,0,1)}else if(t.y<-.99999){this.quaternion.set(1,0,0,0)}else{ug.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(ug,e)}}setLength(t,e=t*.2,s=e*.2){this.line.scale.set(1,Math.max(1e-4,t-e),1);this.line.updateMatrix();this.cone.scale.set(s,e,s);this.cone.position.y=t;this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t);this.cone.material.color.set(t)}copy(t){super.copy(t,false);this.line.copy(t.line);this.cone.copy(t.cone);return this}dispose(){this.line.geometry.dispose();this.line.material.dispose();this.cone.geometry.dispose();this.cone.material.dispose()}}class uM extends o9{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t];const s=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1];const i=new n7;i.setAttribute("position",new n1(e,3));i.setAttribute("color",new n1(s,3));const n=new oG({vertexColors:true,toneMapped:false});super(i,n);this.type="AxesHelper"}setColors(t,e,s){const i=new nE;const n=this.geometry.attributes.color.array;i.set(t);i.toArray(n,0);i.toArray(n,3);i.set(e);i.toArray(n,6);i.toArray(n,9);i.set(s);i.toArray(n,12);i.toArray(n,15);this.geometry.attributes.color.needsUpdate=true;return this}dispose(){this.geometry.dispose();this.material.dispose()}}class uv{constructor(){this.type="ShapePath";this.color=new nE;this.subPaths=[];this.currentPath=null}moveTo(t,e){this.currentPath=new a1;this.subPaths.push(this.currentPath);this.currentPath.moveTo(t,e);return this}lineTo(t,e){this.currentPath.lineTo(t,e);return this}quadraticCurveTo(t,e,s,i){this.currentPath.quadraticCurveTo(t,e,s,i);return this}bezierCurveTo(t,e,s,i,n,r){this.currentPath.bezierCurveTo(t,e,s,i,n,r);return this}splineThru(t){this.currentPath.splineThru(t);return this}toShapes(t){function e(t){const e=[];for(let s=0,i=t.length;s<i;s++){const i=t[s];const n=new a2;n.curves=i.curves;e.push(n)}return e}function s(t,e){const s=e.length;let i=false;for(let n=s-1,r=0;r<s;n=r++){let s=e[n];let o=e[r];let a=o.x-s.x;let h=o.y-s.y;if(Math.abs(h)>Number.EPSILON){if(h<0){s=e[r];a=-a;o=e[n];h=-h}if(t.y<s.y||t.y>o.y)continue;if(t.y===s.y){if(t.x===s.x)return true}else{const e=h*(t.x-s.x)-a*(t.y-s.y);if(e===0)return true;if(e<0)continue;i=!i}}else{if(t.y!==s.y)continue;if(o.x<=t.x&&t.x<=s.x||s.x<=t.x&&t.x<=o.x)return true}}return i}const i=hz.isClockWise;const n=this.subPaths;if(n.length===0)return[];let r,o,a;const h=[];if(n.length===1){o=n[0];a=new a2;a.curves=o.curves;h.push(a);return h}let c=!i(n[0].getPoints());c=t?!c:c;const l=[];const u=[];let d=[];let p=0;let f;u[p]=undefined;d[p]=[];for(let e=0,s=n.length;e<s;e++){o=n[e];f=o.getPoints();r=i(f);r=t?!r:r;if(r){if(!c&&u[p])p++;u[p]={s:new a2,p:f};u[p].s.curves=o.curves;if(c)p++;d[p]=[]}else{d[p].push({h:o,p:f[0]})}}if(!u[0])return e(n);if(u.length>1){let t=false;let e=0;for(let t=0,e=u.length;t<e;t++){l[t]=[]}for(let i=0,n=u.length;i<n;i++){const n=d[i];for(let r=0;r<n.length;r++){const o=n[r];let a=true;for(let n=0;n<u.length;n++){if(s(o.p,u[n].p)){if(i!==n)e++;if(a){a=false;l[n].push(o)}else{t=true}}}if(a){l[i].push(o)}}}if(e>0&&t===false){d=l}}let m;for(let t=0,e=u.length;t<e;t++){a=u[t].s;h.push(a);m=d[t];for(let t=0,e=m.length;t<e;t++){a.holes.push(m[t].h)}}return h}}class uS extends sM{constructor(t,e=null){super();this.object=t;this.domElement=e;this.enabled=true;this.state=-1;this.keys={};this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null};this.touches={ONE:null,TWO:null}}connect(t){if(t===undefined){console.warn("THREE.Controls: connect() now requires an element.");return}if(this.domElement!==null)this.disconnect();this.domElement=t}disconnect(){}dispose(){}update(){}}function u_(t,e){const s=t.image&&t.image.width?t.image.width/t.image.height:1;if(s>e){t.repeat.x=1;t.repeat.y=s/e;t.offset.x=0;t.offset.y=(1-t.repeat.y)/2}else{t.repeat.x=e/s;t.repeat.y=1;t.offset.x=(1-t.repeat.x)/2;t.offset.y=0}return t}function uA(t,e){const s=t.image&&t.image.width?t.image.width/t.image.height:1;if(s>e){t.repeat.x=e/s;t.repeat.y=1;t.offset.x=(1-t.repeat.x)/2;t.offset.y=0}else{t.repeat.x=1;t.repeat.y=s/e;t.offset.x=0;t.offset.y=(1-t.repeat.y)/2}return t}function uT(t){t.repeat.x=1;t.repeat.y=1;t.offset.x=0;t.offset.y=0;return t}function uz(t,e,s,i){const n=uI(i);switch(s){case tW:return t*e;case tJ:return t*e/n.components*n.byteLength;case tX:return t*e/n.components*n.byteLength;case tY:return t*e*2/n.components*n.byteLength;case tZ:return t*e*2/n.components*n.byteLength;case tU:return t*e*3/n.components*n.byteLength;case tD:return t*e*4/n.components*n.byteLength;case t$:return t*e*4/n.components*n.byteLength;case tQ:case tK:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case t0:case t1:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case t3:case t4:return Math.max(t,16)*Math.max(e,8)/4;case t2:case t5:return Math.max(t,8)*Math.max(e,8)/2;case t6:case t8:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case t9:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case t7:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case et:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case ee:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case es:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case ei:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case en:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case er:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case eo:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case ea:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case eh:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case ec:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case el:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case eu:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case ed:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case ep:case ef:case em:return Math.ceil(t/4)*Math.ceil(e/4)*16;case ey:case eg:return Math.ceil(t/4)*Math.ceil(e/4)*8;case ex:case eb:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${s} format.`)}function uI(t){switch(t){case tC:case tB:return{byteLength:1,components:1};case tR:case tk:case tF:return{byteLength:2,components:1};case tN:case tV:return{byteLength:2,components:4};case tP:case tE:case tO:return{byteLength:4,components:1};case tj:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}class uC{static contain(t,e){return u_(t,e)}static cover(t,e){return uA(t,e)}static fill(t){return uT(t)}static getByteLength(t,e,s,i){return uz(t,e,s,i)}}if(typeof __THREE_DEVTOOLS__!=="undefined"){__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}}))}if(typeof window!=="undefined"){if(window.__THREE__){console.warn("WARNING: Multiple instances of Three.js being imported.")}else{window.__THREE__=i}}}}]);